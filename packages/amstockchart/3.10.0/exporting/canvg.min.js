(function(){this.canvg=function(j,m,b){if(j==null&&m==null&&b==null){var e=document.getElementsByTagName("svg");for(var g=0;g<e.length;g++){var f=e[g];var k=document.createElement("canvas");k.width=f.clientWidth;k.height=f.clientHeight;f.parentNode.insertBefore(k,f);f.parentNode.removeChild(f);var d=document.createElement("div");d.appendChild(f);canvg(k,d.innerHTML)}return}b=b||{};if(typeof j=="string"){j=document.getElementById(j)}if(j.svg!=null){j.svg.stop()}var h=a();if(!(j.childNodes.length==1&&j.childNodes[0].nodeName=="OBJECT")){j.svg=h}h.opts=b;var l=j.getContext("2d");if(typeof(m.documentElement)!="undefined"){h.loadXmlDoc(l,m)}else{if(m.substr(0,1)=="<"){h.loadXml(l,m)}else{h.load(l,m)}}};function a(){var b={};b.FRAMERATE=30;b.MAX_VIRTUAL_PIXELS=30000;b.init=function(c){var d=0;b.UniqueId=function(){d++;return"canvg"+d};b.Definitions={};b.Styles={};b.Animations=[];b.Images=[];b.ctx=c;b.ViewPort=new (function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(f,e){this.viewPorts.push({width:f,height:e})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(e){if(e!=null&&typeof(e)=="number"){return e}if(e=="x"){return this.width()}if(e=="y"){return this.height()}return Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}})};b.init();b.ImagesLoaded=function(){for(var c=0;c<b.Images.length;c++){if(!b.Images[c].loaded){return false}}return true};b.trim=function(c){return c.replace(/^\s+|\s+$/g,"")};b.compressSpaces=function(c){return c.replace(/[\s\r\t\n]+/gm," ")};b.ajax=function(d){var c;if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{c=new ActiveXObject("Microsoft.XMLHTTP")}if(c){c.open("GET",d,false);c.send(null);return c.responseText}return null};b.parseXml=function(c){if(window.DOMParser){var e=new DOMParser();return e.parseFromString(c,"text/xml")}else{c=c.replace(/<!DOCTYPE svg[^>]*>/,"");var d=new ActiveXObject("Microsoft.XMLDOM");d.async="false";d.loadXML(c);return d}};b.Property=function(c,d){this.name=c;this.value=d};b.Property.prototype.getValue=function(){return this.value};b.Property.prototype.hasValue=function(){return(this.value!=null&&this.value!=="")};b.Property.prototype.numValue=function(){if(!this.hasValue()){return 0}var c=parseFloat(this.value);if((this.value+"").match(/%$/)){c=c/100}return c};b.Property.prototype.valueOrDefault=function(c){if(this.hasValue()){return this.value}return c};b.Property.prototype.numValueOrDefault=function(c){if(this.hasValue()){return this.numValue()}return c};b.Property.prototype.addOpacity=function(d){var e=this.value;if(d!=null&&d!=""&&typeof(this.value)=="string"){var c=new RGBColor(this.value);if(c.ok){e="rgba("+c.r+", "+c.g+", "+c.b+", "+d+")"}}return new b.Property(this.name,e)};b.Property.prototype.getDefinition=function(){var c=this.value.match(/#([^\)'"]+)/);if(c){c=c[1]}if(!c){c=this.value}return b.Definitions[c]};b.Property.prototype.isUrlDefinition=function(){return this.value.indexOf("url(")==0};b.Property.prototype.getFillStyleDefinition=function(g,f){var c=this.getDefinition();if(c!=null&&c.createGradient){return c.createGradient(b.ctx,g,f)}if(c!=null&&c.createPattern){if(c.getHrefAttribute().hasValue()){var d=c.attribute("patternTransform");c=c.getHrefAttribute().getDefinition();if(d.hasValue()){c.attribute("patternTransform",true).value=d.value}}return c.createPattern(b.ctx,g)}return null};b.Property.prototype.getDPI=function(c){return 96};b.Property.prototype.getEM=function(e){var c=12;var d=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize);if(d.hasValue()){c=d.toPixels(e)}return c};b.Property.prototype.getUnits=function(){var c=this.value+"";return c.replace(/[0-9\.\-]/g,"")};b.Property.prototype.toPixels=function(e,c){if(!this.hasValue()){return 0}var d=this.value+"";if(d.match(/em$/)){return this.numValue()*this.getEM(e)}if(d.match(/ex$/)){return this.numValue()*this.getEM(e)/2}if(d.match(/px$/)){return this.numValue()}if(d.match(/pt$/)){return this.numValue()*this.getDPI(e)*(1/72)}if(d.match(/pc$/)){return this.numValue()*15}if(d.match(/cm$/)){return this.numValue()*this.getDPI(e)/2.54}if(d.match(/mm$/)){return this.numValue()*this.getDPI(e)/25.4}if(d.match(/in$/)){return this.numValue()*this.getDPI(e)}if(d.match(/%$/)){return this.numValue()*b.ViewPort.ComputeSize(e)}var f=this.numValue();if(c&&f<1){return f*b.ViewPort.ComputeSize(e)}return f};b.Property.prototype.toMilliseconds=function(){if(!this.hasValue()){return 0}var c=this.value+"";if(c.match(/s$/)){return this.numValue()*1000}if(c.match(/ms$/)){return this.numValue()}return this.numValue()};b.Property.prototype.toRadians=function(){if(!this.hasValue()){return 0}var c=this.value+"";if(c.match(/deg$/)){return this.numValue()*(Math.PI/180)}if(c.match(/grad$/)){return this.numValue()*(Math.PI/200)}if(c.match(/rad$/)){return this.numValue()}return this.numValue()*(Math.PI/180)};b.Font=new (function(){this.Styles="normal|italic|oblique|inherit";this.Variants="normal|small-caps|inherit";this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";this.CreateFont=function(l,h,e,k,d,g){var j=g!=null?this.Parse(g):this.CreateFont("","","","","",b.ctx.font);return{fontFamily:d||j.fontFamily,fontSize:k||j.fontSize,fontStyle:l||j.fontStyle,fontWeight:e||j.fontWeight,fontVariant:h||j.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var c=this;this.Parse=function(h){var j={};var k=b.trim(b.compressSpaces(h||"")).split(" ");var l={fontSize:false,fontStyle:false,fontWeight:false,fontVariant:false};var e="";for(var g=0;g<k.length;g++){if(!l.fontStyle&&c.Styles.indexOf(k[g])!=-1){if(k[g]!="inherit"){j.fontStyle=k[g]}l.fontStyle=true}else{if(!l.fontVariant&&c.Variants.indexOf(k[g])!=-1){if(k[g]!="inherit"){j.fontVariant=k[g]}l.fontStyle=l.fontVariant=true}else{if(!l.fontWeight&&c.Weights.indexOf(k[g])!=-1){if(k[g]!="inherit"){j.fontWeight=k[g]}l.fontStyle=l.fontVariant=l.fontWeight=true}else{if(!l.fontSize){if(k[g]!="inherit"){j.fontSize=k[g].split("/")[0]}l.fontStyle=l.fontVariant=l.fontWeight=l.fontSize=true}else{if(k[g]!="inherit"){e+=k[g]}}}}}}if(e!=""){j.fontFamily=e}return j}});b.ToNumberArray=function(e){var c=b.trim(b.compressSpaces((e||"").replace(/,/g," "))).split(" ");for(var d=0;d<c.length;d++){c[d]=parseFloat(c[d])}return c};b.Point=function(c,d){this.x=c;this.y=d};b.Point.prototype.angleTo=function(c){return Math.atan2(c.y-this.y,c.x-this.x)};b.Point.prototype.applyTransform=function(c){var d=this.x*c[0]+this.y*c[2]+c[4];var e=this.x*c[1]+this.y*c[3]+c[5];this.x=d;this.y=e};b.CreatePoint=function(d){var c=b.ToNumberArray(d);return new b.Point(c[0],c[1])};b.CreatePath=function(e){var c=b.ToNumberArray(e);var f=[];for(var d=0;d<c.length;d+=2){f.push(new b.Point(c[d],c[d+1]))}return f};b.BoundingBox=function(d,f,c,e){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(g,h){if(g!=null){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=g;this.x2=g}if(g<this.x1){this.x1=g}if(g>this.x2){this.x2=g}}if(h!=null){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=h;this.y2=h}if(h<this.y1){this.y1=h}if(h>this.y2){this.y2=h}}};this.addX=function(g){this.addPoint(g,null)};this.addY=function(g){this.addPoint(null,g)};this.addBoundingBox=function(g){this.addPoint(g.x1,g.y1);this.addPoint(g.x2,g.y2)};this.addQuadraticCurve=function(m,l,h,g,o,n){var k=m+2/3*(h-m);var j=l+2/3*(g-l);var q=k+1/3*(o-m);var p=j+1/3*(n-l);this.addBezierCurve(m,l,k,q,j,p,o,n)};this.addBezierCurve=function(v,u,l,j,q,o,x,w){var m=[v,u],k=[l,j],h=[q,o],g=[x,w];this.addPoint(m[0],m[1]);this.addPoint(g[0],g[1]);for(i=0;i<=1;i++){var y=function(C){return Math.pow(1-C,3)*m[i]+3*Math.pow(1-C,2)*C*k[i]+3*(1-C)*Math.pow(C,2)*h[i]+Math.pow(C,3)*g[i]};var A=6*m[i]-12*k[i]+6*h[i];var B=-3*m[i]+9*k[i]-9*h[i]+3*g[i];var z=3*k[i]-3*m[i];if(B==0){if(A==0){continue}var s=-z/A;if(0<s&&s<1){if(i==0){this.addX(y(s))}if(i==1){this.addY(y(s))}}continue}var n=Math.pow(A,2)-4*z*B;if(n<0){continue}var r=(-A+Math.sqrt(n))/(2*B);if(0<r&&r<1){if(i==0){this.addX(y(r))}if(i==1){this.addY(y(r))}}var p=(-A-Math.sqrt(n))/(2*B);if(0<p&&p<1){if(i==0){this.addX(y(p))}if(i==1){this.addY(y(p))}}}};this.isPointInBox=function(g,h){return(this.x1<=g&&g<=this.x2&&this.y1<=h&&h<=this.y2)};this.addPoint(d,f);this.addPoint(c,e)};b.Transform=function(c){var h=this;this.Type={};this.Type.translate=function(k){this.p=b.CreatePoint(k);this.apply=function(l){l.translate(this.p.x||0,this.p.y||0)};this.unapply=function(l){l.translate(-1*this.p.x||0,-1*this.p.y||0)};this.applyToPoint=function(l){l.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(l){var k=b.ToNumberArray(l);this.angle=new b.Property("angle",k[0]);this.cx=k[1]||0;this.cy=k[2]||0;this.apply=function(m){m.translate(this.cx,this.cy);m.rotate(this.angle.toRadians());m.translate(-this.cx,-this.cy)};this.unapply=function(m){m.translate(this.cx,this.cy);m.rotate(-1*this.angle.toRadians());m.translate(-this.cx,-this.cy)};this.applyToPoint=function(n){var m=this.angle.toRadians();n.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);n.applyTransform([Math.cos(m),Math.sin(m),-Math.sin(m),Math.cos(m),0,0]);n.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(k){this.p=b.CreatePoint(k);this.apply=function(l){l.scale(this.p.x||1,this.p.y||this.p.x||1)};this.unapply=function(l){l.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)};this.applyToPoint=function(l){l.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(k){this.m=b.ToNumberArray(k);this.apply=function(l){l.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.applyToPoint=function(l){l.applyTransform(this.m)}};this.Type.SkewBase=function(k){this.base=h.Type.matrix;this.base(k);this.angle=new b.Property("angle",k)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(k){this.base=h.Type.SkewBase;this.base(k);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(k){this.base=h.Type.SkewBase;this.base(k);this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(k){for(var l=0;l<this.transforms.length;l++){this.transforms[l].apply(k)}};this.unapply=function(k){for(var l=this.transforms.length-1;l>=0;l--){this.transforms[l].unapply(k)}};this.applyToPoint=function(l){for(var k=0;k<this.transforms.length;k++){this.transforms[k].applyToPoint(l)}};var j=b.trim(b.compressSpaces(c)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/);for(var e=0;e<j.length;e++){var g=b.trim(j[e].split("(")[0]);var f=j[e].split("(")[1].replace(")","");var d=new this.Type[g](f);d.type=g;this.transforms.push(d)}};b.AspectRatio=function(s,q,d,k,r,c,g,f,p,o){q=b.compressSpaces(q);q=q.replace(/^defer\s/,"");var j=q.split(" ")[0]||"xMidYMid";var e=q.split(" ")[1]||"meet";var n=d/k;var m=r/c;var h=Math.min(n,m);var l=Math.max(n,m);if(e=="meet"){k*=h;c*=h}if(e=="slice"){k*=l;c*=l}p=new b.Property("refX",p);o=new b.Property("refY",o);if(p.hasValue()&&o.hasValue()){s.translate(-h*p.toPixels("x"),-h*o.toPixels("y"))}else{if(j.match(/^xMid/)&&((e=="meet"&&h==m)||(e=="slice"&&l==m))){s.translate(d/2-k/2,0)}if(j.match(/YMid$/)&&((e=="meet"&&h==n)||(e=="slice"&&l==n))){s.translate(0,r/2-c/2)}if(j.match(/^xMax/)&&((e=="meet"&&h==m)||(e=="slice"&&l==m))){s.translate(d-k,0)}if(j.match(/YMax$/)&&((e=="meet"&&h==n)||(e=="slice"&&l==n))){s.translate(0,r-c)}}if(j=="none"){s.scale(n,m)}else{if(e=="meet"){s.scale(h,h)}else{if(e=="slice"){s.scale(l,l)}}}s.translate(g==null?0:-g,f==null?0:-f)};b.Element={};b.EmptyProperty=new b.Property("EMPTY","");b.Element.ElementBase=function(g){this.attributes={};this.styles={};this.children=[];this.attribute=function(p,q){var j=this.attributes[p];if(j!=null){return j}if(q==true){j=new b.Property(p,"");this.attributes[p]=j}return j||b.EmptyProperty};this.getHrefAttribute=function(){for(var j in this.attributes){if(j.match(/:href$/)){return this.attributes[j]}}return b.EmptyProperty};this.style=function(q,v){var r=this.styles[q];if(r!=null){return r}var j=this.attribute(q);if(j!=null&&j.hasValue()){this.styles[q]=j;return j}var t=this.parent;if(t!=null){var u=t.style(q);if(u!=null&&u.hasValue()){return u}}if(v==true){r=new b.Property(q,"");this.styles[q]=r}return r||b.EmptyProperty};this.render=function(p){if(this.style("display").value=="none"){return}if(this.attribute("visibility").value=="hidden"){return}p.save();if(this.attribute("mask").hasValue()){var j=this.attribute("mask").getDefinition();if(j!=null){j.apply(p,this)}}else{if(this.style("filter").hasValue()){var q=this.style("filter").getDefinition();if(q!=null){q.apply(p,this)}}else{this.setContext(p);this.renderChildren(p);this.clearContext(p)}}p.restore()};this.setContext=function(j){};this.clearContext=function(j){};this.renderChildren=function(j){for(var p=0;p<this.children.length;p++){this.children[p].render(j)}};this.addChild=function(p,j){var q=p;if(j){q=b.CreateElement(p)}q.parent=this;this.children.push(q)};if(g!=null&&g.nodeType==1){for(var l=0;l<g.childNodes.length;l++){var c=g.childNodes[l];if(c.nodeType==1){this.addChild(c,true)}if(this.captureTextNodes&&c.nodeType==3){var n=c.nodeValue||c.text||"";if(b.trim(b.compressSpaces(n))!=""){this.addChild(new b.Element.tspan(c),false)}}}for(var l=0;l<g.attributes.length;l++){var f=g.attributes[l];this.attributes[f.nodeName]=new b.Property(f.nodeName,f.nodeValue)}var o=b.Styles[g.nodeName];if(o!=null){for(var e in o){this.styles[e]=o[e]}}if(this.attribute("class").hasValue()){var h=b.compressSpaces(this.attribute("class").value).split(" ");for(var k=0;k<h.length;k++){o=b.Styles["."+h[k]];if(o!=null){for(var e in o){this.styles[e]=o[e]}}o=b.Styles[g.nodeName+"."+h[k]];if(o!=null){for(var e in o){this.styles[e]=o[e]}}}}if(this.attribute("id").hasValue()){var o=b.Styles["#"+this.attribute("id").value];if(o!=null){for(var e in o){this.styles[e]=o[e]}}}if(this.attribute("style").hasValue()){var o=this.attribute("style").value.split(";");for(var l=0;l<o.length;l++){if(b.trim(o[l])!=""){var d=o[l].split(":");var e=b.trim(d[0]);var m=b.trim(d[1]);this.styles[e]=new b.Property(e,m)}}}if(this.attribute("id").hasValue()){if(b.Definitions[this.attribute("id").value]==null){b.Definitions[this.attribute("id").value]=this}}}};b.Element.RenderedElementBase=function(c){this.base=b.Element.ElementBase;this.base(c);this.setContext=function(m){if(this.style("fill").isUrlDefinition()){var j=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));if(j!=null){m.fillStyle=j}}else{if(this.style("fill").hasValue()){var l=this.style("fill");if(l.value=="currentColor"){l.value=this.style("color").value}m.fillStyle=(l.value=="none"?"rgba(0,0,0,0)":l.value)}}if(this.style("fill-opacity").hasValue()){var l=new b.Property("fill",m.fillStyle);l=l.addOpacity(this.style("fill-opacity").value);m.fillStyle=l.value}if(this.style("stroke").isUrlDefinition()){var j=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));if(j!=null){m.strokeStyle=j}}else{if(this.style("stroke").hasValue()){var k=this.style("stroke");if(k.value=="currentColor"){k.value=this.style("color").value}m.strokeStyle=(k.value=="none"?"rgba(0,0,0,0)":k.value)}}if(this.style("stroke-opacity").hasValue()){var k=new b.Property("stroke",m.strokeStyle);k=k.addOpacity(this.style("stroke-opacity").value);m.strokeStyle=k.value}if(this.style("stroke-width").hasValue()){var h=this.style("stroke-width").toPixels();m.lineWidth=h==0?0.001:h}if(this.style("stroke-linecap").hasValue()){m.lineCap=this.style("stroke-linecap").value}if(this.style("stroke-linejoin").hasValue()){m.lineJoin=this.style("stroke-linejoin").value}if(this.style("stroke-miterlimit").hasValue()){m.miterLimit=this.style("stroke-miterlimit").value}if(this.style("stroke-dasharray").hasValue()){var f=b.ToNumberArray(this.style("stroke-dasharray").value);if(typeof(m.setLineDash)!="undefined"){m.setLineDash(f)}else{if(typeof(m.webkitLineDash)!="undefined"){m.webkitLineDash=f}else{if(typeof(m.mozDash)!="undefined"){m.mozDash=f}}}var g=this.style("stroke-dashoffset").numValueOrDefault(1);if(typeof(m.lineDashOffset)!="undefined"){m.lineDashOffset=g}else{if(typeof(m.webkitLineDashOffset)!="undefined"){m.webkitLineDashOffset=g}else{if(typeof(m.mozDashOffset)!="undefined"){m.mozDashOffset=g}}}}if(typeof(m.font)!="undefined"){m.font=b.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()}if(this.attribute("transform").hasValue()){var d=new b.Transform(this.attribute("transform").value);d.apply(m)}if(this.style("clip-path").hasValue()){var e=this.style("clip-path").getDefinition();if(e!=null){e.apply(m)}}if(this.style("opacity").hasValue()){m.globalAlpha=this.style("opacity").numValue()}}};b.Element.RenderedElementBase.prototype=new b.Element.ElementBase;b.Element.PathElementBase=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.path=function(d){if(d!=null){d.beginPath()}return new b.BoundingBox()};this.renderChildren=function(e){this.path(e);b.Mouse.checkPath(this,e);if(e.fillStyle!=""){if(this.attribute("fill-rule").hasValue()){e.fill(this.attribute("fill-rule").value)}else{e.fill()}}if(e.strokeStyle!=""){e.stroke()}var g=this.getMarkers();if(g!=null){if(this.style("marker-start").isUrlDefinition()){var d=this.style("marker-start").getDefinition();d.render(e,g[0][0],g[0][1])}if(this.style("marker-mid").isUrlDefinition()){var d=this.style("marker-mid").getDefinition();for(var f=1;f<g.length-1;f++){d.render(e,g[f][0],g[f][1])}}if(this.style("marker-end").isUrlDefinition()){var d=this.style("marker-end").getDefinition();d.render(e,g[g.length-1][0],g[g.length-1][1])}}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};b.Element.PathElementBase.prototype=new b.Element.RenderedElementBase;b.Element.svg=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.baseClearContext=this.clearContext;this.clearContext=function(d){this.baseClearContext(d);b.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(g){g.strokeStyle="rgba(0,0,0,0)";g.lineCap="butt";g.lineJoin="miter";g.miterLimit=4;this.baseSetContext(g);if(!this.attribute("x").hasValue()){this.attribute("x",true).value=0}if(!this.attribute("y").hasValue()){this.attribute("y",true).value=0}g.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var h=b.ViewPort.width();var f=b.ViewPort.height();if(!this.attribute("width").hasValue()){this.attribute("width",true).value="100%"}if(!this.attribute("height").hasValue()){this.attribute("height",true).value="100%"}if(typeof(this.root)=="undefined"){h=this.attribute("width").toPixels("x");f=this.attribute("height").toPixels("y");var e=0;var l=0;if(this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()){e=-this.attribute("refX").toPixels("x");l=-this.attribute("refY").toPixels("y")}g.beginPath();g.moveTo(e,l);g.lineTo(h,l);g.lineTo(h,f);g.lineTo(e,f);g.closePath();g.clip()}b.ViewPort.SetCurrent(h,f);if(this.attribute("viewBox").hasValue()){var j=b.ToNumberArray(this.attribute("viewBox").value);var d=j[0];var k=j[1];h=j[2];f=j[3];b.AspectRatio(g,this.attribute("preserveAspectRatio").value,b.ViewPort.width(),h,b.ViewPort.height(),f,d,k,this.attribute("refX").value,this.attribute("refY").value);b.ViewPort.RemoveCurrent();b.ViewPort.SetCurrent(j[2],j[3])}}};b.Element.svg.prototype=new b.Element.RenderedElementBase;b.Element.rect=function(c){this.base=b.Element.PathElementBase;this.base(c);this.path=function(f){var e=this.attribute("x").toPixels("x");var k=this.attribute("y").toPixels("y");var g=this.attribute("width").toPixels("x");var d=this.attribute("height").toPixels("y");var j=this.attribute("rx").toPixels("x");var h=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()){h=j}if(this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()){j=h}j=Math.min(j,g/2);h=Math.min(h,d/2);if(f!=null){f.beginPath();f.moveTo(e+j,k);f.lineTo(e+g-j,k);f.quadraticCurveTo(e+g,k,e+g,k+h);f.lineTo(e+g,k+d-h);f.quadraticCurveTo(e+g,k+d,e+g-j,k+d);f.lineTo(e+j,k+d);f.quadraticCurveTo(e,k+d,e,k+d-h);f.lineTo(e,k+h);f.quadraticCurveTo(e,k,e+j,k);f.closePath()}return new b.BoundingBox(e,k,e+g,k+d)}};b.Element.rect.prototype=new b.Element.PathElementBase;b.Element.circle=function(c){this.base=b.Element.PathElementBase;this.base(c);this.path=function(e){var d=this.attribute("cx").toPixels("x");var g=this.attribute("cy").toPixels("y");var f=this.attribute("r").toPixels();if(e!=null){e.beginPath();e.arc(d,g,f,0,Math.PI*2,true);e.closePath()}return new b.BoundingBox(d-f,g-f,d+f,g+f)}};b.Element.circle.prototype=new b.Element.PathElementBase;b.Element.ellipse=function(c){this.base=b.Element.PathElementBase;this.base(c);this.path=function(e){var g=4*((Math.sqrt(2)-1)/3);var h=this.attribute("rx").toPixels("x");var f=this.attribute("ry").toPixels("y");var d=this.attribute("cx").toPixels("x");var j=this.attribute("cy").toPixels("y");if(e!=null){e.beginPath();e.moveTo(d,j-f);e.bezierCurveTo(d+(g*h),j-f,d+h,j-(g*f),d+h,j);e.bezierCurveTo(d+h,j+(g*f),d+(g*h),j+f,d,j+f);e.bezierCurveTo(d-(g*h),j+f,d-h,j+(g*f),d-h,j);e.bezierCurveTo(d-h,j-(g*f),d-(g*h),j-f,d,j-f);e.closePath()}return new b.BoundingBox(d-h,j-f,d+h,j+f)}};b.Element.ellipse.prototype=new b.Element.PathElementBase;b.Element.line=function(c){this.base=b.Element.PathElementBase;this.base(c);this.getPoints=function(){return[new b.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new b.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]};this.path=function(d){var e=this.getPoints();if(d!=null){d.beginPath();d.moveTo(e[0].x,e[0].y);d.lineTo(e[1].x,e[1].y)}return new b.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)};this.getMarkers=function(){var e=this.getPoints();var d=e[0].angleTo(e[1]);return[[e[0],d],[e[1],d]]}};b.Element.line.prototype=new b.Element.PathElementBase;b.Element.polyline=function(c){this.base=b.Element.PathElementBase;this.base(c);this.points=b.CreatePath(this.attribute("points").value);this.path=function(d){var f=new b.BoundingBox(this.points[0].x,this.points[0].y);if(d!=null){d.beginPath();d.moveTo(this.points[0].x,this.points[0].y)}for(var e=1;e<this.points.length;e++){f.addPoint(this.points[e].x,this.points[e].y);if(d!=null){d.lineTo(this.points[e].x,this.points[e].y)}}return f};this.getMarkers=function(){var e=[];for(var d=0;d<this.points.length-1;d++){e.push([this.points[d],this.points[d].angleTo(this.points[d+1])])}e.push([this.points[this.points.length-1],e[e.length-1][1]]);return e}};b.Element.polyline.prototype=new b.Element.PathElementBase;b.Element.polygon=function(c){this.base=b.Element.polyline;this.base(c);this.basePath=this.path;this.path=function(d){var e=this.basePath(d);if(d!=null){d.lineTo(this.points[0].x,this.points[0].y);d.closePath()}return e}};b.Element.polygon.prototype=new b.Element.polyline;b.Element.path=function(c){this.base=b.Element.PathElementBase;this.base(c);var e=this.attribute("d").value;e=e.replace(/,/gm," ");e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");e=e.replace(/([0-9])([+\-])/gm,"$1 $2");e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");e=b.compressSpaces(e);e=b.trim(e);this.PathParser=new (function(f){this.tokens=f.split(" ");this.reset=function(){this.i=-1;this.command="";this.previousCommand="";this.start=new b.Point(0,0);this.control=new b.Point(0,0);this.current=new b.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){if(this.isEnd()){return true}return this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null};this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return true;break}return false};this.getToken=function(){this.i++;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var d=new b.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(d)};this.getAsControlPoint=function(){var d=this.getPoint();this.control=d;return d};this.getAsCurrentPoint=function(){var d=this.getPoint();this.current=d;return d};this.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"&&this.previousCommand.toLowerCase()!="q"&&this.previousCommand.toLowerCase()!="t"){return this.current}var d=new b.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return d};this.makeAbsolute=function(d){if(this.isRelativeCommand()){d.x+=this.current.x;d.y+=this.current.y}return d};this.addMarker=function(g,h,d){if(d!=null&&this.angles.length>0&&this.angles[this.angles.length-1]==null){this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(d)}this.addMarkerAngle(g,h==null?null:h.angleTo(g))};this.addMarkerAngle=function(g,d){this.points.push(g);this.angles.push(d)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var g=0;g<this.angles.length;g++){if(this.angles[g]==null){for(var d=g+1;d<this.angles.length;d++){if(this.angles[d]!=null){this.angles[g]=this.angles[d];break}}}}return this.angles}})(e);this.path=function(I){var K=this.PathParser;K.reset();var t=new b.BoundingBox();if(I!=null){I.beginPath()}while(!K.isEnd()){K.nextCommand();switch(K.command){case"M":case"m":var F=K.getAsCurrentPoint();K.addMarker(F);t.addPoint(F.x,F.y);if(I!=null){I.moveTo(F.x,F.y)}K.start=K.current;while(!K.isCommandOrEnd()){var F=K.getAsCurrentPoint();K.addMarker(F,K.start);t.addPoint(F.x,F.y);if(I!=null){I.lineTo(F.x,F.y)}}break;case"L":case"l":while(!K.isCommandOrEnd()){var O=K.current;var F=K.getAsCurrentPoint();K.addMarker(F,O);t.addPoint(F.x,F.y);if(I!=null){I.lineTo(F.x,F.y)}}break;case"H":case"h":while(!K.isCommandOrEnd()){var g=new b.Point((K.isRelativeCommand()?K.current.x:0)+K.getScalar(),K.current.y);K.addMarker(g,K.current);K.current=g;t.addPoint(K.current.x,K.current.y);if(I!=null){I.lineTo(K.current.x,K.current.y)}}break;case"V":case"v":while(!K.isCommandOrEnd()){var g=new b.Point(K.current.x,(K.isRelativeCommand()?K.current.y:0)+K.getScalar());K.addMarker(g,K.current);K.current=g;t.addPoint(K.current.x,K.current.y);if(I!=null){I.lineTo(K.current.x,K.current.y)}}break;case"C":case"c":while(!K.isCommandOrEnd()){var M=K.current;var j=K.getPoint();var k=K.getAsControlPoint();var x=K.getAsCurrentPoint();K.addMarker(x,k,j);t.addBezierCurve(M.x,M.y,j.x,j.y,k.x,k.y,x.x,x.y);if(I!=null){I.bezierCurveTo(j.x,j.y,k.x,k.y,x.x,x.y)}}break;case"S":case"s":while(!K.isCommandOrEnd()){var M=K.current;var j=K.getReflectedControlPoint();var k=K.getAsControlPoint();var x=K.getAsCurrentPoint();K.addMarker(x,k,j);t.addBezierCurve(M.x,M.y,j.x,j.y,k.x,k.y,x.x,x.y);if(I!=null){I.bezierCurveTo(j.x,j.y,k.x,k.y,x.x,x.y)}}break;case"Q":case"q":while(!K.isCommandOrEnd()){var M=K.current;var k=K.getAsControlPoint();var x=K.getAsCurrentPoint();K.addMarker(x,k,k);t.addQuadraticCurve(M.x,M.y,k.x,k.y,x.x,x.y);if(I!=null){I.quadraticCurveTo(k.x,k.y,x.x,x.y)}}break;case"T":case"t":while(!K.isCommandOrEnd()){var M=K.current;var k=K.getReflectedControlPoint();K.control=k;var x=K.getAsCurrentPoint();K.addMarker(x,k,k);t.addQuadraticCurve(M.x,M.y,k.x,k.y,x.x,x.y);if(I!=null){I.quadraticCurveTo(k.x,k.y,x.x,x.y)}}break;case"A":case"a":while(!K.isCommandOrEnd()){var M=K.current;var q=K.getScalar();var o=K.getScalar();var f=K.getScalar()*(Math.PI/180);var w=K.getScalar();var n=K.getScalar();var x=K.getAsCurrentPoint();var R=new b.Point(Math.cos(f)*(M.x-x.x)/2+Math.sin(f)*(M.y-x.y)/2,-Math.sin(f)*(M.x-x.x)/2+Math.cos(f)*(M.y-x.y)/2);var J=Math.pow(R.x,2)/Math.pow(q,2)+Math.pow(R.y,2)/Math.pow(o,2);if(J>1){q*=Math.sqrt(J);o*=Math.sqrt(J)}var B=(w==n?-1:1)*Math.sqrt(((Math.pow(q,2)*Math.pow(o,2))-(Math.pow(q,2)*Math.pow(R.y,2))-(Math.pow(o,2)*Math.pow(R.x,2)))/(Math.pow(q,2)*Math.pow(R.y,2)+Math.pow(o,2)*Math.pow(R.x,2)));if(isNaN(B)){B=0}var A=new b.Point(B*q*R.y/o,B*-o*R.x/q);var h=new b.Point((M.x+x.x)/2+Math.cos(f)*A.x-Math.sin(f)*A.y,(M.y+x.y)/2+Math.sin(f)*A.x+Math.cos(f)*A.y);var H=function(l){return Math.sqrt(Math.pow(l[0],2)+Math.pow(l[1],2))};var D=function(m,l){return(m[0]*l[0]+m[1]*l[1])/(H(m)*H(l))};var P=function(m,l){return(m[0]*l[1]<m[1]*l[0]?-1:1)*Math.acos(D(m,l))};var Q=P([1,0],[(R.x-A.x)/q,(R.y-A.y)/o]);var z=[(R.x-A.x)/q,(R.y-A.y)/o];var y=[(-R.x-A.x)/q,(-R.y-A.y)/o];var N=P(z,y);if(D(z,y)<=-1){N=Math.PI}if(D(z,y)>=1){N=0}var G=1-n?1:-1;var L=Q+G*(N/2);var d=new b.Point(h.x+q*Math.cos(L),h.y+o*Math.sin(L));K.addMarkerAngle(d,L-G*Math.PI/2);K.addMarkerAngle(x,L-G*Math.PI);t.addPoint(x.x,x.y);if(I!=null){var D=q>o?q:o;var E=q>o?1:q/o;var C=q>o?o/q:1;I.translate(h.x,h.y);I.rotate(f);I.scale(E,C);I.arc(0,0,D,Q,Q+N,1-n);I.scale(1/E,1/C);I.rotate(-f);I.translate(-h.x,-h.y)}}break;case"Z":case"z":if(I!=null){I.closePath()}K.current=K.start}}return t};this.getMarkers=function(){var f=this.PathParser.getMarkerPoints();var h=this.PathParser.getMarkerAngles();var g=[];for(var d=0;d<f.length;d++){g.push([f[d],h[d]])}return g}};b.Element.path.prototype=new b.Element.PathElementBase;b.Element.pattern=function(c){this.base=b.Element.ElementBase;this.base(c);this.createPattern=function(n,f){var d=this.attribute("width").toPixels("x",true);var m=this.attribute("height").toPixels("y",true);var k=new b.Element.svg();k.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value);k.attributes.width=new b.Property("width",d+"px");k.attributes.height=new b.Property("height",m+"px");k.attributes.transform=new b.Property("transform",this.attribute("patternTransform").value);k.children=this.children;var h=document.createElement("canvas");h.width=d;h.height=m;var e=h.getContext("2d");if(this.attribute("x").hasValue()&&this.attribute("y").hasValue()){e.translate(this.attribute("x").toPixels("x",true),this.attribute("y").toPixels("y",true))}for(var l=-1;l<=1;l++){for(var j=-1;j<=1;j++){e.save();e.translate(l*h.width,j*h.height);k.render(e);e.restore()}}var g=n.createPattern(h,"repeat");return g}};b.Element.pattern.prototype=new b.Element.ElementBase;b.Element.marker=function(c){this.base=b.Element.ElementBase;this.base(c);this.baseRender=this.render;this.render=function(e,d,g){e.translate(d.x,d.y);if(this.attribute("orient").valueOrDefault("auto")=="auto"){e.rotate(g)}if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"){e.scale(e.lineWidth,e.lineWidth)}e.save();var f=new b.Element.svg();f.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value);f.attributes.refX=new b.Property("refX",this.attribute("refX").value);f.attributes.refY=new b.Property("refY",this.attribute("refY").value);f.attributes.width=new b.Property("width",this.attribute("markerWidth").value);f.attributes.height=new b.Property("height",this.attribute("markerHeight").value);f.attributes.fill=new b.Property("fill",this.attribute("fill").valueOrDefault("black"));f.attributes.stroke=new b.Property("stroke",this.attribute("stroke").valueOrDefault("none"));f.children=this.children;f.render(e);e.restore();if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"){e.scale(1/e.lineWidth,1/e.lineWidth)}if(this.attribute("orient").valueOrDefault("auto")=="auto"){e.rotate(-g)}e.translate(-d.x,-d.y)}};b.Element.marker.prototype=new b.Element.ElementBase;b.Element.defs=function(c){this.base=b.Element.ElementBase;this.base(c);this.render=function(d){}};b.Element.defs.prototype=new b.Element.ElementBase;b.Element.GradientBase=function(d){this.base=b.Element.ElementBase;this.base(d);this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox");this.stops=[];for(var c=0;c<this.children.length;c++){var e=this.children[c];if(e.type=="stop"){this.stops.push(e)}}this.getGradient=function(){};this.createGradient=function(t,k,f){var s=this;if(this.getHrefAttribute().hasValue()){s=this.getHrefAttribute().getDefinition()}var j=function(g){if(f.hasValue()){var u=new b.Property("color",g);return u.addOpacity(f.value).value}return g};var m=this.getGradient(t,k);if(m==null){return j(s.stops[s.stops.length-1].color)}for(var l=0;l<s.stops.length;l++){m.addColorStop(s.stops[l].offset,j(s.stops[l].color))}if(this.attribute("gradientTransform").hasValue()){var o=b.ViewPort.viewPorts[0];var p=new b.Element.rect();p.attributes.x=new b.Property("x",-b.MAX_VIRTUAL_PIXELS/3);p.attributes.y=new b.Property("y",-b.MAX_VIRTUAL_PIXELS/3);p.attributes.width=new b.Property("width",b.MAX_VIRTUAL_PIXELS);p.attributes.height=new b.Property("height",b.MAX_VIRTUAL_PIXELS);var r=new b.Element.g();r.attributes.transform=new b.Property("transform",this.attribute("gradientTransform").value);r.children=[p];var q=new b.Element.svg();q.attributes.x=new b.Property("x",0);q.attributes.y=new b.Property("y",0);q.attributes.width=new b.Property("width",o.width);q.attributes.height=new b.Property("height",o.height);q.children=[r];var n=document.createElement("canvas");n.width=o.width;n.height=o.height;var h=n.getContext("2d");h.fillStyle=m;q.render(h);return h.createPattern(n,"no-repeat")}return m}};b.Element.GradientBase.prototype=new b.Element.ElementBase;b.Element.linearGradient=function(c){this.base=b.Element.GradientBase;this.base(c);this.getGradient=function(d,h){var k=h.getBoundingBox();if(!this.attribute("x1").hasValue()&&!this.attribute("y1").hasValue()&&!this.attribute("x2").hasValue()&&!this.attribute("y2").hasValue()){this.attribute("x1",true).value=0;this.attribute("y1",true).value=0;this.attribute("x2",true).value=1;this.attribute("y2",true).value=0}var f=(this.gradientUnits=="objectBoundingBox"?k.x()+k.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"));var j=(this.gradientUnits=="objectBoundingBox"?k.y()+k.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"));var e=(this.gradientUnits=="objectBoundingBox"?k.x()+k.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"));var g=(this.gradientUnits=="objectBoundingBox"?k.y()+k.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y"));if(f==e&&j==g){return null}return d.createLinearGradient(f,j,e,g)}};b.Element.linearGradient.prototype=new b.Element.GradientBase;b.Element.radialGradient=function(c){this.base=b.Element.GradientBase;this.base(c);this.getGradient=function(e,f){var k=f.getBoundingBox();if(!this.attribute("cx").hasValue()){this.attribute("cx",true).value="50%"}if(!this.attribute("cy").hasValue()){this.attribute("cy",true).value="50%"}if(!this.attribute("r").hasValue()){this.attribute("r",true).value="50%"}var d=(this.gradientUnits=="objectBoundingBox"?k.x()+k.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"));var l=(this.gradientUnits=="objectBoundingBox"?k.y()+k.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"));var j=d;var g=l;if(this.attribute("fx").hasValue()){j=(this.gradientUnits=="objectBoundingBox"?k.x()+k.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x"))}if(this.attribute("fy").hasValue()){g=(this.gradientUnits=="objectBoundingBox"?k.y()+k.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"))}var h=(this.gradientUnits=="objectBoundingBox"?(k.width()+k.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels());return e.createRadialGradient(j,g,0,d,l,h)}};b.Element.radialGradient.prototype=new b.Element.GradientBase;b.Element.stop=function(d){this.base=b.Element.ElementBase;this.base(d);this.offset=this.attribute("offset").numValue();if(this.offset<0){this.offset=0}if(this.offset>1){this.offset=1}var c=this.style("stop-color");if(this.style("stop-opacity").hasValue()){c=c.addOpacity(this.style("stop-opacity").value)}this.color=c.value};b.Element.stop.prototype=new b.Element.ElementBase;b.Element.AnimateBase=function(c){this.base=b.Element.ElementBase;this.base(c);b.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").toMilliseconds();this.getProperty=function(){var e=this.attribute("attributeType").value;var d=this.attribute("attributeName").value;if(e=="CSS"){return this.parent.style(d,true)}return this.parent.attribute(d,true)};this.initialValue=null;this.initialUnits="";this.removed=false;this.calcValue=function(){return""};this.update=function(g){if(this.initialValue==null){this.initialValue=this.getProperty().value;this.initialUnits=this.getProperty().getUnits()}if(this.duration>this.maxDuration){if(this.attribute("repeatCount").value=="indefinite"||this.attribute("repeatDur").value=="indefinite"){this.duration=0}else{if(this.attribute("fill").valueOrDefault("remove")=="remove"&&!this.removed){this.removed=true;this.getProperty().value=this.initialValue;return true}else{return false}}}this.duration=this.duration+g;var d=false;if(this.begin<this.duration){var f=this.calcValue();if(this.attribute("type").hasValue()){var e=this.attribute("type").value;f=e+"("+f+")"}this.getProperty().value=f;d=true}return d};this.from=this.attribute("from");this.to=this.attribute("to");this.values=this.attribute("values");if(this.values.hasValue()){this.values.value=this.values.value.split(";")}this.progress=function(){var e={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var g=e.progress*(this.values.value.length-1);var f=Math.floor(g),d=Math.ceil(g);e.from=new b.Property("from",parseFloat(this.values.value[f]));e.to=new b.Property("to",parseFloat(this.values.value[d]));e.progress=(g-f)/(d-f)}else{e.from=this.from;e.to=this.to}return e}};b.Element.AnimateBase.prototype=new b.Element.ElementBase;b.Element.animate=function(c){this.base=b.Element.AnimateBase;this.base(c);this.calcValue=function(){var e=this.progress();var d=e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress;return d+this.initialUnits}};b.Element.animate.prototype=new b.Element.AnimateBase;b.Element.animateColor=function(c){this.base=b.Element.AnimateBase;this.base(c);this.calcValue=function(){var h=this.progress();var k=new RGBColor(h.from.value);var j=new RGBColor(h.to.value);if(k.ok&&j.ok){var f=k.r+(j.r-k.r)*h.progress;var e=k.g+(j.g-k.g)*h.progress;var d=k.b+(j.b-k.b)*h.progress;return"rgb("+parseInt(f,10)+","+parseInt(e,10)+","+parseInt(d,10)+")"}return this.attribute("from").value}};b.Element.animateColor.prototype=new b.Element.AnimateBase;b.Element.animateTransform=function(c){this.base=b.Element.AnimateBase;this.base(c);this.calcValue=function(){var f=this.progress();var h=b.ToNumberArray(f.from.value);var g=b.ToNumberArray(f.to.value);var e="";for(var d=0;d<h.length;d++){e+=h[d]+(g[d]-h[d])*f.progress+" "}return e}};b.Element.animateTransform.prototype=new b.Element.animate;b.Element.font=function(d){this.base=b.Element.ElementBase;this.base(d);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.isRTL=false;this.isArabic=false;this.fontFace=null;this.missingGlyph=null;this.glyphs=[];for(var c=0;c<this.children.length;c++){var e=this.children[c];if(e.type=="font-face"){this.fontFace=e;if(e.style("font-family").hasValue()){b.Definitions[e.style("font-family").value]=this}}else{if(e.type=="missing-glyph"){this.missingGlyph=e}else{if(e.type=="glyph"){if(e.arabicForm!=""){this.isRTL=true;this.isArabic=true;if(typeof(this.glyphs[e.unicode])=="undefined"){this.glyphs[e.unicode]=[]}this.glyphs[e.unicode][e.arabicForm]=e}else{this.glyphs[e.unicode]=e}}}}}};b.Element.font.prototype=new b.Element.ElementBase;b.Element.fontface=function(c){this.base=b.Element.ElementBase;this.base(c);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()};b.Element.fontface.prototype=new b.Element.ElementBase;b.Element.missingglyph=function(c){this.base=b.Element.path;this.base(c);this.horizAdvX=0};b.Element.missingglyph.prototype=new b.Element.path;b.Element.glyph=function(c){this.base=b.Element.path;this.base(c);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value};b.Element.glyph.prototype=new b.Element.path;b.Element.text=function(c){this.captureTextNodes=true;this.base=b.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(d){this.baseSetContext(d);if(this.style("dominant-baseline").hasValue()){d.textBaseline=this.style("dominant-baseline").value}if(this.style("alignment-baseline").hasValue()){d.textBaseline=this.style("alignment-baseline").value}};this.getBoundingBox=function(){return new b.BoundingBox(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"),0,0)};this.renderChildren=function(d){this.x=this.attribute("x").toPixels("x");this.y=this.attribute("y").toPixels("y");this.x+=this.getAnchorDelta(d,this,0);for(var e=0;e<this.children.length;e++){this.renderChild(d,this,e)}};this.getAnchorDelta=function(e,j,h){var d=this.style("text-anchor").valueOrDefault("start");if(d!="start"){var g=0;for(var f=h;f<j.children.length;f++){var k=j.children[f];if(f>h&&k.attribute("x").hasValue()){break}g+=k.measureTextRecursive(e)}return -1*(d=="end"?g:g/2)}return 0};this.renderChild=function(d,f,e){var g=f.children[e];if(g.attribute("x").hasValue()){g.x=g.attribute("x").toPixels("x")+this.getAnchorDelta(d,f,e)}else{if(this.attribute("dx").hasValue()){this.x+=this.attribute("dx").toPixels("x")}if(g.attribute("dx").hasValue()){this.x+=g.attribute("dx").toPixels("x")}g.x=this.x}this.x=g.x+g.measureText(d);if(g.attribute("y").hasValue()){g.y=g.attribute("y").toPixels("y")}else{if(this.attribute("dy").hasValue()){this.y+=this.attribute("dy").toPixels("y")}if(g.attribute("dy").hasValue()){this.y+=g.attribute("dy").toPixels("y")}g.y=this.y}this.y=g.y;g.render(d);for(var e=0;e<g.children.length;e++){this.renderChild(d,g,e)}}};b.Element.text.prototype=new b.Element.RenderedElementBase;b.Element.TextElementBase=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.getGlyph=function(d,h,e){var j=h[e];var f=null;if(d.isArabic){var g="isolated";if((e==0||h[e-1]==" ")&&e<h.length-2&&h[e+1]!=" "){g="terminal"}if(e>0&&h[e-1]!=" "&&e<h.length-2&&h[e+1]!=" "){g="medial"}if(e>0&&h[e-1]!=" "&&(e==h.length-1||h[e+1]==" ")){g="initial"}if(typeof(d.glyphs[j])!="undefined"){f=d.glyphs[j][g];if(f==null&&d.glyphs[j].type=="glyph"){f=d.glyphs[j]}}}else{f=d.glyphs[j]}if(f==null){f=d.missingGlyph}return f};this.renderChildren=function(l){var j=this.parent.style("font-family").getDefinition();if(j!=null){var m=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize);var f=this.parent.style("font-style").valueOrDefault(b.Font.Parse(b.ctx.font).fontStyle);var k=this.getText();if(j.isRTL){k=k.split("").reverse().join("")}var n=b.ToNumberArray(this.parent.attribute("dx").value);for(var g=0;g<k.length;g++){var h=this.getGlyph(j,k,g);var e=m/j.fontFace.unitsPerEm;l.translate(this.x,this.y);l.scale(e,-e);var d=l.lineWidth;l.lineWidth=l.lineWidth*j.fontFace.unitsPerEm/m;if(f=="italic"){l.transform(1,0,0.4,1,0,0)}h.render(l);if(f=="italic"){l.transform(1,0,-0.4,1,0,0)}l.lineWidth=d;l.scale(1/e,-1/e);l.translate(-this.x,-this.y);this.x+=m*(h.horizAdvX||j.horizAdvX)/j.fontFace.unitsPerEm;if(typeof(n[g])!="undefined"&&!isNaN(n[g])){this.x+=n[g]}}return}if(l.fillStyle!=""){l.fillText(b.compressSpaces(this.getText()),this.x,this.y)}if(l.strokeStyle!=""){l.strokeText(b.compressSpaces(this.getText()),this.x,this.y)}};this.getText=function(){};this.measureTextRecursive=function(d){var f=this.measureText(d);for(var e=0;e<this.children.length;e++){f+=this.children[e].measureTextRecursive(d)}return f};this.measureText=function(l){var j=this.parent.style("font-family").getDefinition();if(j!=null){var m=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize);var e=0;var k=this.getText();if(j.isRTL){k=k.split("").reverse().join("")}var n=b.ToNumberArray(this.parent.attribute("dx").value);for(var g=0;g<k.length;g++){var h=this.getGlyph(j,k,g);e+=(h.horizAdvX||j.horizAdvX)*m/j.fontFace.unitsPerEm;if(typeof(n[g])!="undefined"&&!isNaN(n[g])){e+=n[g]}}return e}var d=b.compressSpaces(this.getText());if(!l.measureText){return d.length*10}l.save();this.setContext(l);var f=l.measureText(d).width;l.restore();return f}};b.Element.TextElementBase.prototype=new b.Element.RenderedElementBase;b.Element.tspan=function(c){this.captureTextNodes=true;this.base=b.Element.TextElementBase;this.base(c);this.text=c.nodeValue||c.text||"";this.getText=function(){return this.text}};b.Element.tspan.prototype=new b.Element.TextElementBase;b.Element.tref=function(c){this.base=b.Element.TextElementBase;this.base(c);this.getText=function(){var d=this.getHrefAttribute().getDefinition();if(d!=null){return d.children[0].getText()}}};b.Element.tref.prototype=new b.Element.TextElementBase;b.Element.a=function(d){this.base=b.Element.TextElementBase;this.base(d);this.hasText=true;for(var c=0;c<d.childNodes.length;c++){if(d.childNodes[c].nodeType!=3){this.hasText=false}}this.text=this.hasText?d.childNodes[0].nodeValue:"";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(e){if(this.hasText){this.baseRenderChildren(e);var h=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize);b.Mouse.checkBoundingBox(this,new b.BoundingBox(this.x,this.y-h.toPixels("y"),this.x+this.measureText(e),this.y))}else{var f=new b.Element.g();f.children=this.children;f.parent=this;f.render(e)}};this.onclick=function(){window.open(this.getHrefAttribute().value)};this.onmousemove=function(){b.ctx.canvas.style.cursor="pointer"}};b.Element.a.prototype=new b.Element.TextElementBase;b.Element.image=function(e){this.base=b.Element.RenderedElementBase;this.base(e);var d=this.getHrefAttribute().value;var f=d.match(/\.svg$/);b.Images.push(this);this.loaded=false;if(!f){this.img=document.createElement("img");var c=this;this.img.onload=function(){c.loaded=true};this.img.onerror=function(){if(typeof(console)!="undefined"){console.log('ERROR: image "'+d+'" not found');c.loaded=true}};this.img.src=d}else{this.img=b.ajax(d);this.loaded=true}this.renderChildren=function(j){var h=this.attribute("x").toPixels("x");var l=this.attribute("y").toPixels("y");var k=this.attribute("width").toPixels("x");var g=this.attribute("height").toPixels("y");if(k==0||g==0){return}j.save();if(f){j.drawSvg(this.img,h,l,k,g)}else{j.translate(h,l);b.AspectRatio(j,this.attribute("preserveAspectRatio").value,k,this.img.width,g,this.img.height,0,0);j.drawImage(this.img,0,0)}j.restore()};this.getBoundingBox=function(){var h=this.attribute("x").toPixels("x");var k=this.attribute("y").toPixels("y");var j=this.attribute("width").toPixels("x");var g=this.attribute("height").toPixels("y");return new b.BoundingBox(h,k,h+j,k+g)}};b.Element.image.prototype=new b.Element.RenderedElementBase;b.Element.g=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.getBoundingBox=function(){var e=new b.BoundingBox();for(var d=0;d<this.children.length;d++){e.addBoundingBox(this.children[d].getBoundingBox())}return e}};b.Element.g.prototype=new b.Element.RenderedElementBase;b.Element.symbol=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(e){this.baseSetContext(e);if(this.attribute("viewBox").hasValue()){var f=b.ToNumberArray(this.attribute("viewBox").value);var d=f[0];var g=f[1];width=f[2];height=f[3];b.AspectRatio(e,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,d,g);b.ViewPort.SetCurrent(f[2],f[3])}}};b.Element.symbol.prototype=new b.Element.RenderedElementBase;b.Element.style=function(w){this.base=b.Element.ElementBase;this.base(w);var r="";for(var z=0;z<w.childNodes.length;z++){r+=w.childNodes[z].nodeValue}r=r.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");r=b.compressSpaces(r);var q=r.split("}");for(var z=0;z<q.length;z++){if(b.trim(q[z])!=""){var D=q[z].split("{");var g=D[0].split(",");var c=D[1].split(";");for(var y=0;y<g.length;y++){var o=b.trim(g[y]);if(o!=""){var e={};for(var x=0;x<c.length;x++){var d=c[x].indexOf(":");var E=c[x].substr(0,d);var v=c[x].substr(d+1,c[x].length-d);if(E!=null&&v!=null){e[b.trim(E)]=new b.Property(b.trim(E),b.trim(v))}}b.Styles[o]=e;if(o=="@font-face"){var B=e["font-family"].value.replace(/"/g,"");var p=e.src.value.split(",");for(var t=0;t<p.length;t++){if(p[t].indexOf('format("svg")')>0){var m=p[t].indexOf("url");var l=p[t].indexOf(")",m);var h=p[t].substr(m+5,l-m-6);var C=b.parseXml(b.ajax(h));var n=C.getElementsByTagName("font");for(var A=0;A<n.length;A++){var u=b.CreateElement(n[A]);b.Definitions[B]=u}}}}}}}}};b.Element.style.prototype=new b.Element.ElementBase;b.Element.use=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(d){this.baseSetContext(d);if(this.attribute("x").hasValue()){d.translate(this.attribute("x").toPixels("x"),0)}if(this.attribute("y").hasValue()){d.translate(0,this.attribute("y").toPixels("y"))}};this.getDefinition=function(){var d=this.getHrefAttribute().getDefinition();if(this.attribute("width").hasValue()){d.attribute("width",true).value=this.attribute("width").value}if(this.attribute("height").hasValue()){d.attribute("height",true).value=this.attribute("height").value}return d};this.path=function(d){var e=this.getDefinition();if(e!=null){e.path(d)}};this.getBoundingBox=function(){var d=this.getDefinition();if(d!=null){return d.getBoundingBox()}};this.renderChildren=function(d){var f=this.getDefinition();if(f!=null){var e=f.parent;f.parent=null;f.render(d);f.parent=e}}};b.Element.use.prototype=new b.Element.RenderedElementBase;b.Element.mask=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(o,f){var m=this.attribute("x").toPixels("x");var l=this.attribute("y").toPixels("y");var d=this.attribute("width").toPixels("x");var n=this.attribute("height").toPixels("y");if(d==0&&n==0){var h=new b.BoundingBox();for(var g=0;g<this.children.length;g++){h.addBoundingBox(this.children[g].getBoundingBox())}var m=Math.floor(h.x1);var l=Math.floor(h.y1);var d=Math.floor(h.width());var n=Math.floor(h.height())}var q=f.attribute("mask").value;f.attribute("mask").value="";var k=document.createElement("canvas");k.width=m+d;k.height=l+n;var p=k.getContext("2d");this.renderChildren(p);var j=document.createElement("canvas");j.width=m+d;j.height=l+n;var e=j.getContext("2d");f.render(e);e.globalCompositeOperation="destination-in";e.fillStyle=p.createPattern(k,"no-repeat");e.fillRect(0,0,m+d,l+n);o.fillStyle=e.createPattern(j,"no-repeat");o.fillRect(0,0,m+d,l+n);f.attribute("mask").value=q};this.render=function(d){}};b.Element.mask.prototype=new b.Element.ElementBase;b.Element.clipPath=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(d){for(var f=0;f<this.children.length;f++){var g=this.children[f];if(typeof(g.path)!="undefined"){var e=null;if(g.attribute("transform").hasValue()){e=new b.Transform(g.attribute("transform").value);e.apply(d)}g.path(d);d.clip();if(e){e.unapply(d)}}}};this.render=function(d){}};b.Element.clipPath.prototype=new b.Element.ElementBase;b.Element.filter=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(r,j){var k=j.getBoundingBox();var o=Math.floor(k.x1);var m=Math.floor(k.y1);var e=Math.floor(k.width());var q=Math.floor(k.height());var f=j.style("filter").value;j.style("filter").value="";var p=0,n=0;for(var h=0;h<this.children.length;h++){var d=this.children[h].extraFilterDistance||0;p=Math.max(p,d);n=Math.max(n,d)}var l=document.createElement("canvas");l.width=e+2*p;l.height=q+2*n;var g=l.getContext("2d");g.translate(-o+p,-m+n);j.render(g);for(var h=0;h<this.children.length;h++){this.children[h].apply(g,0,0,e+2*p,q+2*n)}r.drawImage(l,0,0,e+2*p,q+2*n,o-p,m-n,e+2*p,q+2*n);j.style("filter",true).value=f};this.render=function(d){}};b.Element.filter.prototype=new b.Element.ElementBase;b.Element.feMorphology=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(f,e,h,g,d){}};b.Element.feMorphology.prototype=new b.Element.ElementBase;b.Element.feColorMatrix=function(e){this.base=b.Element.ElementBase;this.base(e);function d(h,g,l,k,f,j){return h[l*k*4+g*4+j]}function c(h,g,m,k,f,j,l){h[m*k*4+g*4+j]=l}this.apply=function(q,n,m,h,p){var k=q.getImageData(0,0,h,p);for(var m=0;m<p;m++){for(var n=0;n<h;n++){var f=d(k.data,n,m,h,p,0);var j=d(k.data,n,m,h,p,1);var l=d(k.data,n,m,h,p,2);var o=(f+j+l)/3;c(k.data,n,m,h,p,0,o);c(k.data,n,m,h,p,1,o);c(k.data,n,m,h,p,2,o)}}q.clearRect(0,0,h,p);q.putImageData(k,0,0)}};b.Element.feColorMatrix.prototype=new b.Element.ElementBase;b.Element.feGaussianBlur=function(c){this.base=b.Element.ElementBase;this.base(c);this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue());this.extraFilterDistance=this.blurRadius;this.apply=function(f,e,h,g,d){if(typeof(stackBlurCanvasRGBA)=="undefined"){if(typeof(console)!="undefined"){console.log("ERROR: StackBlur.js must be included for blur to work")}return}f.canvas.id=b.UniqueId();f.canvas.style.display="none";document.body.appendChild(f.canvas);stackBlurCanvasRGBA(f.canvas.id,e,h,g,d,this.blurRadius);document.body.removeChild(f.canvas)}};b.Element.feGaussianBlur.prototype=new b.Element.ElementBase;b.Element.title=function(c){};b.Element.title.prototype=new b.Element.ElementBase;b.Element.desc=function(c){};b.Element.desc.prototype=new b.Element.ElementBase;b.Element.MISSING=function(c){if(typeof(console)!="undefined"){console.log("ERROR: Element '"+c.nodeName+"' not yet implemented.")}};b.Element.MISSING.prototype=new b.Element.ElementBase;b.CreateElement=function(d){var c=d.nodeName.replace(/^[^:]+:/,"");c=c.replace(/\-/g,"");var f=null;if(typeof(b.Element[c])!="undefined"){f=new b.Element[c](d)}else{f=new b.Element.MISSING(d)}f.type=d.nodeName;return f};b.load=function(c,d){b.loadXml(c,b.ajax(d))};b.loadXml=function(c,d){b.loadXmlDoc(c,b.parseXml(d))};b.loadXmlDoc=function(g,k){b.init(g);var f=function(m){var l=g.canvas;while(l){m.x-=l.offsetLeft;m.y-=l.offsetTop;l=l.offsetParent}if(window.scrollX){m.x+=window.scrollX}if(window.scrollY){m.y+=window.scrollY}return m};if(b.opts.ignoreMouse!=true){g.canvas.onclick=function(m){var l=f(new b.Point(m!=null?m.clientX:event.clientX,m!=null?m.clientY:event.clientY));b.Mouse.onclick(l.x,l.y)};g.canvas.onmousemove=function(m){var l=f(new b.Point(m!=null?m.clientX:event.clientX,m!=null?m.clientY:event.clientY));b.Mouse.onmousemove(l.x,l.y)}}var j=b.CreateElement(k.documentElement);j.root=true;var h=true;var d=function(){b.ViewPort.Clear();if(g.canvas.parentNode){b.ViewPort.SetCurrent(g.canvas.parentNode.clientWidth,g.canvas.parentNode.clientHeight)}if(b.opts.ignoreDimensions!=true){if(j.style("width").hasValue()){g.canvas.width=j.style("width").toPixels("x");g.canvas.style.width=g.canvas.width+"px"}if(j.style("height").hasValue()){g.canvas.height=j.style("height").toPixels("y");g.canvas.style.height=g.canvas.height+"px"}}var m=g.canvas.clientWidth||g.canvas.width;var l=g.canvas.clientHeight||g.canvas.height;if(b.opts.ignoreDimensions==true&&j.style("width").hasValue()&&j.style("height").hasValue()){m=j.style("width").toPixels("x");l=j.style("height").toPixels("y")}b.ViewPort.SetCurrent(m,l);if(b.opts.offsetX!=null){j.attribute("x",true).value=b.opts.offsetX}if(b.opts.offsetY!=null){j.attribute("y",true).value=b.opts.offsetY}if(b.opts.scaleWidth!=null&&b.opts.scaleHeight!=null){var n=1,e=1,o=b.ToNumberArray(j.attribute("viewBox").value);if(j.attribute("width").hasValue()){n=j.attribute("width").toPixels("x")/b.opts.scaleWidth}else{if(!isNaN(o[2])){n=o[2]/b.opts.scaleWidth}}if(j.attribute("height").hasValue()){e=j.attribute("height").toPixels("y")/b.opts.scaleHeight}else{if(!isNaN(o[3])){e=o[3]/b.opts.scaleHeight}}j.attribute("width",true).value=b.opts.scaleWidth;j.attribute("height",true).value=b.opts.scaleHeight;j.attribute("viewBox",true).value="0 0 "+(m*n)+" "+(l*e);j.attribute("preserveAspectRatio",true).value="none"}if(b.opts.ignoreClear!=true){g.clearRect(0,0,m,l)}j.render(g);if(h){h=false;if(typeof(b.opts.renderCallback)=="function"){b.opts.renderCallback(k)}}};var c=true;if(b.ImagesLoaded()){c=false;d()}b.intervalID=setInterval(function(){var l=false;if(c&&b.ImagesLoaded()){c=false;l=true}if(b.opts.ignoreMouse!=true){l=l|b.Mouse.hasEvents()}if(b.opts.ignoreAnimation!=true){for(var e=0;e<b.Animations.length;e++){l=l|b.Animations[e].update(1000/b.FRAMERATE)}}if(typeof(b.opts.forceRedraw)=="function"){if(b.opts.forceRedraw()==true){l=true}}if(l){d();b.Mouse.runEvents()}},1000/b.FRAMERATE)};b.stop=function(){if(b.intervalID){clearInterval(b.intervalID)}};b.Mouse=new (function(){this.events=[];this.hasEvents=function(){return this.events.length!=0};this.onclick=function(c,d){this.events.push({type:"onclick",x:c,y:d,run:function(f){if(f.onclick){f.onclick()}}})};this.onmousemove=function(c,d){this.events.push({type:"onmousemove",x:c,y:d,run:function(f){if(f.onmousemove){f.onmousemove()}}})};this.eventElements=[];this.checkPath=function(f,c){for(var d=0;d<this.events.length;d++){var g=this.events[d];if(c.isPointInPath&&c.isPointInPath(g.x,g.y)){this.eventElements[d]=f}}};this.checkBoundingBox=function(d,g){for(var c=0;c<this.events.length;c++){var f=this.events[c];if(g.isPointInBox(f.x,f.y)){this.eventElements[c]=d}}};this.runEvents=function(){b.ctx.canvas.style.cursor="";for(var d=0;d<this.events.length;d++){var f=this.events[d];var c=this.eventElements[d];while(c){f.run(c);c=c.parent}}this.events=[];this.eventElements=[]}});return b}})();if(typeof(CanvasRenderingContext2D)!="undefined"){CanvasRenderingContext2D.prototype.drawSvg=function(d,b,a,c,e){canvg(this.canvas,d,{ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true,offsetX:b,offsetY:a,scaleWidth:c,scaleHeight:e})}};