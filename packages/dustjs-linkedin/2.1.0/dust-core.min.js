function getGlobal(){return function(){return this.dust}.call(null)}var dust={};!function(dust){function Context(t,e,n,r){this.stack=t,this.global=e,this.blocks=n,this.templateName=r}function Stack(t,e,n,r){this.tail=e,this.isObject=!dust.isArray(t)&&t&&"object"==typeof t,this.head=t,this.index=n,this.of=r}function Stub(t){this.head=new Chunk(this),this.callback=t,this.out=""}function Stream(){this.head=new Chunk(this)}function Chunk(t,e,n){this.root=t,this.next=e,this.data=[],this.flushable=!1,this.taps=n}function Tap(t,e){this.head=t,this.tail=e}if(dust){var ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",levels=[DEBUG,INFO,WARN,ERROR],logger=function(){};dust.isDebug=!1,dust.debugLevel=INFO,"undefined"!=typeof window&&window&&window.console&&window.console.log?logger=window.console.log:"undefined"!=typeof console&&console&&console.log&&(logger=console.log),dust.log=function(t,e){var e=e||INFO;dust.isDebug&&levels.indexOf(e)>=levels.indexOf(dust.debugLevel)&&(dust.logQueue||(dust.logQueue=[]),dust.logQueue.push({message:t,type:e}),logger.call(console||window.console,"[DUST "+e+"]: "+t))},dust.onError=function(t,e){if(dust.log(t.message||t,ERROR),dust.isDebug)throw t;return e},dust.helpers={},dust.cache={},dust.register=function(t,e){t&&(dust.cache[t]=e)},dust.render=function(t,e,n){var r=new Stub(n).head;try{dust.load(t,r,Context.wrap(e,t)).end()}catch(o){dust.onError(o,r)}},dust.stream=function(t,e){var n=new Stream;return dust.nextTick(function(){try{dust.load(t,n.head,Context.wrap(e,t)).end()}catch(r){dust.onError(r,n.head)}}),n},dust.renderSource=function(t,e,n){return dust.compileFn(t)(e,n)},dust.compileFn=function(t,e){var n=dust.loadSource(dust.compile(t,e));return function(t,r){var o=r?new Stub(r):new Stream;return dust.nextTick(function(){"function"==typeof n?n(o.head,Context.wrap(t,e)).end():dust.onError(new Error("Template ["+e+"] cannot be resolved to a Dust function"))}),o}},dust.load=function(t,e,n){var r=dust.cache[t];return r?r(e,n):dust.onLoad?e.map(function(e){dust.onLoad(t,function(r,o){return r?e.setError(r):(dust.cache[t]||dust.loadSource(dust.compile(o,t)),void dust.cache[t](e,n).end())})}):e.setError(new Error("Template Not Found: "+t))},dust.loadSource=function(source,path){return eval(source)},dust.isArray=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},dust.nextTick=function(){return"undefined"!=typeof process?process.nextTick:function(t){setTimeout(t,0)}}(),dust.isEmpty=function(t){return dust.isArray(t)&&!t.length?!0:0===t?!1:!t},dust.filter=function(t,e,n){if(n)for(var r=0,o=n.length;o>r;r++){var s=n[r];"s"===s?(e=null,dust.log("Using unescape filter on ["+t+"]",DEBUG)):"function"==typeof dust.filters[s]?t=dust.filters[s](t):dust.onError(new Error("Invalid filter ["+s+"]"))}return e&&(t=dust.filters[e](t)),t},dust.filters={h:function(t){return dust.escapeHtml(t)},j:function(t){return dust.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(t){return JSON?JSON.stringify(t):(dust.log("JSON is undefined.  JSON stringify has not been used on ["+t+"]",WARN),t)},jp:function(t){return JSON?JSON.parse(t):(dust.log("JSON is undefined.  JSON parse has not been used on ["+t+"]",WARN),t)}},dust.makeBase=function(t){return new Context(new Stack,t)},Context.wrap=function(t,e){return t instanceof Context?t:new Context(new Stack(t),{},null,e)},Context.prototype.get=function(t){var e,n,r=this.stack;for(dust.log("Searching for reference [{"+t+"}] in template ["+this.templateName+"]",DEBUG);r;){if(r.isObject&&(e=r.head[t],void 0!==e))return e;r=r.tail}return n=this.global?this.global[t]:void 0,"undefined"==typeof n&&dust.log("Cannot find the value for reference [{"+t+"}] in template ["+this.templateName+"]"),n},Context.prototype.getPath=function(t,e){var n,r=this.stack,o=e.length,s=t?void 0:this.stack.tail;if(dust.log("Searching for reference [{"+e.join(".")+"}] in template ["+this.templateName+"]",DEBUG),t&&0===o)return r.head;r=r.head;for(var i=0;r&&o>i;)for(n=r,r=r[e[i]],i++;!r&&!t;){if(i>1)return r;s?(r=s.head,s=s.tail,i=0):t||(r=this.global,t=!0,i=0)}return"function"==typeof r?function(){return r.apply(n,arguments)}:r},Context.prototype.push=function(t,e,n){return new Context(new Stack(t,this.stack,e,n),this.global,this.blocks,this.templateName)},Context.prototype.rebase=function(t){return new Context(new Stack(t),this.global,this.blocks,this.templateName)},Context.prototype.current=function(){return this.stack.head},Context.prototype.getBlock=function(t){if("function"==typeof t){var e=new Chunk;t=t(e,this).data.join("")}var n=this.blocks;if(!n)return void dust.log("No blocks for context[{"+t+"}] in template ["+this.templateName+"]",DEBUG);for(var r,o=n.length;o--;)if(r=n[o][t])return r},Context.prototype.shiftBlocks=function(t){var e,n=this.blocks;return t?(e=n?n.concat([t]):[t],new Context(this.stack,this.global,e,this.templateName)):this},Stub.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.callback(t.error),dust.onError(new Error("Chunk error ["+t.error+"] thrown. Ceasing to render this template.")),void(this.flush=function(){})):void 0;this.out+=t.data.join(""),t=t.next,this.head=t}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.emit("error",t.error),dust.onError(new Error("Chunk error ["+t.error+"] thrown. Ceasing to render this template.")),void(this.flush=function(){})):void 0;this.emit("data",t.data.join("")),t=t.next,this.head=t}this.emit("end")},Stream.prototype.emit=function(t,e){if(!this.events)return dust.log("No events to emit",INFO),!1;var n=this.events[t];if(!n)return dust.log("Event type ["+t+"] does not exist",WARN),!1;if("function"==typeof n)n(e);else if(dust.isArray(n))for(var r=n.slice(0),o=0,s=r.length;s>o;o++)r[o](e);else dust.onError(new Error("Event Handler ["+n+"] is not of a type that is handled by emit"))},Stream.prototype.on=function(t,e){return this.events||(this.events={}),this.events[t]?"function"==typeof this.events[t]?this.events[t]=[this.events[t],e]:this.events[t].push(e):(dust.log("Event type ["+t+"] does not exist. Using just the specified callback.",WARN),e?this.events[t]=e:dust.log("Callback for type ["+t+"] does not exist. Listener not registered.",WARN)),this},Stream.prototype.pipe=function(t){return this.on("data",function(e){try{t.write(e,"utf8")}catch(n){dust.onError(n,t.head)}}).on("end",function(){try{return t.end()}catch(e){dust.onError(e,t.head)}}).on("error",function(e){t.error(e)}),this},Chunk.prototype.write=function(t){var e=this.taps;return e&&(t=e.go(t)),this.data.push(t),this},Chunk.prototype.end=function(t){return t&&this.write(t),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(t){var e=new Chunk(this.root,this.next,this.taps),n=new Chunk(this.root,e,this.taps);return this.next=n,this.flushable=!0,t(n),e},Chunk.prototype.tap=function(t){var e=this.taps;return this.taps=e?e.push(t):new Tap(t),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(t,e){return t(this,e)},Chunk.prototype.reference=function(t,e,n,r){return"function"==typeof t&&(t.isFunction=!0,t=t.apply(e.current(),[this,e,null,{auto:n,filters:r}]),t instanceof Chunk)?t:dust.isEmpty(t)?this:this.write(dust.filter(t,n,r))},Chunk.prototype.section=function(t,e,n,r){if("function"==typeof t&&(t=t.apply(e.current(),[this,e,n,r]),t instanceof Chunk))return t;var o=n.block,s=n["else"];if(r&&(e=e.push(r)),dust.isArray(t)){if(o){var i=t.length,u=this;if(i>0){e.stack.head&&(e.stack.head.$len=i);for(var a=0;i>a;a++)e.stack.head&&(e.stack.head.$idx=a),u=o(u,e.push(t[a],a,i));return e.stack.head&&(e.stack.head.$idx=void 0,e.stack.head.$len=void 0),u}if(s)return s(this,e)}}else if(t===!0){if(o)return o(this,e)}else if(t||0===t){if(o)return o(this,e.push(t))}else if(s)return s(this,e);return dust.log("Not rendering section (#) block in template ["+e.templateName+"], because above key was not found",DEBUG),this},Chunk.prototype.exists=function(t,e,n){var r=n.block,o=n["else"];if(dust.isEmpty(t)){if(o)return o(this,e)}else if(r)return r(this,e);return dust.log("Not rendering exists (?) block in template ["+e.templateName+"], because above key was not found",DEBUG),this},Chunk.prototype.notexists=function(t,e,n){var r=n.block,o=n["else"];if(dust.isEmpty(t)){if(r)return r(this,e)}else if(o)return o(this,e);return dust.log("Not rendering not exists (^) block check in template ["+e.templateName+"], because above key was found",DEBUG),this},Chunk.prototype.block=function(t,e,n){var r=n.block;return t&&(r=t),r?r(this,e):this},Chunk.prototype.partial=function(t,e,n){var r;r=dust.makeBase(e.global),r.blocks=e.blocks,e.stack&&e.stack.tail&&(r.stack=e.stack.tail),n&&(r=r.push(n)),t&&(r.templateName=t),r=r.push(e.stack.head);var o;return o="function"==typeof t?this.capture(t,r,function(t,e){dust.load(t,e,r).end()}):dust.load(t,this,r)},Chunk.prototype.helper=function(t,e,n,r){var o=this;try{return dust.helpers[t]?dust.helpers[t](o,e,n,r):dust.onError(new Error("Invalid helper ["+t+"]"),o)}catch(s){return dust.onError(s,o)}},Chunk.prototype.capture=function(t,e,n){return this.map(function(r){var o=new Stub(function(t,e){t?r.setError(t):n(e,r)});t(o.head,e).end()})},Chunk.prototype.setError=function(t){return this.error=t,this.root.flush(),this},Tap.prototype.push=function(t){return new Tap(t,this)},Tap.prototype.go=function(t){for(var e=this;e;)t=e.head(t),e=e.tail;return t};var HCHARS=new RegExp(/[&<>\"\']/),AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(t){return"string"==typeof t&&HCHARS.test(t)?t.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):t};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;dust.escapeJs=function(t){return"string"==typeof t?t.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):t}}}(dust),"undefined"!=typeof exports&&("undefined"!=typeof process&&require("./server")(dust),module.exports=dust);