/**
 * angular-strap
 * @version v2.0.0-beta.3 - 2014-01-15
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.select",["mgcrea.ngStrap.tooltip","mgcrea.ngStrap.helpers.parseOptions"]).run(["$templateCache",function(a){var b='<ul tabindex="-1" class="select dropdown-menu" ng-show="$isVisible()" role="select"><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $isActive($index)}"><a role="menuitem" tabindex="-1" ng-click="$select($index, $event)" ng-bind="match.label"></a><i class="glyphicon glyphicon-ok" ng-if="$isMultiple"></i></li></ul>';a.put("$select",b)}]).provider("$select",function(){var a=this.defaults={animation:"animation-fade",prefixClass:"select",placement:"bottom-left",template:"$select",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,multiple:!1,sort:!0,caretHtml:'&nbsp;<span class="caret"></span>',placeholder:"Choose among the following..."},b="ontouchstart"in window;this.$get=["$window","$document","$rootScope","$tooltip",function(c,d,e,f){function g(d,e){var g={},h=angular.extend({},a,e),i=h.controller;if(!i)throw"ngModelController required";g=f(d,h);var j=e.scope,k=g.$scope;k.$matches=[],k.$activeIndex=0,k.$isMultiple=h.multiple,k.$activate=function(a){k.$$postDigest(function(){g.activate(a)})},k.$select=function(a){k.$$postDigest(function(){g.select(a)})},k.$isVisible=function(){return g.$isVisible()},k.$isActive=function(a){return g.$isActive(a)},g.update=function(a){k.$matches=a,i.$modelValue&&a.length?k.$activeIndex=h.multiple&&angular.isArray(i.$modelValue)?i.$modelValue.map(function(a){return g.$getIndex(a)}):g.$getIndex(i.$modelValue):k.$activeIndex>=a.length&&(k.$activeIndex=h.multiple?[]:0)},g.activate=function(a){return h.multiple?(k.$activeIndex.sort(),g.$isActive(a)?k.$activeIndex.splice(k.$activeIndex.indexOf(a),1):k.$activeIndex.push(a),h.sort&&k.$activeIndex.sort()):k.$activeIndex=a,k.$activeIndex},g.select=function(a){var b=k.$matches[a].value;g.activate(a),h.multiple?i.$setViewValue(k.$activeIndex.map(function(a){return k.$matches[a].value})):i.$setViewValue(b),i.$render(),j&&j.$digest(),h.multiple||("focus"===h.trigger?d[0].blur():g.$isShown&&g.hide()),k.$emit("$select.select",b,a)},g.$isVisible=function(){return h.minLength&&i?k.$matches.length&&i.$viewValue.length>=h.minLength:k.$matches.length},g.$isActive=function(a){return h.multiple?-1!==k.$activeIndex.indexOf(a):k.$activeIndex===a},g.$getIndex=function(a){var b=k.$matches.length,c=b;if(b){for(c=b;c--&&k.$matches[c].value!==a;);if(!(0>c))return c}},g.$onElementMouseDown=function(a){c.document.activeElement===d[0]&&(d[0].blur(),a.preventDefault(),a.stopPropagation())},g.$onClick=function(){b&&d[0].focus()},g.$onMouseDown=function(a){if(a.preventDefault(),a.stopPropagation(),b){var c=angular.element(a.target);c.triggerHandler("click")}},g.$onKeyDown=function(a){if(/(38|40|13)/.test(a.keyCode)){if(a.preventDefault(),a.stopPropagation(),13===a.keyCode)return g.select(k.$activeIndex);38===a.keyCode&&k.$activeIndex>0?k.$activeIndex--:40===a.keyCode&&k.$activeIndex<k.$matches.length-1?k.$activeIndex++:angular.isUndefined(k.$activeIndex)&&(k.$activeIndex=0),k.$digest()}};var l=g.init;g.init=function(){l(),d.on("click",g.$onClick)};var m=g.destroy;g.destroy=function(){m(),d.off("click",g.$onClick)};var n=g.show;g.show=function(){n(),h.multiple&&g.$element.addClass("select-multiple"),setTimeout(function(){d.on(b?"touchstart":"mousedown",g.$onElementMouseDown),g.$element.on(b?"touchstart":"mousedown",g.$onMouseDown),h.keyboard&&d.on("keydown",g.$onKeyDown)})};var o=g.hide;return g.hide=function(){d.off(b?"touchstart":"mousedown",g.$onElementMouseDown),g.$element.off(b?"touchstart":"mousedown",g.$onMouseDown),h.keyboard&&d.off("keydown",g.$onKeyDown),o()},g}angular.element(c.document.body);return g.defaults=a,g}]}).directive("bsSelect",["$window","$parse","$q","$select","$parseOptions",function(a,b,c,d,e){var f=d.defaults;return{restrict:"EAC",require:"ngModel",link:function(a,b,c,g){var h={scope:a,controller:g};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","multiple"],function(a){angular.isDefined(c[a])&&(h[a]=c[a])});var i=e(c.ngOptions),j=d(b,h);a.$watch(i.$match[7],function(){i.valuesFn(a,g).then(function(a){j.update(a),g.$render()})}),g.$render=function(){var a,d;h.multiple&&angular.isArray(g.$modelValue)?a=g.$modelValue.map(function(a){return d=j.$getIndex(a),angular.isDefined(d)?j.$scope.$matches[d].label:!1}).filter(angular.isDefined).join(", "):(d=j.$getIndex(g.$modelValue),a=angular.isDefined(d)?j.$scope.$matches[d].label:!1),b.html((a?a:c.placeholder||f.placeholder)+f.caretHtml)},a.$on("$destroy",function(){j.destroy(),h=null,j=null})}}}]);
//# sourceMappingURL=angular-strap.min.map