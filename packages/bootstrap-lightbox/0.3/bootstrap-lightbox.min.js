!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="lightbox"]',"click.dismiss.lightbox",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".lightbox-body").load(this.options.remote);var r=this;r.$clone=r.$element.filter(":first").clone().css({position:"absolute",top:-2e3,display:"block",visibility:"visible",opacity:100}).removeClass("fade").appendTo("body"),r.$h=r.$clone.height(),r.$w=r.$clone.width(),r.$clone.remove(),r.$element.css({position:"fixed",left:e(window).width()/2-r.$w/2,top:e(window).height()/2-r.$h/2})};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(e("body").addClass("lightbox-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),t.$h=t.$element.find(".lightbox-content").height(),t.$w=t.$element.find(".lightbox-content").width();var r=0;if(t.options.resizeToFit){var i=t.$element.find("img:first");e(i).data("osizew")||e(i).data("osizew",e(i).width()),e(i).data("osizeh")||e(i).data("osizeh",e(i).height());var o=e(i).data("osizew"),a=e(i).data("osizeh");e(i).css("max-width","none"),e(i).css("max-height","none");var s=o>e(window).width(),c=a>e(window).height();if(c||s){var l=40;e(i).css("max-width",e(window).width()-l),e(i).css("max-height",e(window).height()-l),t.$w=e(i).width(),t.$h=e(i).height(),r=10}}t.$element.css({position:"fixed",left:e(window).width()/2-t.$w/2,top:e(window).height()/2-t.$h/2-r}),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1).focus(),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")}))},hide:function(t){t&&t.preventDefault(),t=e.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,e("body").removeClass("lightbox-open"),this.escape(),e(document).off("focusin.lightbox"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;e(document).on("focusin.lightbox",function(e){t.$element[0]===e.target||t.$element.has(e.target).length||t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.lightbox",function(t){console.log(t),27==t.which&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.lightbox")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&n;this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(e.proxy(this.hide,this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),r?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}},e.fn.lightbox=function(n){return this.each(function(){var r=e(this),i=r.data("lightbox"),o=e.extend({},e.fn.lightbox.defaults,r.data(),"object"==typeof n&&n);i||r.data("lightbox",i=new t(this,o)),"string"==typeof n?i[n]():o.show&&i.show()})},e.fn.lightbox.defaults={backdrop:!0,keyboard:!0,show:!0,resizeToFit:!0},e.fn.lightbox.Constructor=t,e(function(){e("body").on("click.lightbox.data-api",'[data-toggle="lightbox"]',function(t){var n,r=e(this),i=e(r.attr("data-target")||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),o=i.data("lightbox")?"toggle":e.extend({},i.data(),r.data());t.preventDefault(),i.lightbox(o).one("hide",function(){r.focus()})})})}(window.jQuery);