// ==========================================================================
// Project:   Ember Data Django Rest Adapter
// Copyright: (c) 2013 Toran Billups http://toranbillups.com
// License:   MIT
// ==========================================================================



// Version: 0.13.1
// Last commit: 198e16f (2013-08-01 10:09:55 -0400)


!function(){var t,e;!function(){var n={},i={};t=function(t,e,i){n[t]={deps:e,callback:i}},e=function(t){if(i[t])return i[t];i[t]={};var r,o,a,s,u;if(r=n[t],!r)throw new Error("Module '"+t+"' not found.");o=r.deps,a=r.callback,s=[];for(var h=0,d=o.length;d>h;h++)"exports"===o[h]?s.push(u={}):s.push(e(o[h]));var c=a.apply(this,s);return i[t]=u||c}}(),function(){DS.DjangoRESTSerializer=DS.RESTSerializer.extend({patchInJSONRoot:function(t,e,n){var i,r;return i={},r=this.rootForType(e),n===!0&&(r=this.pluralize(r)),i[r]=t,i},keyForHasMany:function(t,e){return this.keyForAttributeName(t,e)},keyForBelongsTo:function(t,e){return this.keyForAttributeName(t,e)},extract:function(t,e,n,i){e=this.patchInJSONRoot(e,n,!1),this._super(t,e,n,i)},extractMany:function(t,e,n,i){e=this.patchInJSONRoot(e,n,!0),this._super(t,e,n,i)},addHasMany:function(t,e,n,i){var r,o,a=e.constructor,s=i.key,u=[],h=i.options&&i.options.polymorphic;r=e.get(s),o=this.embeddedType(a,s),"always"!==o?r.forEach(function(t){u.push(this.serializeId(t.id))},this):r.forEach(function(t){u.push(this.serialize(t,{includeId:!0,includeType:h}))},this),t[n]=u}})}(),function(){function t(t){throw Ember.Logger.error(t,t.message),t}DS.DjangoRESTAdapter=DS.RESTAdapter.extend({bulkCommit:!1,serializer:DS.DjangoRESTSerializer,createRecord:function(e,n,i){var r,o,a;return r=this.rootForType(n),o=this,a=this.serialize(i),this.ajax(this.buildURL(r),"POST",{data:a}).then(function(t){o.didCreateRecord(e,n,i,t)},function(t){throw o.didError(e,n,i,t),t}).then(null,t)},updateRecord:function(e,n,i){var r,o,a,s;return r=Ember.get(i,"id"),o=this.rootForType(n),a=this,s=this.serialize(i),this.ajax(this.buildURL(o,r),"PUT",{data:s}).then(function(t){a.didUpdateRecord(e,n,i,t)},function(t){throw a.didError(e,n,i,t),t}).then(null,t)},findMany:function(e,n,i,r){var o,a,s;return o=this,r?s=this.buildFindManyUrlWithParent(n,r):(a=this.rootForType(n),s=this.buildURL(a)),this.ajax(s,"GET",{}).then(function(t){o.didFindMany(e,n,t)}).then(null,t)},ajax:function(t,e,n){return n=n||{},n.cache=!1,this._super(t,e,n)},buildURL:function(t,e){var n=this._super(t,e);return"/"!==n.charAt(n.length-1)&&(n+="/"),n},buildFindManyUrlWithParent:function(t,e){var n,i,r,o,a;return r=e.get("findManyKey"),o=e.get("findManyType"),"string"!=typeof r&&e.eachRelationship(function(e,n){"hasMany"===n.kind&&n.type===t&&(r=n.key,o=n.parentType)}),r=this.serializer.keyForAttributeName(o,r),a=e.get("id"),n=this.rootForType(o),i=this.buildURL(n,a),i+r+"/"},didError:function(t,e,n,i){if(400===i.status){var r=JSON.parse(i.responseText),o={};n.eachAttribute(function(t){var n=this.serializer.keyForAttributeName(e,t);n in r&&(o[t]=r[n])},this),n.eachRelationship(function(t,n){var i;i="belongsTo"===n.kind?this.serializer.keyForBelongsTo(e,t):this.serializer.keyForHasMany(e,t),i in r&&(o[t]=r[i])},this),t.recordWasInvalid(n,o)}else this._super(t,e,n,i)}})}(),function(){DS.DjangoRESTStore=DS.Store.extend({findMany:function(t,e,n,i){var r;return"object"==typeof i&&"hasMany"===i.kind&&(n.set("findManyKey",i.key),n.set("findManyType",i.parentType)),r=this._super(t,e,n,i),n.set("findManyKey",null),n.set("findManyType",null),r}})}()}(),"undefined"==typeof location||"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname||Ember.Logger.warn("You are running a production build of Ember on localhost and won't receive detailed error messages. If you want full error messages please use the non-minified build provided on the Ember website.");