!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("AniJS requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=function(){var b=this,c="data-anijs",d="default",e="$",f="if",g="on",h="do",i="to";b._initializer=function(){b.helperCollection={},b.eventCollection={},b.eventIdCounter=0;var a=b._createDefaultHelper();b.registerHelper(d,a),b.helperDefaultIndex=d,b.rootDOMTravelScope=document,b.Parser=b._createParser(),b.animationEndEvent=b._animationEndPrefix(),b.classNamesWhenAnim=""},b.setDOMRootTravelScope=function(a){var c;try{"document"===a?c=document:(c=document.querySelector(a),c||(c=document))}catch(d){c=document}b.rootDOMTravelScope=c},b.run=function(){var a=[],d={};b.purgeAll(),a=b._findAniJSNodeCollection(b.rootDOMTravelScope);var e,f=a.length,g=0;for(g;f>g;g++)e=a[g],d=b._getParsedAniJSSentenceCollection(e.getAttribute(c)),b._setupElementAnim(e,d)},b.createAnimation=function(a,c){var d=c||"";b._setupElementAnim(d,a)},b.getHelper=function(a){var c=b.helperCollection;return c[a]||c[d]},b.registerHelper=function(a,c){b.helperCollection[a]=c},b.purge=function(a){if(a&&""!==a&&" "!==a){var c=document.querySelectorAll(a),d=c.length,e=0;for(e;d>e;e++)b._purgeNode(c[e])}},b.purgeAll=function(){var a,c,d=b.eventCollection,e=Object.keys(d),f=e.length,g=0;for(g;f>g;g++)a=e[g],c=d[a],c&&c.handleCollection&&c.handleCollection.length>0&&b._purgeNode(c.handleCollection[0].element),delete d[a]},b.setClassNamesWhenAnim=function(a){b.classNamesWhenAnim=" "+a},b._createDefaultHelper=function(){var a={removeAnim:function(a,b){b.nodeHelper.removeClass(a.target,b.behavior)}};return a},b._createParser=function(){return new k},b._setupElementAnim=function(a,c){var d,e=c.length,f=0;for(f;e>f;f++)d=c[f],b._setupElementSentenceAnim(a,d)},b._setupElementSentenceAnim=function(a,c){var d=b._eventHelper(c),e=b._eventTargetHelper(a,c);if(""!==d){var f,g=e.length,h=0;for(h;g>h;h++){f=e[h];var i=function(d){var e=b._behaviorTargetHelper(a,c),f=b._behaviorHelper(c),g=b._beforeHelper(a,c),h=b._afterHelper(a,c);""!==b.classNamesWhenAnim&&(f+=b.classNamesWhenAnim);var i={behaviorTargetList:e,nodeHelper:l,animationEndEvent:b.animationEndEvent,behavior:f,after:h},k=new j(i);g&&b._isFunction(g)?g(d,k):k.run()};f.addEventListener(d,i,!1),b._registerEventHandle(f,d,i)}}},b._registerEventHandle=function(a,c,d){var e=a._aniJSEventID,f=b.eventCollection,g={eventType:c,listener:d,element:a};if(e)f[e].handleCollection.push(g);else{var h={handleCollection:[g]};f[++b.eventIdCounter]=h,a._aniJSEventID=b.eventIdCounter}},b._purgeNode=function(a){var c,d=a._aniJSEventID;if(d){c=b.eventCollection[d].handleCollection;var e,f=c.length,g=0;for(g;f>g;g++)e=c[g],a.removeEventListener(e.eventType,e.listener);b.eventCollection[d]=null,a._aniJSEventID=null}},b._eventHelper=function(a){var c="",d=a.event||c;return"animationend"===d&&(d=b._animationEndPrefix()),d},b._eventTargetHelper=function(c,d){var e=c,f=[e],g=b.rootDOMTravelScope;if(d.eventTarget)if("document"===d.eventTarget)f=[document];else if("window"===d.eventTarget)f=[a];else try{f=g.querySelectorAll(d.eventTarget)}catch(h){f=[]}return f},b._behaviorTargetHelper=function(a,c){var d=a,f=[d],g=b.rootDOMTravelScope,h=c.behaviorTarget;if(h){h=h.split(e).join(",");try{f=g.querySelectorAll(h)}catch(i){f=[]}}return f},b._behaviorHelper=function(a){var b=a.behavior||"";return b},b._afterHelper=function(a,c){var d=b._callbackHelper(a,c,c.after);return d},b._beforeHelper=function(a,c){var d=b._callbackHelper(a,c,c.before);return d},b._callbackHelper=function(a,c,d){var e=d||"",f=b._helperHelper(c);if(e&&!b._isFunction(e)){var g=b.helperCollection,h=g[f];e=h&&h[e]?h[e]:!1}return e},b._helperHelper=function(a){var c=a.helper||b.helperDefaultIndex;return c},b._getParsedAniJSSentenceCollection=function(a){return b.Parser.parse(a)},b._findAniJSNodeCollection=function(a){var b="["+c+"]";return a.querySelectorAll(b)},b._animationEndPrefix=function(){var a=b._endPrefixBrowserDetectionIndex(),c=["animationend","oAnimationEnd","animationend","webkitAnimationEnd"];return c[a]},b._transitionEndPrefix=function(){var a=b._endPrefixBrowserDetectionIndex(),c=["transitionend","oTransitionEnd","transitionend","webkitTransitionEnd"];return c[a]},b._endPrefixBrowserDetectionIndex=function(){for(var a=document.createElement("fakeelement"),b=["animation","OAnimation","MozAnimation","webkitAnimation"],c=0;c<b.length;c++)if(void 0!==a.style[b[c]])return c},b._isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)};var j=function(a){var b=this;b.initializer=function(a){b.behaviorTargetList=a.behaviorTargetList||[],b.nodeHelper=a.nodeHelper,b.animationEndEvent=a.animationEndEvent,b.behavior=a.behavior,b.after=a.after},b.run=function(){var a,c=b.behaviorTargetList,d=c.length,e=b.nodeHelper,f=b.behavior,g=b.animationEndEvent,h=b.after,i=0;for(i;d>i;i++)a=c[i],e.addClass(a,f),a.addEventListener(g,function(a){a.target.removeEventListener(a.type,arguments.callee),h&&h(a,b)})},b.initializer(a)},k=function(){var a=this;a.parse=function(b){return a._parseDeclaration(b)},a._parseDeclaration=function(b){var c,d,e=[];c=b.split(";");var f=c.length,g=0;for(g;f>g;g++)d=a._parseSentence(c[g]),e.push(d);return e},a._parseSentence=function(b){var c,d,e={};c=b.split(",");var f=c.length,g=0;for(g;f>g;g++)d=a._parseDefinition(c[g]),e[d.key]=d.value;return e},a._parseDefinition=function(a){var b,c,d,e={},j="event",k="eventTarget",l="behavior",m="behaviorTarget";return b=a.split(":"),b.length>1&&(c=b[0].trim(),d=b[1].trim(),c===f?c=j:c===g?c=k:c===h?c=l:c===i&&(c=m),e.key=c,e.value=d),e}},l={addClass:function(a,b){b instanceof Array||(b=b.split(" "));for(var c=0,d=b.length;d>c;++c)b[c]&&!new RegExp("(\\s+|^)"+b[c]+"(\\s+|$)").test(a.className)&&(a.className=a.className.trim()+" "+b[c])},removeClass:function(a,b){b instanceof Array||(b=b.split(" "));for(var c=0,d=b.length;d>c;++c)a.className=a.className.replace(new RegExp("(\\s+|^)"+b[c]+"(\\s+|$)")," ").trim()},toggleClass:function(a,b){b&&(a.className=new RegExp("(\\s+|^)"+b+"(\\s+|$)").test(a.className)?a.className.replace(new RegExp("(\\s+|^)"+b+"(\\s+|$)")," ").trim():a.className.trim()+" "+b)},hasClass:function(a,b){return b&&new RegExp("(\\s+|^)"+b+"(\\s+|$)").test(a.className)}};b._initializer()},d=new c;return d.run(),"function"==typeof define&&define.amd&&define("anijs",[],function(){return d}),"undefined"==typeof b&&(a.AniJS=d),d});