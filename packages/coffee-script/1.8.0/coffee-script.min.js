(function(){var e,r,n,t,o,i,a,u,l,s,c,f,p,h,m,d,x,g,v={}.hasOwnProperty,y=[].indexOf||function(e){for(var r=0,n=this.length;n>r;r++)if(r in this&&this[r]===e)return r;return-1};if(i=require("fs"),p=require("vm"),c=require("path"),e=require("./lexer").Lexer,s=require("./parser").parser,u=require("./helpers"),r=require("./sourcemap"),exports.VERSION="1.8.0",exports.FILE_EXTENSIONS=[".coffee",".litcoffee",".coffee.md"],exports.helpers=u,h=function(e){return function(r,n){var t;null==n&&(n={});try{return e.call(this,r,n)}catch(o){throw t=o,u.updateSyntaxError(t,r,n.filename)}}},exports.compile=n=h(function(e,n){var t,o,i,a,c,f,p,h,m,d,x,g,v;for(d=u.merge,a=u.extend,n=a({},n),n.sourceMap&&(m=new r),f=s.parse(l.tokenize(e,n)).compileToFragments(n),i=0,n.header&&(i+=1),n.shiftLine&&(i+=1),o=0,h="",g=0,v=f.length;v>g;g++)c=f[g],n.sourceMap&&(c.locationData&&m.add([c.locationData.first_line,c.locationData.first_column],[i,o],{noReplace:!0}),x=u.count(c.code,"\n"),i+=x,x?o=c.code.length-(c.code.lastIndexOf("\n")+1):o+=c.code.length),h+=c.code;return n.header&&(p="Generated by CoffeeScript "+this.VERSION,h="// "+p+"\n"+h),n.sourceMap?(t={js:h},t.sourceMap=m,t.v3SourceMap=m.generate(n,e),t):h}),exports.tokens=h(function(e,r){return l.tokenize(e,r)}),exports.nodes=h(function(e,r){return s.parse("string"==typeof e?l.tokenize(e,r):e)}),exports.run=function(e,r){var t,o,a,l;return null==r&&(r={}),a=require.main,a.filename=process.argv[1]=r.filename?i.realpathSync(r.filename):".",a.moduleCache&&(a.moduleCache={}),o=r.filename?c.dirname(i.realpathSync(r.filename)):i.realpathSync("."),a.paths=require("module")._nodeModulePaths(o),(!u.isCoffee(a.filename)||require.extensions)&&(t=n(e,r),e=null!=(l=t.js)?l:t),a._compile(e,a.filename)},exports.eval=function(e,r){var t,o,i,a,u,l,s,f,h,m,d,x,g,y;if(null==r&&(r={}),e=e.trim()){if(o=p.Script){if(null!=r.sandbox){if(r.sandbox instanceof o.createContext().constructor)s=r.sandbox;else{s=o.createContext(),x=r.sandbox;for(a in x)v.call(x,a)&&(f=x[a],s[a]=f)}s.global=s.root=s.GLOBAL=s}else s=global;if(s.__filename=r.filename||"eval",s.__dirname=c.dirname(s.__filename),s===global&&!s.module&&!s.require){for(t=require("module"),s.module=d=new t(r.modulename||"eval"),s.require=y=function(e){return t._load(e,d,!0)},d.filename=s.__filename,g=Object.getOwnPropertyNames(require),h=0,m=g.length;m>h;h++)l=g[h],"paths"!==l&&(y[l]=require[l]);y.paths=d.paths=t._nodeModulePaths(process.cwd()),y.resolve=function(e){return t._resolveFilename(e,d)}}}u={};for(a in r)v.call(r,a)&&(f=r[a],u[a]=f);return u.bare=!0,i=n(e,u),s===global?p.runInThisContext(i):p.runInContext(i,s)}},exports.register=function(){return require("./register")},require.extensions)for(g=this.FILE_EXTENSIONS,d=0,x=g.length;x>d;d++)t=g[d],null==(m=require.extensions)[t]&&(m[t]=function(){throw new Error("Use CoffeeScript.register() or require the coffee-script/register module to require "+t+" files.")});exports._compileFile=function(e,r){var t,o,a,l;null==r&&(r=!1),a=i.readFileSync(e,"utf8"),l=65279===a.charCodeAt(0)?a.substring(1):a;try{t=n(l,{filename:e,sourceMap:r,literate:u.isLiterate(e)})}catch(s){throw o=s,u.updateSyntaxError(o,l,e)}return t},l=new e,s.lexer={lex:function(){var e,r;return r=this.tokens[this.pos++],r?(e=r[0],this.yytext=r[1],this.yylloc=r[2],this.errorToken=r.origin||r,this.yylineno=this.yylloc.first_line):e="",e},setInput:function(e){return this.tokens=e,this.pos=0},upcomingInput:function(){return""}},s.yy=require("./nodes"),s.yy.parseError=function(e,r){var n,t,o,i,a,l,c;return a=r.token,c=s.lexer,i=c.errorToken,l=c.tokens,t=i[0],o=i[1],n=i[2],o=i===l[l.length-1]?"end of input":"INDENT"===t||"OUTDENT"===t?"indentation":u.nameWhitespaceCharacter(o),u.throwSyntaxError("unexpected "+o,n)},o=function(e,r){var n,t,o,i,a,u,l,s,c,f,p,h;return i=void 0,o="",e.isNative()?o="native":(e.isEval()?(i=e.getScriptNameOrSourceURL(),i||(o=""+e.getEvalOrigin()+", ")):i=e.getFileName(),i||(i="<anonymous>"),s=e.getLineNumber(),t=e.getColumnNumber(),f=r(i,s,t),o=f?""+i+":"+f[0]+":"+f[1]:""+i+":"+s+":"+t),a=e.getFunctionName(),u=e.isConstructor(),l=!(e.isToplevel()||u),l?(c=e.getMethodName(),h=e.getTypeName(),a?(p=n="",h&&a.indexOf(h)&&(p=""+h+"."),c&&a.indexOf("."+c)!==a.length-c.length-1&&(n=" [as "+c+"]"),""+p+a+n+" ("+o+")"):""+h+"."+(c||"<anonymous>")+" ("+o+")"):u?"new "+(a||"<anonymous>")+" ("+o+")":a?""+a+" ("+o+")":o},f={},a=function(e){var r,n;if(f[e])return f[e];if(n=null!=c?c.extname(e):void 0,!(y.call(exports.FILE_EXTENSIONS,n)<0))return r=exports._compileFile(e,!0),f[e]=r.sourceMap},Error.prepareStackTrace=function(e,r){var n,t,i;return i=function(e,r,n){var t,o;return o=a(e),o&&(t=o.sourceLocation([r-1,n-1])),t?[t[0]+1,t[1]+1]:null},t=function(){var e,t,a;for(a=[],e=0,t=r.length;t>e&&(n=r[e],n.getFunction()!==exports.run);e++)a.push("  at "+o(n,i));return a}(),""+e.toString()+"\n"+t.join("\n")+"\n"}}).call(this);