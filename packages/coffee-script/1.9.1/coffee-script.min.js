(function(){var e,r,n,t,o,i,a,u,l,s,c,f,p,h,m,d,x,g,v={}.hasOwnProperty,y=[].indexOf||function(e){for(var r=0,n=this.length;n>r;r++)if(r in this&&this[r]===e)return r;return-1};if(a=require("fs"),x=require("vm"),h=require("path"),e=require("./lexer").Lexer,p=require("./parser").parser,l=require("./helpers"),r=require("./sourcemap"),exports.VERSION="1.9.1",exports.FILE_EXTENSIONS=[".coffee",".litcoffee",".coffee.md"],exports.helpers=l,g=function(e){return function(r,n){var t;null==n&&(n={});try{return e.call(this,r,n)}catch(o){throw t=o,l.updateSyntaxError(t,r,n.filename)}}},exports.compile=t=g(function(e,n){var t,o,i,a,u,s,c,h,m,d,x,g,v,y,E;for(g=l.merge,a=l.extend,n=a({},n),n.sourceMap&&(x=new r),E=f.tokenize(e,n),n.referencedVars=function(){var e,r,n;for(n=[],e=0,r=E.length;r>e;e++)y=E[e],y.variable&&n.push(y[1]);return n}(),s=p.parse(E).compileToFragments(n),i=0,n.header&&(i+=1),n.shiftLine&&(i+=1),o=0,m="",h=0,d=s.length;d>h;h++)u=s[h],n.sourceMap&&(u.locationData&&x.add([u.locationData.first_line,u.locationData.first_column],[i,o],{noReplace:!0}),v=l.count(u.code,"\n"),i+=v,v?o=u.code.length-(u.code.lastIndexOf("\n")+1):o+=u.code.length),m+=u.code;return n.header&&(c="Generated by CoffeeScript "+this.VERSION,m="// "+c+"\n"+m),n.sourceMap?(t={js:m},t.sourceMap=x,t.v3SourceMap=x.generate(n,e),t):m}),exports.tokens=g(function(e,r){return f.tokenize(e,r)}),exports.nodes=g(function(e,r){return p.parse("string"==typeof e?f.tokenize(e,r):e)}),exports.run=function(e,r){var n,o,i,u;return null==r&&(r={}),i=require.main,i.filename=process.argv[1]=r.filename?a.realpathSync(r.filename):".",i.moduleCache&&(i.moduleCache={}),o=r.filename?h.dirname(a.realpathSync(r.filename)):a.realpathSync("."),i.paths=require("module")._nodeModulePaths(o),(!l.isCoffee(i.filename)||require.extensions)&&(n=t(e,r),e=null!=(u=n.js)?u:n),i._compile(e,i.filename)},exports.eval=function(e,r){var n,o,i,a,u,l,s,c,f,p,m,d,g,y,E,S,N;if(null==r&&(r={}),e=e.trim()){if(a=null!=(d=x.Script.createContext)?d:x.createContext,l=null!=(g=x.isContext)?g:function(){return r.sandbox instanceof a().constructor},a){if(null!=r.sandbox){if(l(r.sandbox))S=r.sandbox;else{S=a(),y=r.sandbox;for(c in y)v.call(y,c)&&(N=y[c],S[c]=N)}S.global=S.root=S.GLOBAL=S}else S=global;if(S.__filename=r.filename||"eval",S.__dirname=h.dirname(S.__filename),S===global&&!S.module&&!S.require){for(n=require("module"),S.module=o=new n(r.modulename||"eval"),S.require=i=function(e){return n._load(e,o,!0)},o.filename=S.__filename,E=Object.getOwnPropertyNames(require),u=0,f=E.length;f>u;u++)m=E[u],"paths"!==m&&(i[m]=require[m]);i.paths=o.paths=n._nodeModulePaths(process.cwd()),i.resolve=function(e){return n._resolveFilename(e,o)}}}p={};for(c in r)v.call(r,c)&&(N=r[c],p[c]=N);return p.bare=!0,s=t(e,p),S===global?x.runInThisContext(s):x.runInContext(s,S)}},exports.register=function(){return require("./register")},require.extensions)for(m=this.FILE_EXTENSIONS,s=0,c=m.length;c>s;s++)o=m[s],null==(n=require.extensions)[o]&&(n[o]=function(){throw new Error("Use CoffeeScript.register() or require the coffee-script/register module to require "+o+" files.")});exports._compileFile=function(e,r){var n,o,i,u;null==r&&(r=!1),i=a.readFileSync(e,"utf8"),u=65279===i.charCodeAt(0)?i.substring(1):i;try{n=t(u,{filename:e,sourceMap:r,literate:l.isLiterate(e)})}catch(s){throw o=s,l.updateSyntaxError(o,u,e)}return n},f=new e,p.lexer={lex:function(){var e,r;return r=p.tokens[this.pos++],r?(e=r[0],this.yytext=r[1],this.yylloc=r[2],p.errorToken=r.origin||r,this.yylineno=this.yylloc.first_line):e="",e},setInput:function(e){return p.tokens=e,this.pos=0},upcomingInput:function(){return""}},p.yy=require("./nodes"),p.yy.parseError=function(e,r){var n,t,o,i,a,u;return a=r.token,i=p.errorToken,u=p.tokens,t=i[0],o=i[1],n=i[2],o=function(){switch(!1){case i!==u[u.length-1]:return"end of input";case"INDENT"!==t&&"OUTDENT"!==t:return"indentation";case"IDENTIFIER"!==t&&"NUMBER"!==t&&"STRING"!==t&&"STRING_START"!==t&&"REGEX"!==t&&"REGEX_START"!==t:return t.replace(/_START$/,"").toLowerCase();default:return l.nameWhitespaceCharacter(o)}}(),l.throwSyntaxError("unexpected "+o,n)},i=function(e,r){var n,t,o,i,a,u,l,s,c,f,p,h;return i=void 0,o="",e.isNative()?o="native":(e.isEval()?(i=e.getScriptNameOrSourceURL(),i||(o=e.getEvalOrigin()+", ")):i=e.getFileName(),i||(i="<anonymous>"),s=e.getLineNumber(),t=e.getColumnNumber(),f=r(i,s,t),o=f?i+":"+f[0]+":"+f[1]:i+":"+s+":"+t),a=e.getFunctionName(),u=e.isConstructor(),l=!(e.isToplevel()||u),l?(c=e.getMethodName(),h=e.getTypeName(),a?(p=n="",h&&a.indexOf(h)&&(p=h+"."),c&&a.indexOf("."+c)!==a.length-c.length-1&&(n=" [as "+c+"]"),""+p+a+n+" ("+o+")"):h+"."+(c||"<anonymous>")+" ("+o+")"):u?"new "+(a||"<anonymous>")+" ("+o+")":a?a+" ("+o+")":o},d={},u=function(e){var r,n;if(d[e])return d[e];if(n=null!=h?h.extname(e):void 0,!(y.call(exports.FILE_EXTENSIONS,n)<0))return r=exports._compileFile(e,!0),d[e]=r.sourceMap},Error.prepareStackTrace=function(e,r){var n,t,o;return o=function(e,r,n){var t,o;return o=u(e),o&&(t=o.sourceLocation([r-1,n-1])),t?[t[0]+1,t[1]+1]:null},t=function(){var e,t,a;for(a=[],e=0,t=r.length;t>e&&(n=r[e],n.getFunction()!==exports.run);e++)a.push("  at "+i(n,o));return a}(),e.toString()+"\n"+t.join("\n")+"\n"}}).call(this);