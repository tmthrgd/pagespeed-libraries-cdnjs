(function(){function f(p){for(var p=p.toUpperCase(),t=e.length,o=0,q=0;q<t;++q){for(var s=e[q],r=s[1].length;p.substr(0,r)==s[1];p=p.substr(r)){o+=s[0]}}return o}function c(p){for(var p=p.toUpperCase(),r=b.length,o=1,q=1;0<p.length;q*=r){o+=b.indexOf(p.charAt(p.length-1))*q,p=p.substr(0,p.length-1)}return o}var a=CKEDITOR.htmlParser.fragment.prototype,d=CKEDITOR.htmlParser.element.prototype;a.onlyChild=d.onlyChild=function(){var o=this.children;return 1==o.length&&o[0]||null};d.removeAnyChildWithName=function(p){for(var s=this.children,o=[],q,r=0;r<s.length;r++){q=s[r],q.name&&(q.name==p&&(o.push(q),s.splice(r--,1)),o=o.concat(q.removeAnyChildWithName(p)))}return o};d.getAncestor=function(o){for(var p=this.parent;p&&(!p.name||!p.name.match(o));){p=p.parent}return p};a.firstChild=d.firstChild=function(p){for(var q,o=0;o<this.children.length;o++){if(q=this.children[o],p(q)||q.name&&(q=q.firstChild(p))){return q}}return null};d.addStyle=function(p,s,o){var q="";if("string"==typeof s){q+=p+":"+s+";"}else{if("object"==typeof p){for(var r in p){p.hasOwnProperty(r)&&(q+=r+":"+p[r]+";")}}else{q+=p}o=s}this.attributes||(this.attributes={});p=this.attributes.style||"";p=(o?[q,p]:[p,q]).join(";");this.attributes.style=p.replace(/^;|;(?=;)/,"")};d.getStyle=function(o){var p=this.attributes.style;if(p){return p=CKEDITOR.tools.parseCssText(p,1),p[o]}};CKEDITOR.dtd.parentOf=function(p){var q={},o;for(o in this){-1==o.indexOf("$")&&this[o][p]&&(q[o]=1)}return q};var i=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i,n=/^(?:\b0[^\s]*\s*){1,4}$/,g={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},e=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",m=0,k=null,h,l=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(p,q){var o=new CKEDITOR.htmlParser.element("cke:listbullet");o.attributes={"cke:listsymbol":p[0]};o.add(new CKEDITOR.htmlParser.text(q));return o},isListBulletIndicator:function(o){if(/mso-list\s*:\s*Ignore/i.test(o.attributes&&o.attributes.style)){return !0}},isContainingOnlySpaces:function(o){var p;return(p=o.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(p.value)},resolveList:function(p){var q=p.attributes,o;if((o=p.removeAnyChildWithName("cke:listbullet"))&&o.length&&(o=o[0])){return p.name="cke:li",q.style&&(q.style=l.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(r){r=r.split(" ");r=CKEDITOR.tools.convertToPx(r[3]||r[1]||r[0]);!m&&(null!==k&&r>k)&&(m=r-k);k=r;q["cke:indent"]=m&&Math.ceil(r/m)+1||1}],[/^mso-list$/,null,function(s){var s=s.split(" "),r=Number(s[0].match(/\d+/)),s=Number(s[1].match(/\d+/));1==s&&(r!==h&&(q["cke:reset"]=1),h=r);q["cke:indent"]=s}]])(q.style,p)||""),q["cke:indent"]||(k=0,q["cke:indent"]=1),CKEDITOR.tools.extend(q,o.attributes),!0}h=k=m=null;return !1},getStyleComponents:function(){var o=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(o);return function(s,p,q){o.setStyle(s,p);for(var s={},p=q.length,r=0;r<p;r++){s[q[r]]=o.getStyle(q[r])}return s}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(x,v){var v="number"==typeof v?v:1,w=x.attributes,s;switch(w.type){case"a":s="lower-alpha";break;case"1":s="decimal"}for(var u=x.children,t,q=0;q<u.length;q++){if(t=u[q],t.name in CKEDITOR.dtd.$listItem){var p=t.attributes,r=t.children,o=r[r.length-1];o.name in CKEDITOR.dtd.$list&&(x.add(o,q+1),--r.length||u.splice(q--,1));t.name="cke:li";w.start&&!q&&(p.value=w.start);l.filters.stylesFilter([["tab-stops",null,function(y){(y=y.split(" ")[1].match(i))&&(k=CKEDITOR.tools.convertToPx(y[0]))}],1==v?["mso-list",null,function(y){y=y.split(" ");y=Number(y[0].match(/\d+/));y!==h&&(p["cke:reset"]=1);h=y}]:null])(p.style);p["cke:indent"]=v;p["cke:listtype"]=x.name;p["cke:list-style-type"]=s}else{if(t.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[t,v+1]);u=u.slice(0,q).concat(t.children).concat(u.slice(q+1));x.children=[];t=0;for(r=u.length;t<r;t++){x.add(u[t])}}}}delete x.name;w["cke:list"]=1},assembleList:function(J){for(var H=J.children,I,E,G,F,C,A,J=[],D,x,B,y,z,u,w=0;w<H.length;w++){if(I=H[w],"cke:li"==I.name){if(I.name="li",E=I.attributes,B=(B=E["cke:listsymbol"])&&B.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),y=z=u=null,E["cke:ignored"]){H.splice(w--,1)}else{E["cke:reset"]&&(A=F=C=null);G=Number(E["cke:indent"]);G!=F&&(x=D=null);if(B){if(x&&g[x][D].test(B[1])){y=x,z=D}else{for(var t in g){for(var o in g[t]){if(g[t][o].test(B[1])){if("ol"==t&&/alpha|roman/.test(o)){if(D=/roman/.test(o)?f(B[1]):c(B[1]),!u||D<u){u=D,y=t,z=o}}else{y=t;z=o;break}}}}}!y&&(y=B[2]?"ol":"ul")}else{y=E["cke:listtype"]||"ol",z=E["cke:list-style-type"]}x=y;D=z||("ol"==y?"decimal":"disc");z&&z!=("ol"==y?"decimal":"disc")&&I.addStyle("list-style-type",z);if("ol"==y&&B){switch(z){case"decimal":u=Number(B[1]);break;case"lower-roman":case"upper-roman":u=f(B[1]);break;case"lower-alpha":case"upper-alpha":u=c(B[1])}I.attributes.value=u}if(A){if(G>F){J.push(A=new CKEDITOR.htmlParser.element(y)),A.add(I),C.add(A)}else{if(G<F){F-=G;for(var q;F--&&(q=A.parent);){A=q.parent}}A.add(I)}H.splice(w--,1)}else{J.push(A=new CKEDITOR.htmlParser.element(y)),A.add(I),H[w]=A}C=I;F=G}}else{A&&(A=F=C=null)}}for(w=0;w<J.length;w++){if(A=J[w],t=A.children,D=D=void 0,o=A.children.length,q=D=void 0,H=/list-style-type:(.*?)(?:;|$)/,F=CKEDITOR.plugins.pastefromword.filters.stylesFilter,D=A.attributes,!H.exec(D.style)){for(C=0;C<o;C++){if(D=t[C],D.attributes.value&&Number(D.attributes.value)==C+1&&delete D.attributes.value,D=H.exec(D.attributes.style)){if(D[1]==q||!q){q=D[1]}else{q=null;break}}}if(q){for(C=0;C<o;C++){D=t[C].attributes,D.style&&(D.style=F([["list-style-type"]])(D.style)||"")}A.addStyle("list-style-type",q)}}}h=k=m=null},falsyFilter:function(){return !1},stylesFilter:function(o,p){return function(q,r){var t=[];(q||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(v,A,z){A=A.toLowerCase();"font-family"==A&&(z=z.replace(/["']/g,""));for(var u,y,w,x=0;x<o.length;x++){if(o[x]&&(v=o[x][0],u=o[x][1],y=o[x][2],w=o[x][3],A.match(v)&&(!u||z.match(u)))){A=w||A;p&&(y=y||z);"function"==typeof y&&(y=y(z,r,A));y&&y.push&&(A=y[0],y=y[1]);"string"==typeof y&&t.push([A,y]);return}}!p&&t.push([A,z])});for(var s=0;s<t.length;s++){t[s]=t[s].join(":")}return t.length?t.join(";")+";":!1}},elementMigrateFilter:function(o,p){return o?function(q){var r=p?(new CKEDITOR.style(o,p))._.definition:o;q.name=r.element;CKEDITOR.tools.extend(q.attributes,CKEDITOR.tools.clone(r.attributes));q.addStyle(CKEDITOR.style.getStyleText(r))}:function(){}},styleMigrateFilter:function(p,q){var o=this.elementMigrateFilter;return p?function(s,u){var t=new CKEDITOR.htmlParser.element(null),r={};r[q]=s;o(p,r)(t);t.children=u.children;u.children=[t];t.filter=function(){};t.parent=u}:function(){}},bogusAttrFilter:function(o,p){if(-1==p.name.indexOf("cke:")){return !1}},applyStyleFilter:null},getRules:function(P,N){var O=CKEDITOR.dtd,K=CKEDITOR.tools.extend({},O.$block,O.$listItem,O.$tableContent),M=P.config,L=this.filters,I=L.falsyFilter,G=L.stylesFilter,J=L.elementMigrateFilter,D=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),H=this.utils.createListBulletMarker,E=L.flattenList,F=L.assembleList,A=this.utils.isListBulletIndicator,C=this.utils.isContainingOnlySpaces,z=this.utils.resolveList,q=function(o){o=CKEDITOR.tools.convertToPx(o);return isNaN(o)?o:o+"px"},y=this.utils.getStyleComponents,w=this.utils.listDtdParents,B=!1!==M.pasteFromWordRemoveFontStyles,x=!1!==M.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(o){o.filterChildren(N);F(o)},elements:{"^":function(o){var p;CKEDITOR.env.gecko&&(p=L.applyStyleFilter)&&p(o)},$:function(p){var o=p.name||"",r=p.attributes;o in K&&r.style&&(r.style=G([[/^(:?width|height)$/,null,q]])(r.style)||"");if(o.match(/h\d/)){p.filterChildren(N);if(z(p)){return}J(M["format_"+o])(p)}else{if(o in O.$inline){p.filterChildren(N),C(p)&&delete p.name}else{if(-1!=o.indexOf(":")&&-1==o.indexOf("cke")){p.filterChildren(N);if("v:imagedata"==o){if(o=p.attributes["o:href"]){p.attributes.src=o}p.name="img";return}delete p.name}}}o in w&&(p.filterChildren(N),F(p))},style:function(o){if(CKEDITOR.env.gecko){var o=(o=o.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&o[1],p={};o&&(o.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(s,r,u){for(var r=r.split(","),s=r.length,t=0;t<s;t++){CKEDITOR.tools.trim(r[t]).replace(/^(\w+)(\.[\w-]+)?$/g,function(Q,v,R){v=v||"*";R=R.substring(1,R.length);R.match(/MsoNormal/)||(p[v]||(p[v]={}),R?p[v][R]=u:p[v]=u)})}}),L.applyStyleFilter=function(s){var r=p["*"]?"*":s.name,t=s.attributes&&s.attributes["class"];r in p&&(r=p[r],"object"==typeof r&&(r=r[t]),r&&s.addStyle(r,!0))})}return !1},p:function(p){if(/MsoListParagraph/i.exec(p.attributes["class"])||p.getStyle("mso-list")){var o=p.firstChild(function(r){return r.type==CKEDITOR.NODE_TEXT&&!C(r.parent)});(o=o&&o.parent)&&o.addStyle("mso-list","Ignore")}p.filterChildren(N);z(p)||(M.enterMode==CKEDITOR.ENTER_BR?(delete p.name,p.add(new CKEDITOR.htmlParser.element("br"))):J(M["format_"+(M.enterMode==CKEDITOR.ENTER_P?"p":"div")])(p))},div:function(p){var r=p.onlyChild();if(r&&"table"==r.name){var o=p.attributes;r.attributes=CKEDITOR.tools.extend(r.attributes,o);o.style&&r.addStyle(o.style);r=new CKEDITOR.htmlParser.element("div");r.addStyle("clear","both");p.add(r);delete p.name}},td:function(o){o.getAncestor("thead")&&(o.name="th")},ol:E,ul:E,dl:E,font:function(p){if(A(p.parent)){delete p.name}else{p.filterChildren(N);var o=p.attributes,s=o.style,r=p.parent;"font"==r.name?(CKEDITOR.tools.extend(r.attributes,p.attributes),s&&r.addStyle(s),delete p.name):(s=s||"",o.color&&("#000000"!=o.color&&(s+="color:"+o.color+";"),delete o.color),o.face&&(s+="font-family:"+o.face+";",delete o.face),o.size&&(s+="font-size:"+(3<o.size?"large":3>o.size?"small":"medium")+";",delete o.size),p.name="span",p.addStyle(s))}},span:function(p){if(A(p.parent)){return !1}p.filterChildren(N);if(C(p)){return delete p.name,null}if(A(p)){var o=p.firstChild(function(s){return s.value||"img"==s.name}),r=(o=o&&(o.value||"l."))&&o.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(r){return o=H(r,o),(p=p.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(p.attributes.style)&&(o.attributes["cke:ignored"]=1),o}}if(r=(o=p.attributes)&&o.style){o.style=G([["line-height"],[/^font-family$/,null,!B?D(M.font_style,"family"):null],[/^font-size$/,null,!B?D(M.fontSize_style,"size"):null],[/^color$/,null,!B?D(M.colorButton_foreStyle,"color"):null],[/^background-color$/,null,!B?D(M.colorButton_backStyle,"color"):null]])(r,p)||""}o.style||delete o.style;CKEDITOR.tools.isEmpty(o)&&delete p.name;return null},b:J(M.coreStyles_bold),i:J(M.coreStyles_italic),u:J(M.coreStyles_underline),s:J(M.coreStyles_strike),sup:J(M.coreStyles_superscript),sub:J(M.coreStyles_subscript),a:function(p){var o=p.attributes;o&&!o.href&&o.name?delete p.name:CKEDITOR.env.webkit&&(o.href&&o.href.match(/file:\/\/\/[\S]+#/i))&&(o.href=o.href.replace(/file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(o){o.getAncestor(/h\d/)&&!M.pasteFromWordNumberedHeadingToList&&delete o.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:G(x?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(p,o,r){if(o.name in {p:1,div:1}){o="ltr"==M.contentsLangDirection?"margin-left":"margin-right";if("margin"==r){p=y(r,p,[o])[o]}else{if(r!=o){return null}}if(p&&!n.test(p)){return[o,p]}}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(p,o){if("img"==o.name){return p}}],[/^width|height$/,null,function(p,o){if(o.name in {table:1,td:1,th:1,img:1}){return p}}]]:[[/^mso-/],[/-color$/,null,function(o){if("transparent"==o){return !1}if(CKEDITOR.env.gecko){return o.replace(/-moz-use-text-color/g,"transparent")}}],[/^margin$/,n],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],B?[/font-?/]:null],x),width:function(o,p){if(p.name in O.$tableContent){return !1}},border:function(o,p){if(p.name in O.$tableContent){return !1}},"class":I,bgcolor:I,valign:x?I:function(p,o){o.addStyle("vertical-align",p);return !1}},comment:!CKEDITOR.env.ie?function(p,o){var s=p.match(/<img.*?>/),r=p.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return r?(r=(s=r[1]||s&&"l.")&&s.match(/>(?:[(]?)([^\s]+?)([.)]?)</),H(r,s)):CKEDITOR.env.gecko&&s?(s=CKEDITOR.htmlParser.fragment.fromHtml(s[0]).children[0],(r=(r=(r=o.previous)&&r.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&r[1])&&(s.attributes.src=r),s):!1}:I}}},j=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};j.prototype={toHtml:function(o){var o=CKEDITOR.htmlParser.fragment.fromHtml(o),p=new CKEDITOR.htmlParser.basicWriter;o.writeHtml(p,this.dataFilter);return p.getHtml(!0)}};CKEDITOR.cleanWord=function(p,s){CKEDITOR.env.gecko&&(p=p.replace(/(<\!--\[if[^<]*?\])--\>([\S\s]*?)<\!--(\[endif\]--\>)/gi,"$1$2$3"));CKEDITOR.env.webkit&&(p=p.replace(/(class="MsoListParagraph[^>]+><\!--\[if !supportLists\]--\>)([^<]+<span[^<]+<\/span>)(<\!--\[endif\]--\>)/gi,"$1<span>$2</span>$3"));var o=new j,q=o.dataFilter;q.addRules(CKEDITOR.plugins.pastefromword.getRules(s,q));s.fire("beforeCleanWord",{filter:q});try{p=o.toHtml(p)}catch(r){alert(s.lang.pastefromword.error)}p=p.replace(/cke:.*?".*?"/g,"");p=p.replace(/style=""/g,"");return p=p.replace(/<span>/g,"")}})();