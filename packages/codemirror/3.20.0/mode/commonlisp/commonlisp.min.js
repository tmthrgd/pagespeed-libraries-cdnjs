CodeMirror.defineMode("commonlisp",function(e){function s(e){var t;while(t=e.next())if(t=="\\")e.next();else if(!r.test(t)){e.backUp(1);break}return e.current()}function o(e,t){if(e.eatSpace())return i="ws",null;if(e.match(n))return"number";var r=e.next();r=="\\"&&(r=e.next());if(r=='"')return(t.tokenize=u)(e,t);if(r=="(")return i="open","bracket";if(r==")"||r=="]")return i="close","bracket";if(r==";")return e.skipToEnd(),i="ws","comment";if(/['`,@]/.test(r))return null;if(r=="|")return e.skipTo("|")?(e.next(),"symbol"):(e.skipToEnd(),"error");if(r=="#"){var r=e.next();return r=="["?(i="open","bracket"):/[+\-=\.']/.test(r)?null:/\d/.test(r)&&e.match(/^\d*#/)?null:r=="|"?(t.tokenize=a)(e,t):r==":"?(s(e),"meta"):"error"}var o=s(e);return o=="."?null:(i="symbol",o=="nil"||o=="t"?"atom":o.charAt(0)==":"?"keyword":o.charAt(0)=="&"?"variable-2":"variable")}function u(e,t){var n=!1,r;while(r=e.next()){if(r=='"'&&!n){t.tokenize=o;break}n=!n&&r=="\\"}return"string"}function a(e,t){var n,r;while(n=e.next()){if(n=="#"&&r=="|"){t.tokenize=o;break}r=n}return i="ws","comment"}var t=/^with|^def|^do|^prog|case$|^cond$|bind$|when$|unless$/,n=/^(?:[+\-]?(?:\d+|\d*\.\d+)(?:[efd][+\-]?\d+)?|[+\-]?\d+(?:\/[+\-]?\d+)?|#b[+\-]?[01]+|#o[+\-]?[0-7]+|#x[+\-]?[\da-f]+)/,r=/[^\s'`,@()\[\]";]/,i;return{startState:function(){return{ctx:{prev:null,start:0,indentTo:0},tokenize:o}},token:function(n,r){n.sol()&&typeof r.ctx.indentTo!="number"&&(r.ctx.indentTo=r.ctx.start+1),i=null;var s=r.tokenize(n,r);return i!="ws"&&(r.ctx.indentTo==null?i=="symbol"&&t.test(n.current())?r.ctx.indentTo=r.ctx.start+e.indentUnit:r.ctx.indentTo="next":r.ctx.indentTo=="next"&&(r.ctx.indentTo=n.column())),i=="open"?r.ctx={prev:r.ctx,start:n.column(),indentTo:null}:i=="close"&&(r.ctx=r.ctx.prev||r.ctx),s},indent:function(e,t){var n=e.ctx.indentTo;return typeof n=="number"?n:e.ctx.start+1},lineComment:";;",blockCommentStart:"#|",blockCommentEnd:"|#"}}),CodeMirror.defineMIME("text/x-common-lisp","commonlisp");