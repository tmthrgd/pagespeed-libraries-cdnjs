(function(){"use strict";function e(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function t(t){t.state.failedTagMatch=!1,t.operation(function(){e(t);if(t.somethingSelected())return;var n=t.getCursor(),r=t.getViewport();r.from=Math.min(r.from,n.line),r.to=Math.max(n.line+1,r.to);var i=CodeMirror.findMatchingTag(t,n,r);if(!i)return;if(t.state.matchBothTags){var s=i.at=="open"?i.open:i.close;s&&(t.state.tagHit=t.markText(s.from,s.to,{className:"CodeMirror-matchingtag"}))}var o=i.at=="close"?i.open:i.close;o?t.state.tagOther=t.markText(o.from,o.to,{className:"CodeMirror-matchingtag"}):t.state.failedTagMatch=!0})}function n(e){e.state.failedTagMatch&&t(e)}CodeMirror.defineOption("matchTags",!1,function(r,i,s){s&&s!=CodeMirror.Init&&(r.off("cursorActivity",t),r.off("viewportChange",n),e(r)),i&&(r.state.matchBothTags=typeof i=="object"&&i.bothTags,r.on("cursorActivity",t),r.on("viewportChange",n),t(r))}),CodeMirror.commands.toMatchingTag=function(e){var t=CodeMirror.findMatchingTag(e,e.getCursor());if(t){var n=t.at=="close"?t.open:t.close;n&&e.setSelection(n.to,n.from)}}})();