(function(){"use strict";function r(e){var t=e.doc.modeOption;return t==="sql"&&(t="text/x-sql"),CodeMirror.resolveMode(t).keywords}function i(e,t){var n=e.length,r=t.substr(0,n);return e.toUpperCase()===r.toUpperCase()}function s(e,t,n,r){for(var s in n){if(!n.hasOwnProperty(s))continue;Array.isArray(n)&&(s=n[s]),i(t,s)&&e.push(r(s))}}function o(t,n){var r=n.getCursor(),i=n.getTokenAt(r),o=i.string.substr(1),u=CodeMirror.Pos(r.line,i.start),a=n.getTokenAt(u).string;e.hasOwnProperty(a)||(a=l(a,n));var f=e[a];if(!f)return;s(t,o,f,function(e){return"."+e})}function u(e,t){if(!e)return;var n=/[,;]/g,r=e.split(" ");for(var i=0;i<r.length;i++)t(r[i]?r[i].replace(n,""):"")}function a(e){return e.line+e.ch/Math.pow(10,6)}function f(e){return CodeMirror.Pos(Math.floor(e),+e.toString().split(".").pop())}function l(t,r){var i=r.doc,s=i.getValue(),o=t.toUpperCase(),l="",c="",h=[],p={start:CodeMirror.Pos(0,0),end:CodeMirror.Pos(r.lastLine(),r.getLineHandle(r.lastLine()).length)},d=s.indexOf(n.QUERY_DIV);while(d!=-1)h.push(i.posFromIndex(d)),d=s.indexOf(n.QUERY_DIV,d+1);h.unshift(CodeMirror.Pos(0,0)),h.push(CodeMirror.Pos(r.lastLine(),r.getLineHandle(r.lastLine()).text.length));var v=0,m=a(r.getCursor());for(var g=0;g<h.length;g++){var y=a(h[g]);if(m>v&&m<=y){p={start:f(v),end:f(y)};break}v=y}var b=i.getRange(p.start,p.end,!1);for(var g=0;g<b.length;g++){var w=b[g];u(w,function(t){var r=t.toUpperCase();r===o&&e.hasOwnProperty(l)&&(c=l),r!==n.ALIAS_KEYWORD&&(l=t)});if(c)break}return c}function c(n,i){e=i&&i.tables||{},t=t||r(n);var u=n.getCursor(),a=n.getTokenAt(u),f=[],l=a.string.trim();return s(f,l,t,function(e){return e.toUpperCase()}),s(f,l,e,function(e){return e}),l.lastIndexOf(".")===0&&o(f,n),{list:f,from:CodeMirror.Pos(u.line,a.start),to:CodeMirror.Pos(u.line,a.end)}}var e,t,n={QUERY_DIV:";",ALIAS_KEYWORD:"AS"};CodeMirror.registerHelper("hint","sql",c)})();