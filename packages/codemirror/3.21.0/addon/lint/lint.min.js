(function(){"use strict";function n(e,t){function r(e){if(!n.parentNode)return CodeMirror.off(document,"mousemove",r);n.style.top=Math.max(0,e.clientY-n.offsetHeight-5)+"px",n.style.left=e.clientX+5+"px"}var n=document.createElement("div");return n.className="CodeMirror-lint-tooltip",n.appendChild(t.cloneNode(!0)),document.body.appendChild(n),CodeMirror.on(document,"mousemove",r),r(e),n.style.opacity!=null&&(n.style.opacity=1),n}function r(e){e.parentNode&&e.parentNode.removeChild(e)}function i(e){if(!e.parentNode)return;e.style.opacity==null&&r(e),e.style.opacity=0,setTimeout(function(){r(e)},600)}function s(e,t,r){function o(){CodeMirror.off(r,"mouseout",o),s&&(i(s),s=null)}var s=n(e,t),u=setInterval(function(){if(s)for(var e=r;;e=e.parentNode){if(e==document.body)return;if(!e){o();break}}if(!s)return clearInterval(u)},400);CodeMirror.on(r,"mouseout",o)}function o(e,t,n){this.marked=[],this.options=t,this.timeout=null,this.hasGutter=n,this.onMouseOver=function(t){y(e,t)}}function u(e,t){if(t instanceof Function)return{getAnnotations:t};if(!t||t===!0)t={};t.getAnnotations||(t.getAnnotations=e.getHelper(CodeMirror.Pos(0,0),"lint"));if(!t.getAnnotations)throw new Error("Required option 'getAnnotations' missing (lint addon)");return t}function a(t){var n=t.state.lint;n.hasGutter&&t.clearGutter(e);for(var r=0;r<n.marked.length;++r)n.marked[r].clear();n.marked.length=0}function f(e,t,n,r){var i=document.createElement("div"),o=i;return i.className="CodeMirror-lint-marker-"+t,n&&(o=i.appendChild(document.createElement("div")),o.className="CodeMirror-lint-marker-multiple"),r!=0&&CodeMirror.on(o,"mouseover",function(t){s(t,e,o)}),i}function l(e,t){return e=="error"?e:t}function c(e){var t=[];for(var n=0;n<e.length;++n){var r=e[n],i=r.from.line;(t[i]||(t[i]=[])).push(r)}return t}function h(e){var n=e.severity;t.test(n)||(n="error");var r=document.createElement("div");return r.className="CodeMirror-lint-message-"+n,r.appendChild(document.createTextNode(e.message)),r}function p(e){var t=e.state.lint,n=t.options;n.async?n.getAnnotations(e,d,n):d(e,n.getAnnotations(e.getValue(),n.options))}function d(n,r){a(n);var i=n.state.lint,s=i.options,o=c(r);for(var u=0;u<o.length;++u){var p=o[u];if(!p)continue;var d=null,v=i.hasGutter&&document.createDocumentFragment();for(var m=0;m<p.length;++m){var g=p[m],y=g.severity;t.test(y)||(y="error"),d=l(d,y),s.formatAnnotation&&(g=s.formatAnnotation(g)),i.hasGutter&&v.appendChild(h(g)),g.to&&i.marked.push(n.markText(g.from,g.to,{className:"CodeMirror-lint-mark-"+y,__annotation:g}))}i.hasGutter&&n.setGutterMarker(u,e,f(v,d,p.length>1,i.options.tooltips))}s.onUpdateLinting&&s.onUpdateLinting(r,o,n)}function v(e){var t=e.state.lint;clearTimeout(t.timeout),t.timeout=setTimeout(function(){p(e)},t.options.delay||500)}function m(e,t){var n=t.target||t.srcElement;s(t,h(e),n)}function y(e,t){if(!/\bCodeMirror-lint-mark-/.test((t.target||t.srcElement).className))return;for(var n=0;n<g.length;n+=2){var r=e.findMarksAt(e.coordsChar({left:t.clientX+g[n],top:t.clientY+g[n+1]}));for(var i=0;i<r.length;++i){var s=r[i],o=s.__annotation;if(o)return m(o,t)}}}function b(t,n,r){r&&r!=CodeMirror.Init&&(a(t),t.off("change",v),CodeMirror.off(t.getWrapperElement(),"mouseover",t.state.lint.onMouseOver),delete t.state.lint);if(n){var i=t.getOption("gutters"),s=!1;for(var f=0;f<i.length;++f)i[f]==e&&(s=!0);var l=t.state.lint=new o(t,u(t,n),s);t.on("change",v),l.options.tooltips!=0&&CodeMirror.on(t.getWrapperElement(),"mouseover",l.onMouseOver),p(t)}}var e="CodeMirror-lint-markers",t=/^(?:error|warning)$/,g=[0,0,0,5,0,-5,5,0,-5,0];CodeMirror.defineOption("lintWith",!1,b),CodeMirror.defineOption("lint",!1,b)})();