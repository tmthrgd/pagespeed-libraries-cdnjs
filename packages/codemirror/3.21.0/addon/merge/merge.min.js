(function(){"use strict";function n(e,t){this.mv=e,this.type=t,this.classes=t=="left"?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}function r(e){function i(r){r=="full"&&(e.svg&&x(e.svg),x(e.copyButtons),a(e.edit,t.marked,e.classes),a(e.orig,n.marked,e.classes),t.from=t.to=n.from=n.to=0),e.diffOutOfDate&&(e.diff=g(e.orig.getValue(),e.edit.getValue()),e.diffOutOfDate=!1,CodeMirror.signal(e.edit,"updateDiff",e.diff)),e.showDifferences&&(f(e.edit,e.diff,t,DIFF_INSERT,e.classes),f(e.orig,e.diff,n,DIFF_DELETE,e.classes)),c(e)}function s(e){clearTimeout(r),r=setTimeout(i,e==1?250:100)}function o(){e.diffOutOfDate||(e.diffOutOfDate=!0,t.from=t.to=n.from=n.to=0),s(!0)}var t={from:0,to:0,marked:[]},n={from:0,to:0,marked:[]},r;return e.edit.on("change",o),e.orig.on("change",o),e.edit.on("viewportChange",s),e.orig.on("viewportChange",s),i(),i}function i(e){e.edit.on("scroll",function(){s(e,DIFF_INSERT)&&c(e)}),e.orig.on("scroll",function(){s(e,DIFF_DELETE)&&c(e)})}function s(e,t){if(e.diffOutOfDate)return!1;if(!e.lockScroll)return!0;var n,r,i=+(new Date);t==DIFF_INSERT?(n=e.edit,r=e.orig):(n=e.orig,r=e.edit);if(n.state.scrollSetBy==e&&(n.state.scrollSetAt||0)+50>i)return!1;var s=n.getScrollInfo(),u=.5*s.clientHeight,a=s.top+u,f=n.lineAtHeight(a,"local"),l=E(e.diff,f,t==DIFF_INSERT),c=o(n,t==DIFF_INSERT?l.edit:l.orig),h=o(r,t==DIFF_INSERT?l.orig:l.edit),p=(a-c.top)/(c.bot-c.top),d=h.top-u+p*(h.bot-h.top),v,m;if(d>s.top&&(m=s.top/u)<1)d=d*m+s.top*(1-m);else if((v=s.height-s.clientHeight-s.top)<u){var g=r.getScrollInfo(),y=g.height-g.clientHeight-d;y>v&&(m=v/u)<1&&(d=d*m+(g.height-g.clientHeight-v)*(1-m))}return r.scrollTo(s.left,d),r.state.scrollSetAt=i,r.state.scrollSetBy=e,!0}function o(e,t){var n=t.after;return n==null&&(n=e.lastLine()+1),{top:e.heightAtLine(t.before||0,"local"),bot:e.heightAtLine(n,"local")}}function u(e,t,n){e.lockScroll=t,t&&n!=0&&s(e,DIFF_INSERT)&&c(e),e.lockButton.innerHTML=t?"⇛⇚":"⇛&nbsp;&nbsp;⇚"}function a(e,t,n){for(var r=0;r<t.length;++r){var i=t[r];i instanceof CodeMirror.TextMarker?i.clear():(e.removeLineClass(i,"background",n.chunk),e.removeLineClass(i,"background",n.start),e.removeLineClass(i,"background",n.end))}t.length=0}function f(e,t,n,r,i){var s=e.getViewport();e.operation(function(){n.from==n.to||s.from-n.to>20||n.from-s.to>20?(a(e,n.marked,i),l(e,t,r,n.marked,s.from,s.to,i),n.from=s.from,n.to=s.to):(s.from<n.from&&(l(e,t,r,n.marked,s.from,n.from,i),n.from=s.from),s.to>n.to&&(l(e,t,r,n.marked,n.to,s.to,i),n.to=s.to))})}function l(t,n,r,i,s,o,u){function h(e,n){var r=Math.max(s,e),a=Math.min(o,n);for(var f=r;f<a;++f){var l=t.addLineClass(f,"background",u.chunk);f==e&&t.addLineClass(l,"background",u.start),f==n-1&&t.addLineClass(l,"background",u.end),i.push(l)}e==n&&r==n&&a==n&&(r?i.push(t.addLineClass(r-1,"background",u.end)):i.push(t.addLineClass(r,"background",u.start)))}var a=e(0,0),f=e(s,0),l=t.clipPos(e(o-1)),c=r==DIFF_DELETE?u.del:u.insert,p=0;for(var d=0;d<n.length;++d){var v=n[d],m=v[0],g=v[1];if(m==DIFF_EQUAL){var y=a.line+(w(n,d)?0:1);C(a,g);var E=a.line+(b(n,d)?1:0);E>y&&(d&&h(p,y),p=E)}else if(m==r){var S=C(a,g,!0),x=L(f,a),T=k(l,S);A(x,T)||i.push(t.markText(x,T,{className:c})),a=S}}p<=a.line&&h(p,a.line+1)}function c(e){if(!e.showDifferences)return;if(e.svg){x(e.svg);var n=e.gap.offsetWidth;T(e.svg,"width",n,"height",e.gap.offsetHeight)}x(e.copyButtons);var r=e.type=="left",i=e.edit.getViewport(),s=e.orig.getViewport(),o=e.edit.getScrollInfo().top,u=e.orig.getScrollInfo().top;y(e.diff,function(a,f,l,c){if(l>i.to||c<i.from||a>s.to||f<s.from)return;var h=e.orig.heightAtLine(a,"local")-u,p=h;if(e.svg){var d=e.edit.heightAtLine(l,"local")-o;if(r){var v=h;h=d,d=v}var m=e.orig.heightAtLine(f,"local")-u,g=e.edit.heightAtLine(c,"local")-o;if(r){var v=m;m=g,g=v}var y=" C "+n/2+" "+d+" "+n/2+" "+h+" "+(n+2)+" "+h,b=" C "+n/2+" "+m+" "+n/2+" "+g+" -1 "+g;T(e.svg.appendChild(document.createElementNS(t,"path")),"d","M -1 "+d+y+" L "+(n+2)+" "+m+b+" z","class",e.classes.connect)}var w=e.copyButtons.appendChild(S("div",e.type=="left"?"⇝":"⇜","CodeMirror-merge-copy"));w.title="Revert chunk",w.chunk={topEdit:l,botEdit:c,topOrig:a,botOrig:f},w.style.top=p+"px"})}function h(t,n){if(t.diffOutOfDate)return;t.edit.replaceRange(t.orig.getRange(e(n.topOrig,0),e(n.botOrig,0)),e(n.topEdit,0),e(n.botEdit,0))}function d(e){var n=e.lockButton=S("div",null,"CodeMirror-merge-scrolllock");n.title="Toggle locked scrolling";var r=S("div",[n],"CodeMirror-merge-scrolllock-wrap");CodeMirror.on(n,"click",function(){u(e,!e.lockScroll)}),e.copyButtons=S("div",null,"CodeMirror-merge-copybuttons-"+e.type),CodeMirror.on(e.copyButtons,"click",function(t){var n=t.target||t.srcElement;n.chunk&&h(e,n.chunk)});var i=[e.copyButtons,r],s=document.createElementNS&&document.createElementNS(t,"svg");return s&&!s.createSVGRect&&(s=null),e.svg=s,s&&i.push(s),e.gap=S("div",i,"CodeMirror-merge-gap")}function v(e){return typeof e=="string"?e:e.getValue()}function g(e,t){var n=m.diff_main(e,t);m.diff_cleanupSemantic(n);for(var r=0;r<n.length;++r){var i=n[r];i[1]?r&&n[r-1][0]==i[0]&&(n.splice(r--,1),n[r][1]+=i[1]):n.splice(r--,1)}return n}function y(t,n){var r=0,i=0,s=e(0,0),o=e(0,0);for(var u=0;u<t.length;++u){var a=t[u],f=a[0];if(f==DIFF_EQUAL){var l=w(t,u)?0:1,c=s.line+l,h=o.line+l;C(s,a[1],null,o);var p=b(t,u)?1:0,d=s.line+p,v=o.line+p;d>c&&(u&&n(i,h,r,c),r=d,i=v)}else C(f==DIFF_INSERT?s:o,a[1])}(r<=s.line||i<=o.line)&&n(i,o.line+1,r,s.line+1)}function b(e,t){if(t==e.length-1)return!0;var n=e[t+1][1];return n.length==1||n.charCodeAt(0)!=10?!1:t==e.length-2?!0:(n=e[t+2][1],n.length>1&&n.charCodeAt(0)==10)}function w(e,t){if(t==0)return!0;var n=e[t-1][1];return n.charCodeAt(n.length-1)!=10?!1:t==1?!0:(n=e[t-2][1],n.charCodeAt(n.length-1)==10)}function E(e,t,n){var r,i,s,o;return y(e,function(e,u,a,f){var l=n?a:e,c=n?f:u;i==null&&(l>t?(i=a,o=e):c>t&&(i=f,o=u)),c<=t?(r=f,s=u):l<=t&&(r=a,s=e)}),{edit:{before:r,after:i},orig:{before:s,after:o}}}function S(e,t,n,r){var i=document.createElement(e);n&&(i.className=n),r&&(i.style.cssText=r);if(typeof t=="string")i.appendChild(document.createTextNode(t));else if(t)for(var s=0;s<t.length;++s)i.appendChild(t[s]);return i}function x(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild)}function T(e){for(var t=1;t<arguments.length;t+=2)e.setAttribute(arguments[t],arguments[t+1])}function N(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function C(t,n,r,i){var s=r?e(t.line,t.ch):t,o=0;for(;;){var u=n.indexOf("\n",o);if(u==-1)break;++s.line,i&&++i.line,o=u+1}return s.ch=(o?0:s.ch)+(n.length-o),i&&(i.ch=(o?0:i.ch)+(n.length-o)),s}function k(e,t){return(e.line-t.line||e.ch-t.ch)<0?e:t}function L(e,t){return(e.line-t.line||e.ch-t.ch)>0?e:t}function A(e,t){return e.line==t.line&&e.ch==t.ch}var e=CodeMirror.Pos,t="http://www.w3.org/2000/svg";n.prototype={constructor:n,init:function(e,t,n){this.edit=this.mv.edit,this.orig=CodeMirror(e,N({value:t,readOnly:!0},N(n))),this.diff=g(v(t),v(n.value)),this.diffOutOfDate=!1,this.showDifferences=n.showDifferences!==!1,this.forceUpdate=r(this),u(this,!0,!1),i(this)},setShowDifferences:function(e){e=e!==!1,e!=this.showDifferences&&(this.showDifferences=e,this.forceUpdate("full"))}};var p=CodeMirror.MergeView=function(e,t){if(!(this instanceof p))return new p(e,t);var r=t.origLeft,i=t.origRight==null?t.orig:t.origRight,s=r!=null,o=i!=null,u=1+(s?1:0)+(o?1:0),a=[],f=this.left=null,l=this.right=null;if(s){f=this.left=new n(this,"left");var h=S("div",null,"CodeMirror-merge-pane");a.push(h),a.push(d(f))}var v=S("div",null,"CodeMirror-merge-pane");a.push(v);if(o){l=this.right=new n(this,"right"),a.push(d(l));var m=S("div",null,"CodeMirror-merge-pane");a.push(m)}(o?m:v).className+=" CodeMirror-merge-pane-rightmost",a.push(S("div",null,null,"height: 0; clear: both;"));var g=this.wrap=e.appendChild(S("div",a,"CodeMirror-merge CodeMirror-merge-"+u+"pane"));this.edit=CodeMirror(v,N(t)),f&&f.init(h,r,t),l&&l.init(m,i,t);var y=function(){f&&c(f),l&&c(l)};CodeMirror.on(window,"resize",y);var b=setInterval(function(){for(var e=g.parentNode;e&&e!=document.body;e=e.parentNode);e||(clearInterval(b),CodeMirror.off(window,"resize",y))},5e3)};p.prototype={constuctor:p,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(e){this.right&&this.right.setShowDifferences(e),this.left&&this.left.setShowDifferences(e)}};var m=new diff_match_patch})();