(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){"use strict";e.defineMode("xml",function(t,n){function c(e,t){function n(n){return t.tokenize=n,n(e,t)}var r=e.next();if(r=="<"){if(e.eat("!"))return e.eat("[")?e.match("CDATA[")?n(d("atom","]]>")):null:e.match("--")?n(d("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),n(v(1))):null;if(e.eat("?"))return e.eatWhile(/[\w\._\-]/),t.tokenize=d("meta","?>"),"meta";var i=e.eat("/");a="";var s;while(s=e.eat(/[^\s\u00a0=<>\"\'\/?]/))a+=s;return o.caseFold&&(a=a.toLowerCase()),a?(f=i?"closeTag":"openTag",t.tokenize=h,"tag"):"tag error"}if(r=="&"){var u;return e.eat("#")?e.eat("x")?u=e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):u=e.eatWhile(/[\d]/)&&e.eat(";"):u=e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),u?"atom":"error"}return e.eatWhile(/[^&<]/),null}function h(e,t){var n=e.next();if(n==">"||n=="/"&&e.eat(">"))return t.tokenize=c,f=n==">"?"endTag":"selfcloseTag","tag";if(n=="=")return f="equals",null;if(n=="<"){t.tokenize=c,t.state=b,t.tagName=t.tagStart=null;var r=t.tokenize(e,t);return r?r+" error":"error"}return/[\'\"]/.test(n)?(t.tokenize=p(n),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.eatWhile(/[^\s\u00a0=<>\"\']/),"word")}function p(e){var t=function(t,n){while(!t.eol())if(t.next()==e){n.tokenize=h;break}return"string"};return t.isInAttribute=!0,t}function d(e,t){return function(n,r){while(!n.eol()){if(n.match(t)){r.tokenize=c;break}n.next()}return e}}function v(e){return function(t,n){var r;while((r=t.next())!=null){if(r=="<")return n.tokenize=v(e+1),n.tokenize(t,n);if(r==">"){if(e==1){n.tokenize=c;break}return n.tokenize=v(e-1),n.tokenize(t,n)}}return"meta"}}function m(e,t,n){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=n;if(o.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)this.noIndent=!0}function g(e){e.context&&(e.context=e.context.prev)}function y(e,t){var n;for(;;){if(!e.context)return;n=e.context.tagName;if(!o.contextGrabbers.hasOwnProperty(n)||!o.contextGrabbers[n].hasOwnProperty(t))return;g(e)}}function b(e,t,n){if(e=="openTag")return n.tagName=a,n.tagStart=t.column(),S;if(e=="closeTag"){var r=!1;return n.context?n.context.tagName!=a&&(o.implicitlyClosed.hasOwnProperty(n.context.tagName)&&g(n),r=!n.context||n.context.tagName!=a):r=!0,r&&(l="error"),r?E:w}return b}function w(e,t,n){return e!="endTag"?(l="error",w):(g(n),b)}function E(e,t,n){return l="error",w(e,t,n)}function S(e,t,n){if(e=="word")return l="attribute",x;if(e=="endTag"||e=="selfcloseTag"){var r=n.tagName,i=n.tagStart;return n.tagName=n.tagStart=null,e=="selfcloseTag"||o.autoSelfClosers.hasOwnProperty(r)?y(n,r):(y(n,r),n.context=new m(n,r,i==n.indented)),b}return l="error",S}function x(e,t,n){return e=="equals"?T:(o.allowMissing||(l="error"),S(e,t,n))}function T(e,t,n){return e=="string"?N:e=="word"&&o.allowUnquoted?(l="string",S):(l="error",S(e,t,n))}function N(e,t,n){return e=="string"?N:S(e,t,n)}var r=t.indentUnit,i=n.multilineTagIndentFactor||1,s=n.multilineTagIndentPastTag;s==null&&(s=!0);var o=n.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1},u=n.alignCDATA,a,f,l;return{startState:function(){return{tokenize:c,state:b,indented:0,tagName:null,tagStart:null,context:null}},token:function(e,t){!t.tagName&&e.sol()&&(t.indented=e.indentation());if(e.eatSpace())return null;a=f=null;var n=t.tokenize(e,t);return(n||f)&&n!="comment"&&(l=null,t.state=t.state(f||n,e,t),l&&(n=l=="error"?n+" error":l)),n},indent:function(t,n,o){var a=t.context;if(t.tokenize.isInAttribute)return t.stringStartCol+1;if(a&&a.noIndent)return e.Pass;if(t.tokenize!=h&&t.tokenize!=c)return o?o.match(/^(\s*)/)[0].length:0;if(t.tagName)return s?t.tagStart+t.tagName.length+2:t.tagStart+r*i;if(u&&/<!\[CDATA\[/.test(n))return 0;a&&/^<\//.test(n)&&(a=a.prev);while(a&&!a.startOfLine)a=a.prev;return a?a.indent+r:0},electricChars:"/",blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:n.htmlMode?"html":"xml",helperType:n.htmlMode?"html":"xml"}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})});