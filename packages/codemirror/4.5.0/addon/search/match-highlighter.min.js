!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){"object"==typeof t&&(this.minChars=t.minChars,this.style=t.style,this.showToken=t.showToken,this.delay=t.delay),null==this.style&&(this.style=h),null==this.minChars&&(this.minChars=s),null==this.delay&&(this.delay=a),this.overlay=this.timeout=null}function i(t){var e=t.state.matchHighlighter;clearTimeout(e.timeout),e.timeout=setTimeout(function(){r(t)},e.delay)}function r(t){t.operation(function(){var e=t.state.matchHighlighter;if(e.overlay&&(t.removeOverlay(e.overlay),e.overlay=null),!t.somethingSelected()&&e.showToken){for(var i=e.showToken===!0?/[\w$]/:e.showToken,r=t.getCursor(),o=t.getLine(r.line),s=r.ch,h=s;s&&i.test(o.charAt(s-1));)--s;for(;h<o.length&&i.test(o.charAt(h));)++h;return void(h>s&&t.addOverlay(e.overlay=n(o.slice(s,h),i,e.style)))}var a=t.getCursor("from"),l=t.getCursor("to");if(a.line==l.line){var c=t.getRange(a,l).replace(/^\s+|\s+$/g,"");c.length>=e.minChars&&t.addOverlay(e.overlay=n(c,!1,e.style))}})}function o(t,e){return!(t.start&&e.test(t.string.charAt(t.start-1))||t.pos!=t.string.length&&e.test(t.string.charAt(t.pos)))}function n(t,e,i){return{token:function(r){return!r.match(t)||e&&!o(r,e)?(r.next(),void(r.skipTo(t.charAt(0))||r.skipToEnd())):i}}}var s=2,h="matchhighlight",a=100;t.defineOption("highlightSelectionMatches",!1,function(o,n,s){if(s&&s!=t.Init){var h=o.state.matchHighlighter.overlay;h&&o.removeOverlay(h),clearTimeout(o.state.matchHighlighter.timeout),o.state.matchHighlighter=null,o.off("cursorActivity",i)}n&&(o.state.matchHighlighter=new e(n),r(o),o.on("cursorActivity",i))})});