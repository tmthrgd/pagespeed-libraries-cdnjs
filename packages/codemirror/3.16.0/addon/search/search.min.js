!function(){function e(e){return"string"==typeof e?{token:function(o){return o.match(e)?"searching":(o.next(),o.skipTo(e.charAt(0))||o.skipToEnd(),void 0)}}:{token:function(o){if(o.match(e))return"searching";for(;!o.eol()&&(o.next(),!o.match(e,!1)););}}}function o(){this.posFrom=this.posTo=this.query=null,this.overlay=null}function r(e){return e.state.search||(e.state.search=new o)}function n(e,o,r){return e.getSearchCursor(o,r,"string"==typeof o&&o==o.toLowerCase())}function t(e,o,r,n){e.openDialog?e.openDialog(o,n):n(prompt(r,""))}function i(e,o,r,n){e.openConfirm?e.openConfirm(o,n):confirm(r)&&n[0]()}function a(e){var o=e.match(/^\/(.*)\/([a-z]*)$/);return o?new RegExp(o[1],-1==o[2].indexOf("i")?"":"i"):e}function c(o,n){var i=r(o);return i.query?u(o,n):(t(o,p,"Search for:",function(r){o.operation(function(){r&&!i.query&&(i.query=a(r),o.removeOverlay(i.overlay),i.overlay=e(i.query),o.addOverlay(i.overlay),i.posFrom=i.posTo=o.getCursor(),u(o,n))})}),void 0)}function u(e,o){e.operation(function(){var t=r(e),i=n(e,t.query,o?t.posFrom:t.posTo);(i.find(o)||(i=n(e,t.query,o?CodeMirror.Pos(e.lastLine()):CodeMirror.Pos(e.firstLine(),0)),i.find(o)))&&(e.setSelection(i.from(),i.to()),t.posFrom=i.from(),t.posTo=i.to())})}function f(e){e.operation(function(){var o=r(e);o.query&&(o.query=null,e.removeOverlay(o.overlay))})}function s(e,o){t(e,l,"Replace:",function(r){r&&(r=a(r),t(e,m,"Replace with:",function(t){if(o)e.operation(function(){for(var o=n(e,r);o.findNext();)if("string"!=typeof r){var i=e.getRange(o.from(),o.to()).match(r);o.replace(t.replace(/\$(\d)/,function(e,o){return i[o]}))}else o.replace(t)});else{f(e);var a=n(e,r,e.getCursor()),c=function(){var o,t=a.from();!(o=a.findNext())&&(a=n(e,r),!(o=a.findNext())||t&&a.from().line==t.line&&a.from().ch==t.ch)||(e.setSelection(a.from(),a.to()),i(e,d,"Replace?",[function(){u(o)},c]))},u=function(e){a.replace("string"==typeof r?t:t.replace(/\$(\d)/,function(o,r){return e[r]})),c()};c()}}))})}var p='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',l='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',m='With: <input type="text" style="width: 10em"/>',d="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(e){f(e),c(e)},CodeMirror.commands.findNext=c,CodeMirror.commands.findPrev=function(e){c(e,!0)},CodeMirror.commands.clearSearch=f,CodeMirror.commands.replace=s,CodeMirror.commands.replaceAll=function(e){s(e,!0)}}();