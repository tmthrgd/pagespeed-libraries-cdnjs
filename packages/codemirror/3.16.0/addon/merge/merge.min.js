!function(){"use strict";function e(e,t){this.mv=e,this.type=t,this.classes="left"==t?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}function t(e){function t(){e.diffOutOfDate&&(e.diff=s(e.orig.getValue(),e.edit.getValue()),e.diffOutOfDate=!1),a(e.edit,e.diff,i,DIFF_INSERT,e.classes),a(e.orig,e.diff,n,DIFF_DELETE,e.classes),f(e)}function r(e){clearTimeout(o),o=setTimeout(t,1==e?250:100)}var o,i={from:0,to:0,marked:[]},n={from:0,to:0,marked:[]};return e.edit.on("change",function(){e.diffOutOfDate||(e.diffOutOfDate=!0,i.from=i.to=n.from=n.to=0),r(!0)}),e.edit.on("viewportChange",r),e.orig.on("viewportChange",r),t(),t}function r(e){e.edit.on("scroll",function(){o(e,DIFF_INSERT)&&f(e)}),e.orig.on("scroll",function(){o(e,DIFF_DELETE)&&f(e)})}function o(e,t){if(e.diffOutOfDate)return!1;if(!e.lockScroll)return!0;var r,o,n=+new Date;if(t==DIFF_INSERT?(r=e.edit,o=e.orig):(r=e.orig,o=e.edit),r.state.scrollSetBy==e&&(r.state.scrollSetAt||0)+50>n)return!1;var l,a,c=r.getScrollInfo(),f=.5*c.clientHeight,d=c.top+f,u=r.lineAtHeight(d,"local"),s=p(e.diff,u,t==DIFF_INSERT),h=i(r,t==DIFF_INSERT?s.edit:s.orig),g=i(o,t==DIFF_INSERT?s.orig:s.edit),v=(d-h.top)/(h.bot-h.top),m=g.top-f+v*(g.bot-g.top);if(m>c.top&&(a=c.top/f)<1)m=m*a+c.top*(1-a);else if((l=c.height-c.clientHeight-c.top)<f){var C=o.getScrollInfo(),k=C.height-C.clientHeight-m;k>l&&(a=l/f)<1&&(m=m*a+(C.height-C.clientHeight-l)*(1-a))}return o.scrollTo(c.left,m),o.state.scrollSetAt=n,o.state.scrollSetBy=e,!0}function i(e,t){var r=t.after;return null==r&&(r=e.lastLine()+1),{top:e.heightAtLine(t.before||0,"local"),bot:e.heightAtLine(r,"local")}}function n(e,t,r){e.lockScroll=t,t&&0!=r&&o(e,DIFF_INSERT)&&f(e),e.lockButton.innerHTML=t?"⇛⇚":"⇛&nbsp;&nbsp;⇚"}function l(e,t,r){for(var o=0;o<t.length;++o){var i=t[o];i instanceof CodeMirror.TextMarker?i.clear():(e.removeLineClass(i,"background",r.chunk),e.removeLineClass(i,"background",r.start),e.removeLineClass(i,"background",r.end))}t.length=0}function a(e,t,r,o,i){var n=e.getViewport();e.operation(function(){r.from==r.to||n.from-r.to>20||r.from-n.to>20?(l(e,r.marked,i),c(e,t,o,r.marked,n.from,n.to,i),r.from=n.from,r.to=n.to):(n.from<r.from&&(c(e,t,o,r.marked,n.from,r.from,i),r.from=n.from),n.to>r.to&&(c(e,t,o,r.marked,r.to,n.to,i),r.to=n.to))})}function c(e,t,r,o,i,n,l){function a(t,r){for(var a=Math.max(i,t),c=Math.min(n,r),f=a;c>f;++f){var d=e.addLineClass(f,"background",l.chunk);f==t&&e.addLineClass(d,"background",l.start),f==r-1&&e.addLineClass(d,"background",l.end),o.push(d)}t==r&&a==r&&c==r&&(a?o.push(e.addLineClass(a-1,"background",l.end)):o.push(e.addLineClass(a,"background",l.start)))}for(var c=D(0,0),f=D(i,0),d=e.clipPos(D(n-1)),u=r==DIFF_DELETE?l.del:l.insert,s=0,h=0;h<t.length;++h){var p=t[h],m=p[0],C=p[1];if(m==DIFF_EQUAL){var k=c.line+(v(t,h)?0:1);E(c,C);var M=c.line+(g(t,h)?1:0);M>k&&(h&&a(s,k),s=M)}else if(m==r){var S=E(c,C,!0),w=F(f,c),L=I(d,S);b(w,L)||o.push(e.markText(w,L,{className:u})),c=S}}s<=c.line&&a(s,c.line+1)}function f(e){if(e.svg){C(e.svg);var t=e.gap.offsetWidth;k(e.svg,"width",t,"height",e.gap.offsetHeight)}C(e.copyButtons);var r="left"==e.type,o=e.edit.getViewport(),i=e.orig.getViewport(),n=e.edit.getScrollInfo().top,l=e.orig.getScrollInfo().top;h(e.diff,function(a,c,f,d){if(!(f>o.to||d<o.from||a>i.to||c<i.from)){var u=e.orig.heightAtLine(a,"local")-l,s=u;if(e.svg){var h=e.edit.heightAtLine(f,"local")-n;if(r){var g=u;u=h,h=g}var v=e.orig.heightAtLine(c,"local")-l,p=e.edit.heightAtLine(d,"local")-n;if(r){var g=v;v=p,p=g}var C=" C "+t/2+" "+h+" "+t/2+" "+u+" "+(t+2)+" "+u,M=" C "+t/2+" "+v+" "+t/2+" "+p+" -1 "+p;k(e.svg.appendChild(document.createElementNS(S,"path")),"d","M -1 "+h+C+" L "+(t+2)+" "+v+M+" z","class",e.classes.connect)}var E=e.copyButtons.appendChild(m("div","left"==e.type?"⇝":"⇜","CodeMirror-merge-copy"));E.title="Revert chunk",E.chunk={topEdit:f,botEdit:d,topOrig:a,botOrig:c},E.style.top=s+"px"}})}function d(e,t){e.diffOutOfDate||e.edit.replaceRange(e.orig.getRange(D(t.topOrig,0),D(t.botOrig,0)),D(t.topEdit,0),D(t.botEdit,0))}function u(e){var t=e.lockButton=m("div",null,"CodeMirror-merge-scrolllock");t.title="Toggle locked scrolling";var r=m("div",[t],"CodeMirror-merge-scrolllock-wrap");CodeMirror.on(t,"click",function(){n(e,!e.lockScroll)}),e.copyButtons=m("div",null,"CodeMirror-merge-copybuttons-"+e.type),CodeMirror.on(e.copyButtons,"click",function(t){var r=t.target||t.srcElement;r.chunk&&d(e,r.chunk)});var o=[e.copyButtons,r],i=document.createElementNS&&document.createElementNS(S,"svg");return i&&!i.createSVGRect&&(i=null),e.svg=i,i&&o.push(i),e.gap=m("div",o,"CodeMirror-merge-gap")}function s(e,t){var r=L.diff_main(e,t);L.diff_cleanupSemantic(r);for(var o=0;o<r.length;++o){var i=r[o];i[1]?o&&r[o-1][0]==i[0]&&(r.splice(o--,1),r[o][1]+=i[1]):r.splice(o--,1)}return r}function h(e,t){for(var r=0,o=0,i=D(0,0),n=D(0,0),l=0;l<e.length;++l){var a=e[l],c=a[0];if(c==DIFF_EQUAL){var f=v(e,l)?0:1,d=i.line+f,u=n.line+f;E(i,a[1],null,n);var s=g(e,l)?1:0,h=i.line+s,p=n.line+s;h>d&&(l&&t(o,u,r,d),r=h,o=p)}else E(c==DIFF_INSERT?i:n,a[1])}(r<=i.line||o<=n.line)&&t(o,n.line+1,r,i.line+1)}function g(e,t){if(t==e.length-1)return!0;var r=e[t+1][1];return 1==r.length||10!=r.charCodeAt(0)?!1:t==e.length-2?!0:(r=e[t+2][1],r.length>1&&10==r.charCodeAt(0))}function v(e,t){if(0==t)return!0;var r=e[t-1][1];return 10!=r.charCodeAt(r.length-1)?!1:1==t?!0:(r=e[t-2][1],10==r.charCodeAt(r.length-1))}function p(e,t,r){var o,i,n,l;return h(e,function(e,a,c,f){var d=r?c:e,u=r?f:a;null==i&&(d>t?(i=c,l=e):u>t&&(i=f,l=a)),t>=u?(o=f,n=a):t>=d&&(o=c,n=e)}),{edit:{before:o,after:i},orig:{before:n,after:l}}}function m(e,t,r,o){var i=document.createElement(e);if(r&&(i.className=r),o&&(i.style.cssText=o),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var n=0;n<t.length;++n)i.appendChild(t[n]);return i}function C(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild)}function k(e){for(var t=1;t<arguments.length;t+=2)e.setAttribute(arguments[t],arguments[t+1])}function M(e,t){t||(t={});for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function E(e,t,r,o){for(var i=r?D(e.line,e.ch):e,n=0;;){var l=t.indexOf("\n",n);if(-1==l)break;++i.line,o&&++o.line,n=l+1}return i.ch=(n?0:i.ch)+(t.length-n),o&&(o.ch=(n?0:o.ch)+(t.length-n)),i}function I(e,t){return(e.line-t.line||e.ch-t.ch)<0?e:t}function F(e,t){return(e.line-t.line||e.ch-t.ch)>0?e:t}function b(e,t){return e.line==t.line&&e.ch==t.ch}var D=CodeMirror.Pos,S="http://www.w3.org/2000/svg";e.prototype={constructor:e,init:function(e,o,i){this.edit=this.mv.edit,this.orig=CodeMirror(e,M({value:o,readOnly:!0},M(i))),this.diff=s(o,i.value),this.diffOutOfDate=!1,this.forceUpdate=t(this),n(this,!0,!1),r(this)}};var w=CodeMirror.MergeView=function(t,r){if(!(this instanceof w))return new w(t,r);var o=r.origLeft,i=null==r.origRight?r.orig:r.origRight,n=null!=o,l=null!=i,a=1+(n?1:0)+(l?1:0),c=[],d=this.left=null,s=this.right=null;if(n){d=this.left=new e(this,"left");var h=m("div",null,"CodeMirror-merge-pane");c.push(h),c.push(u(d))}var g=m("div",null,"CodeMirror-merge-pane");if(c.push(g),l){s=this.right=new e(this,"right"),c.push(u(s));var v=m("div",null,"CodeMirror-merge-pane");c.push(v)}(l?v:g).className+=" CodeMirror-merge-pane-rightmost",c.push(m("div",null,null,"height: 0; clear: both;"));var p=this.wrap=t.appendChild(m("div",c,"CodeMirror-merge CodeMirror-merge-"+a+"pane"));this.edit=CodeMirror(g,M(r)),d&&d.init(h,o,r),s&&s.init(v,i,r);var C=function(){d&&f(d),s&&f(s)};CodeMirror.on(window,"resize",C);var k=setInterval(function(){for(var e=p.parentNode;e&&e!=document.body;e=e.parentNode);e||(clearInterval(k),CodeMirror.off(window,"resize",C))},5e3)};w.prototype={constuctor:w,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig}};var L=new diff_match_patch}();