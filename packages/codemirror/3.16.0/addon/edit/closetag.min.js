!function(){function e(e,o){var i=e.getCursor(),a=e.getTokenAt(i),d=CodeMirror.innerMode(e.getMode(),a.state),l=d.state;if("xml"!=d.mode.name)return CodeMirror.Pass;var s=e.getOption("autoCloseTags"),c="html"==d.mode.configuration,f="object"==typeof s&&s.dontCloseTags||c&&t,g="object"==typeof s&&s.indentTags||c&&n;if(">"==o&&l.tagName){var u=l.tagName;a.end>i.ch&&(u=u.slice(0,u.length-a.end+i.ch));var h=u.toLowerCase();if("tag"==a.type&&"closeTag"==l.type||a.string.indexOf("/")==a.string.length-1||f&&r(f,h)>-1)return CodeMirror.Pass;var m=g&&r(g,h)>-1,p=m?CodeMirror.Pos(i.line+1,0):CodeMirror.Pos(i.line,i.ch+1);return e.replaceSelection(">"+(m?"\n\n":"")+"</"+u+">",{head:p,anchor:p}),m&&(e.indentLine(i.line+1),e.indentLine(i.line+2)),void 0}if("/"==o&&"<"==a.string){var u=l.context&&l.context.tagName;return u&&e.replaceSelection("/"+u+">","end"),void 0}return CodeMirror.Pass}function r(e,r){if(e.indexOf)return e.indexOf(r);for(var t=0,n=e.length;n>t;++t)if(e[t]==r)return t;return-1}CodeMirror.defineOption("autoCloseTags",!1,function(r,t,n){if(!t||n!=CodeMirror.Init&&n)!t&&n!=CodeMirror.Init&&n&&r.removeKeyMap("autoCloseTags");else{var o={name:"autoCloseTags"};("object"!=typeof t||t.whenClosing)&&(o["'/'"]=function(r){return e(r,"/")}),("object"!=typeof t||t.whenOpening)&&(o["'>'"]=function(r){return e(r,">")}),r.addKeyMap(o)}});var t=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],n=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"]}();