!function(){"use strict";function t(t,e,o){this.cm=t,this.getHints=e,this.options=o,this.widget=this.onClose=null}function e(t){return"string"==typeof t?t:t.text}function o(t,e){function o(t,o){var s;s="string"!=typeof o?function(t){return o(t,e)}:i.hasOwnProperty(o)?i[o]:o,n[t]=s}var i={Up:function(){e.moveFocus(-1)},Down:function(){e.moveFocus(1)},PageUp:function(){e.moveFocus(-e.menuSize())},PageDown:function(){e.moveFocus(e.menuSize())},Home:function(){e.setFocus(0)},End:function(){e.setFocus(e.length)},Enter:e.pick,Tab:e.pick,Esc:e.close},n=t.customKeys?{}:i;if(t.customKeys)for(var s in t.customKeys)t.customKeys.hasOwnProperty(s)&&o(s,t.customKeys[s]);if(t.extraKeys)for(var s in t.extraKeys)t.extraKeys.hasOwnProperty(s)&&o(s,t.extraKeys[s]);return n}function i(t,i){this.completion=t,this.data=i;var n=this,s=t.cm,c=t.options,l=this.hints=document.createElement("ul");l.className="CodeMirror-hints",this.selectedHint=0;for(var r=i.list,h=0;h<r.length;++h){var u=l.appendChild(document.createElement("li")),a=r[h],f="CodeMirror-hint"+(h?"":" CodeMirror-hint-active");null!=a.className&&(f=a.className+" "+f),u.className=f,a.render?a.render(u,i,a):u.appendChild(document.createTextNode(a.displayText||e(a))),u.hintId=h}var d=s.cursorCoords(c.alignWithWord!==!1?i.from:null),m=d.left,p=d.bottom,g=!0;l.style.left=m+"px",l.style.top=p+"px";var v=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),y=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),C=l.getBoundingClientRect(),w=C.right-v,H=C.bottom-y;if(w>0&&(C.right-C.left>v&&(l.style.width=v-5+"px",w-=C.right-C.left-v),l.style.left=(m=d.left-w)+"px"),H>0){var M=C.bottom-C.top;C.top-(d.bottom-d.top)-M>0?(H=M+(d.bottom-d.top),g=!1):M>y&&(l.style.height=y-5+"px",H-=M-y),l.style.top=(p=d.bottom-H)+"px"}if((c.container||document.body).appendChild(l),s.addKeyMap(this.keyMap=o(c,{moveFocus:function(t){n.changeActive(n.selectedHint+t)},setFocus:function(t){n.changeActive(t)},menuSize:function(){return n.screenAmount()},length:r.length,close:function(){t.close()},pick:function(){n.pick()}})),c.closeOnUnfocus!==!1){var x;s.on("blur",this.onBlur=function(){x=setTimeout(function(){t.close()},100)}),s.on("focus",this.onFocus=function(){clearTimeout(x)})}var T=s.getScrollInfo();return s.on("scroll",this.onScroll=function(){var e=s.getScrollInfo(),o=s.getWrapperElement().getBoundingClientRect(),i=p+T.top-e.top,n=i-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return g||(n+=l.offsetHeight),n<=o.top||n>=o.bottom?t.close():(l.style.top=i+"px",l.style.left=m+T.left-e.left+"px",void 0)}),CodeMirror.on(l,"dblclick",function(t){var e=t.target||t.srcElement;null!=e.hintId&&(n.changeActive(e.hintId),n.pick())}),CodeMirror.on(l,"click",function(t){var e=t.target||t.srcElement;null!=e.hintId&&n.changeActive(e.hintId)}),CodeMirror.on(l,"mousedown",function(){setTimeout(function(){s.focus()},20)}),CodeMirror.signal(i,"select",r[0],l.firstChild),!0}CodeMirror.showHint=function(e,o,i){if(!e.somethingSelected()&&(null==o&&(o=e.getHelper(e.getCursor(),"hint")),null!=o)){e.state.completionActive&&e.state.completionActive.close();var n=e.state.completionActive=new t(e,o,i||{});return CodeMirror.signal(e,"startCompletion",e),n.options.async?(o(e,function(t){n.showHints(t)},n.options),void 0):n.showHints(o(e,n.options))}},t.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.widget&&this.widget.close(),this.onClose&&this.onClose(),CodeMirror.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,o){var i=t.list[o];i.hint?i.hint(this.cm,t,i):this.cm.replaceRange(e(i),t.from,t.to),this.close()},showHints:function(t){return t&&t.list.length&&this.active()?(0!=this.options.completeSingle&&1==t.list.length?this.pick(t,0):this.showWidget(t),void 0):this.close()},showWidget:function(t){function e(){c||(c=!0,r.close(),r.cm.off("cursorActivity",s),t&&CodeMirror.signal(t,"close"))}function o(){c||(CodeMirror.signal(t,"update"),r.options.async?r.getHints(r.cm,n,r.options):n(r.getHints(r.cm,r.options)))}function n(o){return t=o,c?void 0:t&&t.list.length?(r.widget=new i(r,t),void 0):e()}function s(){clearTimeout(l);var t=r.cm.getCursor(),e=r.cm.getLine(t.line);t.line!=u.line||e.length-t.ch!=a-u.ch||t.ch<u.ch||r.cm.somethingSelected()||t.ch&&h.test(e.charAt(t.ch-1))?r.close():(l=setTimeout(o,170),r.widget&&r.widget.close())}this.widget=new i(this,t),CodeMirror.signal(t,"shown");var c,l=null,r=this,h=this.options.closeCharacters||/[\s()\[\]{};:>,]/,u=this.cm.getCursor(),a=this.cm.getLine(u.line).length;this.cm.on("cursorActivity",s),this.onClose=e}},i.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var t=this.completion.cm;this.completion.options.closeOnUnfocus!==!1&&(t.off("blur",this.onBlur),t.off("focus",this.onFocus)),t.off("scroll",this.onScroll)}},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t){if(t=Math.max(0,Math.min(t,this.data.list.length-1)),this.selectedHint!=t){var e=this.hints.childNodes[this.selectedHint];e.className=e.className.replace(" CodeMirror-hint-active",""),e=this.hints.childNodes[this.selectedHint=t],e.className+=" CodeMirror-hint-active",e.offsetTop<this.hints.scrollTop?this.hints.scrollTop=e.offsetTop-3:e.offsetTop+e.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=e.offsetTop+e.offsetHeight-this.hints.clientHeight+3),CodeMirror.signal(this.data,"select",this.data.list[this.selectedHint],e)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}}}();