(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{this.CodeMirror=a()}}})(function(){var cc=/gecko\/\d/i.test(navigator.userAgent);var en=/MSIE \d/.test(navigator.userAgent);var bz=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var dm=en||bz;var m=dm&&(en?document.documentMode||6:bz[1]);var cI=/WebKit\//.test(navigator.userAgent);var dq=cI&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var cU=/Chrome\//.test(navigator.userAgent);var dE=/Opera\//.test(navigator.userAgent);var az=/Apple Computer/.test(navigator.vendor);var a2=/KHTML\//.test(navigator.userAgent);var cO=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var e4=/PhantomJS/.test(navigator.userAgent);var eC=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var dR=eC||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var bV=eC||/Mac/.test(navigator.platform);var aH=/win/i.test(navigator.platform);var aP=dE&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(aP){aP=Number(aP[1])}if(aP&&aP>=15){dE=false;cI=true}var bG=bV&&(dq||dE&&(aP==null||aP<12.11));var fE=cc||(dm&&m>=9);var fH=false,aY=false;function J(fO,fP){if(!(this instanceof J)){return new J(fO,fP)}this.options=fP=fP||{};aF(eE,fP,false);b2(fP);var fR=fP.value;if(typeof fR=="string"){fR=new ap(fR,fP.mode)}this.doc=fR;var fQ=this.display=new el(fO,fR);fQ.wrapper.CodeMirror=this;dN(this);cz(this);if(fP.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(fP.autofocus&&!dR){ec(this)}this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,draggingText:false,highlight:new fM()};if(dm&&m<11){setTimeout(cj(eY,this,true),20)}fp(this);a9();var fN=this;cx(this,function(){fN.curOp.forceUpdate=true;dM(fN,fR);if((fP.autofocus&&!dR)||dr()==fQ.input){setTimeout(cj(co,fN),20)}else{aM(fN)}for(var fT in a5){if(a5.hasOwnProperty(fT)){a5[fT](fN,fP[fT],b0)}}for(var fS=0;fS<aZ.length;++fS){aZ[fS](fN)}})}function el(fN,fP){var fQ=this;var fO=fQ.input=fw("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");if(cI){fO.style.width="1000px"}else{fO.setAttribute("wrap","off")}if(eC){fO.style.border="1px solid black"}fO.setAttribute("autocorrect","off");fO.setAttribute("autocapitalize","off");fO.setAttribute("spellcheck","false");fQ.inputDiv=fw("div",[fO],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");fQ.scrollbarH=fw("div",[fw("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");fQ.scrollbarV=fw("div",[fw("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");fQ.scrollbarFiller=fw("div",null,"CodeMirror-scrollbar-filler");fQ.gutterFiller=fw("div",null,"CodeMirror-gutter-filler");fQ.lineDiv=fw("div",null,"CodeMirror-code");fQ.selectionDiv=fw("div",null,null,"position: relative; z-index: 1");fQ.cursorDiv=fw("div",null,"CodeMirror-cursors");fQ.measure=fw("div",null,"CodeMirror-measure");fQ.lineMeasure=fw("div",null,"CodeMirror-measure");fQ.lineSpace=fw("div",[fQ.measure,fQ.lineMeasure,fQ.selectionDiv,fQ.cursorDiv,fQ.lineDiv],null,"position: relative; outline: none");fQ.mover=fw("div",[fw("div",[fQ.lineSpace],"CodeMirror-lines")],null,"position: relative");fQ.sizer=fw("div",[fQ.mover],"CodeMirror-sizer");fQ.heightForcer=fw("div",null,null,"position: absolute; height: "+bb+"px; width: 1px;");fQ.gutters=fw("div",null,"CodeMirror-gutters");fQ.lineGutter=null;fQ.scroller=fw("div",[fQ.sizer,fQ.heightForcer,fQ.gutters],"CodeMirror-scroll");fQ.scroller.setAttribute("tabIndex","-1");fQ.wrapper=fw("div",[fQ.inputDiv,fQ.scrollbarH,fQ.scrollbarV,fQ.scrollbarFiller,fQ.gutterFiller,fQ.scroller],"CodeMirror");if(dm&&m<8){fQ.gutters.style.zIndex=-1;fQ.scroller.style.paddingRight=0}if(eC){fO.style.width="0px"}if(!cI){fQ.scroller.draggable=true}if(a2){fQ.inputDiv.style.height="1px";fQ.inputDiv.style.position="absolute"}if(dm&&m<8){fQ.scrollbarH.style.minHeight=fQ.scrollbarV.style.minWidth="18px"}if(fN.appendChild){fN.appendChild(fQ.wrapper)}else{fN(fQ.wrapper)}fQ.viewFrom=fQ.viewTo=fP.first;fQ.view=[];fQ.externalMeasured=null;fQ.viewOffset=0;fQ.lastSizeC=0;fQ.updateLineNumbers=null;fQ.lineNumWidth=fQ.lineNumInnerWidth=fQ.lineNumChars=null;fQ.prevInput="";fQ.alignWidgets=false;fQ.pollingFast=false;fQ.poll=new fM();fQ.cachedCharWidth=fQ.cachedTextHeight=fQ.cachedPaddingH=null;fQ.inaccurateSelection=false;fQ.maxLine=null;fQ.maxLineLength=0;fQ.maxLineChanged=false;fQ.wheelDX=fQ.wheelDY=fQ.wheelStartX=fQ.wheelStartY=null;fQ.shift=false;fQ.selForContextMenu=null}function bi(fN){fN.doc.mode=J.getMode(fN.options,fN.doc.modeOption);dW(fN)}function dW(fN){fN.doc.iter(function(fO){if(fO.stateAfter){fO.stateAfter=null}if(fO.styles){fO.styles=null}});fN.doc.frontier=fN.doc.first;dQ(fN,100);fN.state.modeGen++;if(fN.curOp){ag(fN)}}function ej(fN){if(fN.options.lineWrapping){fa(fN.display.wrapper,"CodeMirror-wrap");fN.display.sizer.style.minWidth=""}else{g(fN.display.wrapper,"CodeMirror-wrap");h(fN)}Y(fN);ag(fN);aj(fN);setTimeout(function(){eA(fN)},100)}function a4(fN){var fP=aO(fN.display),fO=fN.options.lineWrapping;var fQ=fO&&Math.max(5,fN.display.scroller.clientWidth/dh(fN.display)-3);return function(fS){if(e6(fN.doc,fS)){return 0}var fR=0;if(fS.widgets){for(var fT=0;fT<fS.widgets.length;fT++){if(fS.widgets[fT].height){fR+=fS.widgets[fT].height}}}if(fO){return fR+(Math.ceil(fS.text.length/fQ)||1)*fP}else{return fR+fP}}}function Y(fN){var fP=fN.doc,fO=a4(fN);fP.iter(function(fQ){var fR=fO(fQ);if(fR!=fQ.height){fA(fQ,fR)}})}function fK(fN){var fP=eJ[fN.options.keyMap],fO=fP.style;fN.display.wrapper.className=fN.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(fO?" cm-keymap-"+fO:"")}function cz(fN){fN.display.wrapper.className=fN.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+fN.options.theme.replace(/(^|\s)\s*/g," cm-s-");aj(fN)}function da(fN){dN(fN);ag(fN);setTimeout(function(){eh(fN)},20)}function dN(fN){var fO=fN.display.gutters,fS=fN.options.gutters;dD(fO);for(var fP=0;fP<fS.length;++fP){var fQ=fS[fP];var fR=fO.appendChild(fw("div",null,"CodeMirror-gutter "+fQ));if(fQ=="CodeMirror-linenumbers"){fN.display.lineGutter=fR;fR.style.width=(fN.display.lineNumWidth||1)+"px"}}fO.style.display=fP?"":"none";cM(fN)}function cM(fN){var fO=fN.display.gutters.offsetWidth;fN.display.sizer.style.marginLeft=fO+"px";fN.display.scrollbarH.style.left=fN.options.fixedGutter?fO+"px":0}function dX(fP){if(fP.height==0){return 0}var fO=fP.text.length,fN,fR=fP;while(fN=eq(fR)){var fQ=fN.find(0,true);fR=fQ.from.line;fO+=fQ.from.ch-fQ.to.ch}fR=fP;while(fN=d6(fR)){var fQ=fN.find(0,true);fO-=fR.text.length-fQ.from.ch;fR=fQ.to.line;fO+=fR.text.length-fQ.to.ch}return fO}function h(fN){var fP=fN.display,fO=fN.doc;fP.maxLine=eO(fO,fO.first);fP.maxLineLength=dX(fP.maxLine);fP.maxLineChanged=true;fO.iter(function(fR){var fQ=dX(fR);if(fQ>fP.maxLineLength){fP.maxLineLength=fQ;fP.maxLine=fR}})}function b2(fN){var fO=c0(fN.gutters,"CodeMirror-linenumbers");if(fO==-1&&fN.lineNumbers){fN.gutters=fN.gutters.concat(["CodeMirror-linenumbers"])}else{if(fO>-1&&!fN.lineNumbers){fN.gutters=fN.gutters.slice(0);fN.gutters.splice(fO,1)}}}function cB(fN){return fN.display.scroller.clientHeight-fN.display.wrapper.clientHeight<bb-3}function de(fO){var fN=fO.display.scroller;return{clientHeight:fN.clientHeight,barHeight:fO.display.scrollbarV.clientHeight,scrollWidth:fN.scrollWidth,clientWidth:fN.clientWidth,hScrollbarTakesSpace:cB(fO),barWidth:fO.display.scrollbarH.clientWidth,docHeight:Math.round(fO.doc.height+by(fO.display))}}function eA(fU,fN){if(!fN){fN=de(fU)}var fR=fU.display,fO=l(fR.measure);var fV=fN.docHeight+bb;var fP=fN.scrollWidth>fN.clientWidth;if(fP&&fN.scrollWidth<=fN.clientWidth+1&&fO>0&&!fN.hScrollbarTakesSpace){fP=false}var fQ=fV>fN.clientHeight;if(fQ){fR.scrollbarV.style.display="block";fR.scrollbarV.style.bottom=fP?fO+"px":"0";fR.scrollbarV.firstChild.style.height=Math.max(0,fV-fN.clientHeight+(fN.barHeight||fR.scrollbarV.clientHeight))+"px"}else{fR.scrollbarV.style.display="";fR.scrollbarV.firstChild.style.height="0"}if(fP){fR.scrollbarH.style.display="block";fR.scrollbarH.style.right=fQ?fO+"px":"0";fR.scrollbarH.firstChild.style.width=(fN.scrollWidth-fN.clientWidth+(fN.barWidth||fR.scrollbarH.clientWidth))+"px"}else{fR.scrollbarH.style.display="";fR.scrollbarH.firstChild.style.width="0"}if(fP&&fQ){fR.scrollbarFiller.style.display="block";fR.scrollbarFiller.style.height=fR.scrollbarFiller.style.width=fO+"px"}else{fR.scrollbarFiller.style.display=""}if(fP&&fU.options.coverGutterNextToScrollbar&&fU.options.fixedGutter){fR.gutterFiller.style.display="block";fR.gutterFiller.style.height=fO+"px";fR.gutterFiller.style.width=fR.gutters.offsetWidth+"px"}else{fR.gutterFiller.style.display=""}if(!fU.state.checkedOverlayScrollbar&&fN.clientHeight>0){if(fO===0){var fT=bV&&!cO?"12px":"18px";fR.scrollbarV.style.minWidth=fR.scrollbarH.style.minHeight=fT;var fS=function(fW){if(M(fW)!=fR.scrollbarV&&M(fW)!=fR.scrollbarH){cK(fU,d4)(fW)}};bN(fR.scrollbarV,"mousedown",fS);bN(fR.scrollbarH,"mousedown",fS)}fU.state.checkedOverlayScrollbar=true}}function bU(fP,fT,fV){var fQ=fV&&fV.top!=null?Math.max(0,fV.top):fP.scroller.scrollTop;fQ=Math.floor(fQ-eH(fP));var fN=fV&&fV.bottom!=null?fV.bottom:fQ+fP.wrapper.clientHeight;var fR=bw(fT,fQ),fS=bw(fT,fN);if(fV&&fV.ensure){var fO=fV.ensure.from.line,fU=fV.ensure.to.line;if(fO<fR){return{from:fO,to:bw(fT,bC(eO(fT,fO))+fP.wrapper.clientHeight)}}if(Math.min(fU,fT.lastLine())>=fS){return{from:bw(fT,bC(eO(fT,fU))-fP.wrapper.clientHeight),to:fU}}}return{from:fR,to:Math.max(fS,fR+1)}}function eh(fV){var fT=fV.display,fU=fT.view;if(!fT.alignWidgets&&(!fT.gutters.firstChild||!fV.options.fixedGutter)){return}var fR=dz(fT)-fT.scroller.scrollLeft+fV.doc.scrollLeft;var fN=fT.gutters.offsetWidth,fO=fR+"px";for(var fQ=0;fQ<fU.length;fQ++){if(!fU[fQ].hidden){if(fV.options.fixedGutter&&fU[fQ].gutter){fU[fQ].gutter.style.left=fO}var fS=fU[fQ].alignable;if(fS){for(var fP=0;fP<fS.length;fP++){fS[fP].style.left=fO}}}}if(fV.options.fixedGutter){fT.gutters.style.left=(fR+fN)+"px"}}function dH(fN){if(!fN.options.lineNumbers){return false}var fS=fN.doc,fO=d3(fN.options,fS.first+fS.size-1),fR=fN.display;if(fO.length!=fR.lineNumChars){var fT=fR.measure.appendChild(fw("div",[fw("div",fO)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var fP=fT.firstChild.offsetWidth,fQ=fT.offsetWidth-fP;fR.lineGutter.style.width="";fR.lineNumInnerWidth=Math.max(fP,fR.lineGutter.offsetWidth-fQ);fR.lineNumWidth=fR.lineNumInnerWidth+fQ;fR.lineNumChars=fR.lineNumInnerWidth?fO.length:-1;fR.lineGutter.style.width=fR.lineNumWidth+"px";cM(fN);return true}return false}function d3(fN,fO){return String(fN.lineNumberFormatter(fO+fN.firstLineNumber))}function dz(fN){return fN.scroller.getBoundingClientRect().left-fN.sizer.getBoundingClientRect().left}function dn(fS,fV,fW){var fU=fS.display.viewFrom,fT=fS.display.viewTo,fQ;var fN=bU(fS.display,fS.doc,fV);for(var fP=true;;fP=false){var fO=fS.display.scroller.clientWidth;if(!cY(fS,fN,fW)){break}fQ=true;if(fS.display.maxLineChanged&&!fS.options.lineWrapping){b(fS)}var fR=de(fS);bs(fS);dd(fS,fR);eA(fS,fR);if(cI&&fS.options.lineWrapping){fz(fS,fR)}if(cI&&fR.scrollWidth>fR.clientWidth&&fR.scrollWidth<fR.clientWidth+1&&!cB(fS)){eA(fS)}if(fP&&fS.options.lineWrapping&&fO!=fS.display.scroller.clientWidth){fW=true;continue}fW=false;if(fV&&fV.top!=null){fV={top:Math.min(fR.docHeight-bb-fR.clientHeight,fV.top)}}fN=bU(fS.display,fS.doc,fV);if(fN.from>=fS.display.viewFrom&&fN.to<=fS.display.viewTo){break}}fS.display.updateLineNumbers=null;if(fQ){ad(fS,"update",fS);if(fS.display.viewFrom!=fU||fS.display.viewTo!=fT){ad(fS,"viewportChange",fS,fS.display.viewFrom,fS.display.viewTo)}}return fQ}function cY(fX,fP,fY){var fR=fX.display,fW=fX.doc;if(!fR.wrapper.offsetWidth){d8(fX);return}if(!fY&&fP.from>=fR.viewFrom&&fP.to<=fR.viewTo&&(fR.updateLineNumbers==null||fR.updateLineNumbers>=fR.viewTo)&&cT(fX)==0){return}if(dH(fX)){d8(fX)}var fV=eL(fX);var fQ=fW.first+fW.size;var fU=Math.max(fP.from-fX.options.viewportMargin,fW.first);var fT=Math.min(fQ,fP.to+fX.options.viewportMargin);if(fR.viewFrom<fU&&fU-fR.viewFrom<20){fU=Math.max(fW.first,fR.viewFrom)}if(fR.viewTo>fT&&fR.viewTo-fT<20){fT=Math.min(fQ,fR.viewTo)}if(aY){fU=aN(fX.doc,fU);fT=dF(fX.doc,fT)}var fO=fU!=fR.viewFrom||fT!=fR.viewTo||fR.lastSizeC!=fR.wrapper.clientHeight;cC(fX,fU,fT);fR.viewOffset=bC(eO(fX.doc,fR.viewFrom));fX.display.mover.style.top=fR.viewOffset+"px";var fN=cT(fX);if(!fO&&fN==0&&!fY){return}var fS=dr();if(fN>4){fR.lineDiv.style.display="none"}ca(fX,fR.updateLineNumbers,fV);if(fN>4){fR.lineDiv.style.display=""}if(fS&&dr()!=fS&&fS.offsetHeight){fS.focus()}dD(fR.cursorDiv);dD(fR.selectionDiv);if(fO){fR.lastSizeC=fR.wrapper.clientHeight;dQ(fX,400)}a0(fX);return true}function b(fN){var fR=fN.display;var fP=dS(fN,fR.maxLine,fR.maxLine.text.length).left;fR.maxLineChanged=false;var fO=Math.max(0,fP+3);var fQ=Math.max(0,fR.sizer.offsetLeft+fO+bb-fR.scroller.clientWidth);fR.sizer.style.minWidth=fO+"px";if(fQ<fN.doc.scrollLeft){bu(fN,Math.min(fR.scroller.scrollLeft,fQ),true)}}function dd(fN,fO){fN.display.sizer.style.minHeight=fN.display.heightForcer.style.top=fO.docHeight+"px";fN.display.gutters.style.height=Math.max(fO.docHeight,fO.clientHeight-bb)+"px"}function fz(fN,fO){if(fN.display.sizer.offsetWidth+fN.display.gutters.offsetWidth<fN.display.scroller.clientWidth-1){fN.display.sizer.style.minHeight=fN.display.heightForcer.style.top="0px";fN.display.gutters.style.height=fO.docHeight+"px"}}function a0(fU){var fS=fU.display;var fO=fS.lineDiv.offsetTop;for(var fP=0;fP<fS.view.length;fP++){var fV=fS.view[fP],fW;if(fV.hidden){continue}if(dm&&m<8){var fR=fV.node.offsetTop+fV.node.offsetHeight;fW=fR-fO;fO=fR}else{var fQ=fV.node.getBoundingClientRect();fW=fQ.bottom-fQ.top}var fT=fV.line.height-fW;if(fW<2){fW=aO(fS)}if(fT>0.001||fT<-0.001){fA(fV.line,fW);bZ(fV.line);if(fV.rest){for(var fN=0;fN<fV.rest.length;fN++){bZ(fV.rest[fN])}}}}}function bZ(fN){if(fN.widgets){for(var fO=0;fO<fN.widgets.length;++fO){fN.widgets[fO].height=fN.widgets[fO].node.offsetHeight}}}function eL(fN){var fR=fN.display,fQ={},fP={};for(var fS=fR.gutters.firstChild,fO=0;fS;fS=fS.nextSibling,++fO){fQ[fN.options.gutters[fO]]=fS.offsetLeft;fP[fN.options.gutters[fO]]=fS.offsetWidth}return{fixedPos:dz(fR),gutterTotalWidth:fR.gutters.offsetWidth,gutterLeft:fQ,gutterWidth:fP,wrapperWidth:fR.wrapper.clientWidth}}function ca(fY,fP,fX){var fU=fY.display,f0=fY.options.lineNumbers;var fN=fU.lineDiv,fZ=fN.firstChild;function fT(f2){var f1=f2.nextSibling;if(cI&&bV&&fY.display.currentWheelTarget==f2){f2.style.display="none"}else{f2.parentNode.removeChild(f2)}return f1}var fV=fU.view,fS=fU.viewFrom;for(var fQ=0;fQ<fV.length;fQ++){var fR=fV[fQ];if(fR.hidden){}else{if(!fR.node){var fO=aB(fY,fR,fS,fX);fN.insertBefore(fO,fZ)}else{while(fZ!=fR.node){fZ=fT(fZ)}var fW=f0&&fP!=null&&fP<=fS&&fR.lineNumber;if(fR.changes){if(c0(fR.changes,"gutter")>-1){fW=false}aa(fY,fR,fS,fX)}if(fW){dD(fR.lineNumber);fR.lineNumber.appendChild(document.createTextNode(d3(fY.options,fS)))}fZ=fR.node.nextSibling}}fS+=fR.size}while(fZ){fZ=fT(fZ)}}function aa(fN,fP,fR,fS){for(var fO=0;fO<fP.changes.length;fO++){var fQ=fP.changes[fO];if(fQ=="text"){eU(fN,fP)}else{if(fQ=="gutter"){cX(fN,fP,fR,fS)}else{if(fQ=="class"){dk(fP)}else{if(fQ=="widget"){am(fP,fS)}}}}}fP.changes=null}function fi(fN){if(fN.node==fN.text){fN.node=fw("div",null,null,"position: relative");if(fN.text.parentNode){fN.text.parentNode.replaceChild(fN.node,fN.text)}fN.node.appendChild(fN.text);if(dm&&m<8){fN.node.style.zIndex=2}}return fN.node}function d5(fO){var fN=fO.bgClass?fO.bgClass+" "+(fO.line.bgClass||""):fO.line.bgClass;if(fN){fN+=" CodeMirror-linebackground"}if(fO.background){if(fN){fO.background.className=fN}else{fO.background.parentNode.removeChild(fO.background);fO.background=null}}else{if(fN){var fP=fi(fO);fO.background=fP.insertBefore(fw("div",null,fN),fP.firstChild)}}}function dx(fN,fO){var fP=fN.display.externalMeasured;if(fP&&fP.line==fO.line){fN.display.externalMeasured=null;fO.measure=fP.measure;return fP.built}return eu(fN,fO)}function eU(fN,fQ){var fO=fQ.text.className;var fP=dx(fN,fQ);if(fQ.text==fQ.node){fQ.node=fP.pre}fQ.text.parentNode.replaceChild(fP.pre,fQ.text);fQ.text=fP.pre;if(fP.bgClass!=fQ.bgClass||fP.textClass!=fQ.textClass){fQ.bgClass=fP.bgClass;fQ.textClass=fP.textClass;dk(fQ)}else{if(fO){fQ.text.className=fO}}}function dk(fO){d5(fO);if(fO.line.wrapClass){fi(fO).className=fO.line.wrapClass}else{if(fO.node!=fO.text){fO.node.className=""}}var fN=fO.textClass?fO.textClass+" "+(fO.line.textClass||""):fO.line.textClass;fO.text.className=fN||""}function cX(fV,fT,fS,fU){if(fT.gutter){fT.node.removeChild(fT.gutter);fT.gutter=null}var fQ=fT.line.gutterMarkers;if(fV.options.lineNumbers||fQ){var fO=fi(fT);var fR=fT.gutter=fO.insertBefore(fw("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(fV.options.fixedGutter?fU.fixedPos:-fU.gutterTotalWidth)+"px"),fT.text);if(fV.options.lineNumbers&&(!fQ||!fQ["CodeMirror-linenumbers"])){fT.lineNumber=fR.appendChild(fw("div",d3(fV.options,fS),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+fU.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+fV.display.lineNumInnerWidth+"px"))}if(fQ){for(var fP=0;fP<fV.options.gutters.length;++fP){var fN=fV.options.gutters[fP],fW=fQ.hasOwnProperty(fN)&&fQ[fN];if(fW){fR.appendChild(fw("div",[fW],"CodeMirror-gutter-elt","left: "+fU.gutterLeft[fN]+"px; width: "+fU.gutterWidth[fN]+"px"))}}}}}function am(fN,fQ){if(fN.alignable){fN.alignable=null}for(var fP=fN.node.firstChild,fO;fP;fP=fO){var fO=fP.nextSibling;if(fP.className=="CodeMirror-linewidget"){fN.node.removeChild(fP)}}e3(fN,fQ)}function aB(fN,fP,fQ,fR){var fO=dx(fN,fP);fP.text=fP.node=fO.pre;if(fO.bgClass){fP.bgClass=fO.bgClass}if(fO.textClass){fP.textClass=fO.textClass}dk(fP);cX(fN,fP,fQ,fR);e3(fP,fR);return fP.node}function e3(fO,fP){fB(fO.line,fO,fP,true);if(fO.rest){for(var fN=0;fN<fO.rest.length;fN++){fB(fO.rest[fN],fO,fP,false)}}}function fB(fV,fS,fU,fQ){if(!fV.widgets){return}var fN=fi(fS);for(var fP=0,fT=fV.widgets;fP<fT.length;++fP){var fR=fT[fP],fO=fw("div",[fR.node],"CodeMirror-linewidget");if(!fR.handleMouseEvents){fO.ignoreEvents=true}bv(fR,fO,fS,fU);if(fQ&&fR.above){fN.insertBefore(fO,fS.gutter||fS.text)}else{fN.appendChild(fO)}ad(fR,"redraw")}}function bv(fQ,fP,fN,fR){if(fQ.noHScroll){(fN.alignable||(fN.alignable=[])).push(fP);var fO=fR.wrapperWidth;fP.style.left=fR.fixedPos+"px";if(!fQ.coverGutter){fO-=fR.gutterTotalWidth;fP.style.paddingLeft=fR.gutterTotalWidth+"px"}fP.style.width=fO+"px"}if(fQ.coverGutter){fP.style.zIndex=5;fP.style.position="relative";if(!fQ.noHScroll){fP.style.marginLeft=-fR.gutterTotalWidth+"px"}}}var X=J.Pos=function(fN,fO){if(!(this instanceof X)){return new X(fN,fO)}this.line=fN;this.ch=fO};var b3=J.cmpPos=function(fO,fN){return fO.line-fN.line||fO.ch-fN.ch};function b7(fN){return X(fN.line,fN.ch)}function bo(fO,fN){return b3(fO,fN)<0?fN:fO}function an(fO,fN){return b3(fO,fN)<0?fO:fN}function fx(fN,fO){this.ranges=fN;this.primIndex=fO}fx.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(fN){if(fN==this){return true}if(fN.primIndex!=this.primIndex||fN.ranges.length!=this.ranges.length){return false}for(var fP=0;fP<this.ranges.length;fP++){var fO=this.ranges[fP],fQ=fN.ranges[fP];if(b3(fO.anchor,fQ.anchor)!=0||b3(fO.head,fQ.head)!=0){return false}}return true},deepCopy:function(){for(var fN=[],fO=0;fO<this.ranges.length;fO++){fN[fO]=new dA(b7(this.ranges[fO].anchor),b7(this.ranges[fO].head))}return new fx(fN,this.primIndex)},somethingSelected:function(){for(var fN=0;fN<this.ranges.length;fN++){if(!this.ranges[fN].empty()){return true}}return false},contains:function(fQ,fN){if(!fN){fN=fQ}for(var fP=0;fP<this.ranges.length;fP++){var fO=this.ranges[fP];if(b3(fN,fO.from())>=0&&b3(fQ,fO.to())<=0){return fP}}return -1}};function dA(fN,fO){this.anchor=fN;this.head=fO}dA.prototype={from:function(){return an(this.anchor,this.head)},to:function(){return bo(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function ck(fN,fU){var fP=fN[fU];fN.sort(function(fX,fW){return b3(fX.from(),fW.from())});fU=c0(fN,fP);for(var fR=1;fR<fN.length;fR++){var fV=fN[fR],fO=fN[fR-1];if(b3(fO.to(),fV.from())>=0){var fS=an(fO.from(),fV.from()),fT=bo(fO.to(),fV.to());var fQ=fO.empty()?fV.from()==fV.head:fO.from()==fO.head;if(fR<=fU){--fU}fN.splice(--fR,2,new dA(fQ?fT:fS,fQ?fS:fT))}}return new fx(fN,fU)}function et(fN,fO){return new fx([new dA(fN,fO||fN)],0)}function cN(fN,fO){return Math.max(fN.first,Math.min(fO,fN.first+fN.size-1))}function fj(fO,fP){if(fP.line<fO.first){return X(fO.first,0)}var fN=fO.first+fO.size-1;if(fP.line>fN){return X(fN,eO(fO,fN).text.length)}return e2(fP,eO(fO,fP.line).text.length)}function e2(fP,fO){var fN=fP.ch;if(fN==null||fN>fO){return X(fP.line,fO)}else{if(fN<0){return X(fP.line,0)}else{return fP}}}function bX(fO,fN){return fN>=fO.first&&fN<fO.first+fO.size}function dB(fP,fQ){for(var fN=[],fO=0;fO<fQ.length;fO++){fN[fO]=fj(fP,fQ[fO])}return fN}function e5(fS,fO,fR,fN){if(fS.cm&&fS.cm.display.shift||fS.extend){var fQ=fO.anchor;if(fN){var fP=b3(fR,fQ)<0;if(fP!=(b3(fN,fQ)<0)){fQ=fR;fR=fN}else{if(fP!=(b3(fR,fN)<0)){fR=fN}}}return new dA(fQ,fR)}else{return new dA(fN||fR,fR)}}function ft(fQ,fP,fN,fO){bK(fQ,new fx([e5(fQ,fQ.sel.primary(),fP,fN)],0),fO)}function au(fS,fR,fP){for(var fO=[],fQ=0;fQ<fS.sel.ranges.length;fQ++){fO[fQ]=e5(fS,fS.sel.ranges[fQ],fR[fQ],null)}var fN=ck(fO,fS.sel.primIndex);bK(fS,fN,fP)}function f(fR,fQ,fO,fP){var fN=fR.sel.ranges.slice(0);fN[fQ]=fO;bK(fR,ck(fN,fR.sel.primIndex),fP)}function H(fQ,fO,fP,fN){bK(fQ,et(fO,fP),fN)}function d(fP,fN){var fO={ranges:fN.ranges,update:function(fQ){this.ranges=[];for(var fR=0;fR<fQ.length;fR++){this.ranges[fR]=new dA(fj(fP,fQ[fR].anchor),fj(fP,fQ[fR].head))}}};aA(fP,"beforeSelectionChange",fP,fO);if(fP.cm){aA(fP.cm,"beforeSelectionChange",fP.cm,fO)}if(fO.ranges!=fN.ranges){return ck(fO.ranges,fO.ranges.length-1)}else{return fN}}function eG(fR,fQ,fO){var fN=fR.history.done,fP=fh(fN);if(fP&&fP.ranges){fN[fN.length-1]=fQ;d0(fR,fQ,fO)}else{bK(fR,fQ,fO)}}function bK(fP,fO,fN){d0(fP,fO,fN);fG(fP,fP.sel,fP.cm?fP.cm.curOp.id:NaN,fN)}function d0(fQ,fP,fO){if(eR(fQ,"beforeSelectionChange")||fQ.cm&&eR(fQ.cm,"beforeSelectionChange")){fP=d(fQ,fP)}var fN=fO&&fO.bias||(b3(fP.primary().head,fQ.sel.primary().head)<0?-1:1);cR(fQ,p(fQ,fP,fN,true));if(!(fO&&fO.scroll===false)&&fQ.cm){fg(fQ.cm)}}function cR(fO,fN){if(fN.equals(fO.sel)){return}fO.sel=fN;if(fO.cm){fO.cm.curOp.updateInput=fO.cm.curOp.selectionChanged=true;W(fO.cm)}ad(fO,"cursorActivity",fO)}function d9(fN){cR(fN,p(fN,fN.sel,null,false),Z)}function p(fV,fN,fS,fT){var fP;for(var fQ=0;fQ<fN.ranges.length;fQ++){var fR=fN.ranges[fQ];var fU=bL(fV,fR.anchor,fS,fT);var fO=bL(fV,fR.head,fS,fT);if(fP||fU!=fR.anchor||fO!=fR.head){if(!fP){fP=fN.ranges.slice(0,fQ)}fP[fQ]=new dA(fU,fO)}}return fP?ck(fP,fN.primIndex):fN}function bL(fW,fV,fS,fT){var fX=false,fP=fV;var fQ=fS||1;fW.cantEdit=false;search:for(;;){var fY=eO(fW,fP.line);if(fY.markedSpans){for(var fR=0;fR<fY.markedSpans.length;++fR){var fN=fY.markedSpans[fR],fO=fN.marker;if((fN.from==null||(fO.inclusiveLeft?fN.from<=fP.ch:fN.from<fP.ch))&&(fN.to==null||(fO.inclusiveRight?fN.to>=fP.ch:fN.to>fP.ch))){if(fT){aA(fO,"beforeCursorEnter");if(fO.explicitlyCleared){if(!fY.markedSpans){break}else{--fR;continue}}}if(!fO.atomic){continue}var fU=fO.find(fQ<0?-1:1);if(b3(fU,fP)==0){fU.ch+=fQ;if(fU.ch<0){if(fU.line>fW.first){fU=fj(fW,X(fU.line-1))}else{fU=null}}else{if(fU.ch>fY.text.length){if(fU.line<fW.first+fW.size-1){fU=X(fU.line+1,0)}else{fU=null}}}if(!fU){if(fX){if(!fT){return bL(fW,fV,fS,true)}fW.cantEdit=true;return X(fW.first,0)}fX=true;fU=fV;fQ=-fQ}}fP=fU;continue search}}}return fP}}function bs(fZ){var fU=fZ.display,fY=fZ.doc;var fW=document.createDocumentFragment();var fQ=document.createDocumentFragment();for(var fS=0;fS<fY.sel.ranges.length;fS++){var fT=fY.sel.ranges[fS];var fR=fT.empty();if(fR||fZ.options.showCursorWhenSelecting){C(fZ,fT,fW)}if(!fR){bt(fZ,fT,fQ)}}if(fZ.options.moveInputWithCursor){var fV=dw(fZ,fY.sel.primary().head,"div");var fN=fU.wrapper.getBoundingClientRect(),fP=fU.lineDiv.getBoundingClientRect();var fX=Math.max(0,Math.min(fU.wrapper.clientHeight-10,fV.top+fP.top-fN.top));var fO=Math.max(0,Math.min(fU.wrapper.clientWidth-10,fV.left+fP.left-fN.left));fU.inputDiv.style.top=fX+"px";fU.inputDiv.style.left=fO+"px"}bH(fU.cursorDiv,fW);bH(fU.selectionDiv,fQ)}function C(fN,fQ,fP){var fS=dw(fN,fQ.head,"div",null,null,!fN.options.singleCursorHeightPerLine);var fR=fP.appendChild(fw("div","\u00a0","CodeMirror-cursor"));fR.style.left=fS.left+"px";fR.style.top=fS.top+"px";fR.style.height=Math.max(0,fS.bottom-fS.top)*fN.options.cursorHeight+"px";if(fS.other){var fO=fP.appendChild(fw("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));fO.style.display="";fO.style.left=fS.other.left+"px";fO.style.top=fS.other.top+"px";fO.style.height=(fS.other.bottom-fS.other.top)*0.85+"px"}}function bt(fR,fX,fS){var f0=fR.display,f4=fR.doc;var fN=document.createDocumentFragment();var fW=eF(fR.display),fQ=fW.left,f1=f0.lineSpace.offsetWidth-fW.right;function fY(f8,f7,f6,f5){if(f7<0){f7=0}f7=Math.round(f7);f5=Math.round(f5);fN.appendChild(fw("div",null,"CodeMirror-selected","position: absolute; left: "+f8+"px; top: "+f7+"px; width: "+(f6==null?f1-f8:f6)+"px; height: "+(f5-f7)+"px"))}function fO(f6,f8,gb){var f7=eO(f4,f6);var f9=f7.text.length;var gc,f5;function ga(ge,gd){return cv(fR,X(f6,ge),"div",f7,gd)}dG(a(f7),f8||0,gb==null?f9:gb,function(gk,gj,gd){var gg=ga(gk,"left"),gh,gi,gf;if(gk==gj){gh=gg;gi=gf=gg.left}else{gh=ga(gj-1,"right");if(gd=="rtl"){var ge=gg;gg=gh;gh=ge}gi=gg.left;gf=gh.right}if(f8==null&&gk==0){gi=fQ}if(gh.top-gg.top>3){fY(gi,gg.top,null,gg.bottom);gi=fQ;if(gg.bottom<gh.top){fY(gi,gg.bottom,null,gh.top)}}if(gb==null&&gj==f9){gf=f1}if(!gc||gg.top<gc.top||gg.top==gc.top&&gg.left<gc.left){gc=gg}if(!f5||gh.bottom>f5.bottom||gh.bottom==f5.bottom&&gh.right>f5.right){f5=gh}if(gi<fQ+1){gi=fQ}fY(gi,gh.top,gf-gi,gh.bottom)});return{start:gc,end:f5}}var f3=fX.from(),f2=fX.to();if(f3.line==f2.line){fO(f3.line,f3.ch,f2.ch)}else{var fP=eO(f4,f3.line),fU=eO(f4,f2.line);var fT=A(fP)==A(fU);var fV=fO(f3.line,f3.ch,fT?fP.text.length+1:null).end;var fZ=fO(f2.line,fT?0:null,f2.ch).start;if(fT){if(fV.top<fZ.top-2){fY(fV.right,fV.top,null,fV.bottom);fY(fQ,fZ.top,fZ.left,fZ.bottom)}else{fY(fV.right,fV.top,fZ.left-fV.right,fV.bottom)}}if(fV.bottom<fZ.top){fY(fQ,fV.bottom,null,fZ.top)}}fS.appendChild(fN)}function q(fN){if(!fN.state.focused){return}var fP=fN.display;clearInterval(fP.blinker);var fO=true;fP.cursorDiv.style.visibility="";if(fN.options.cursorBlinkRate>0){fP.blinker=setInterval(function(){fP.cursorDiv.style.visibility=(fO=!fO)?"":"hidden"},fN.options.cursorBlinkRate)}else{if(fN.options.cursorBlinkRate<0){fP.cursorDiv.style.visibility="hidden"}}}function dQ(fN,fO){if(fN.doc.mode.startState&&fN.doc.frontier<fN.display.viewTo){fN.state.highlight.set(fO,cj(cA,fN))}}function cA(fN){var fQ=fN.doc;if(fQ.frontier<fQ.first){fQ.frontier=fQ.first}if(fQ.frontier>=fN.display.viewTo){return}var fO=+new Date+fN.options.workTime;var fP=bS(fQ.mode,df(fN,fQ.frontier));cx(fN,function(){fQ.iter(fQ.frontier,Math.min(fQ.first+fQ.size,fN.display.viewTo+500),function(fR){if(fQ.frontier>=fN.display.viewFrom){var fU=fR.styles;var fW=e9(fN,fR,fP,true);fR.styles=fW.styles;var fT=fR.styleClasses,fV=fW.classes;if(fV){fR.styleClasses=fV}else{if(fT){fR.styleClasses=null}}var fX=!fU||fU.length!=fR.styles.length||fT!=fV&&(!fT||!fV||fT.bgClass!=fV.bgClass||fT.textClass!=fV.textClass);for(var fS=0;!fX&&fS<fU.length;++fS){fX=fU[fS]!=fR.styles[fS]}if(fX){S(fN,fQ.frontier,"text")}fR.stateAfter=bS(fQ.mode,fP)}else{db(fN,fR.text,fP);fR.stateAfter=fQ.frontier%5==0?bS(fQ.mode,fP):null}++fQ.frontier;if(+new Date>fO){dQ(fN,fN.options.workDelay);return true}})})}function cm(fT,fN,fQ){var fO,fR,fS=fT.doc;var fP=fQ?-1:fN-(fT.doc.mode.innerMode?1000:100);for(var fW=fN;fW>fP;--fW){if(fW<=fS.first){return fS.first}var fV=eO(fS,fW-1);if(fV.stateAfter&&(!fQ||fW<=fS.frontier)){return fW}var fU=bJ(fV.text,null,fT.options.tabSize);if(fR==null||fO>fU){fR=fW-1;fO=fU}}return fR}function df(fN,fT,fO){var fR=fN.doc,fQ=fN.display;if(!fR.mode.startState){return true}var fS=cm(fN,fT,fO),fP=fS>fR.first&&eO(fR,fS-1).stateAfter;if(!fP){fP=bQ(fR.mode)}else{fP=bS(fR.mode,fP)}fR.iter(fS,fT,function(fU){db(fN,fU.text,fP);var fV=fS==fT-1||fS%5==0||fS>=fQ.viewFrom&&fS<fQ.viewTo;fU.stateAfter=fV?bS(fR.mode,fP):null;++fS});if(fO){fR.frontier=fS}return fP}function eH(fN){return fN.lineSpace.offsetTop}function by(fN){return fN.mover.offsetHeight-fN.lineSpace.offsetHeight}function eF(fQ){if(fQ.cachedPaddingH){return fQ.cachedPaddingH}var fP=bH(fQ.measure,fw("pre","x"));var fN=window.getComputedStyle?window.getComputedStyle(fP):fP.currentStyle;var fO={left:parseInt(fN.paddingLeft),right:parseInt(fN.paddingRight)};if(!isNaN(fO.left)&&!isNaN(fO.right)){fQ.cachedPaddingH=fO}return fO}function b6(fU,fQ,fT){var fP=fU.options.lineWrapping;var fR=fP&&fU.display.scroller.clientWidth;if(!fQ.measure.heights||fP&&fQ.measure.width!=fR){var fS=fQ.measure.heights=[];if(fP){fQ.measure.width=fR;var fW=fQ.text.firstChild.getClientRects();for(var fN=0;fN<fW.length-1;fN++){var fV=fW[fN],fO=fW[fN+1];if(Math.abs(fV.bottom-fO.bottom)>2){fS.push((fV.bottom+fO.top)/2-fT.top)}}}fS.push(fT.bottom-fT.top)}}function ch(fP,fN,fQ){if(fP.line==fN){return{map:fP.measure.map,cache:fP.measure.cache}}for(var fO=0;fO<fP.rest.length;fO++){if(fP.rest[fO]==fN){return{map:fP.measure.maps[fO],cache:fP.measure.caches[fO]}}}for(var fO=0;fO<fP.rest.length;fO++){if(bD(fP.rest[fO])>fQ){return{map:fP.measure.maps[fO],cache:fP.measure.caches[fO],before:true}}}}function cJ(fN,fP){fP=A(fP);var fR=bD(fP);var fO=fN.display.externalMeasured=new bm(fN.doc,fP,fR);fO.lineN=fR;var fQ=fO.built=eu(fN,fO);fO.text=fQ.pre;bH(fN.display.lineMeasure,fQ.pre);return fO}function dS(fN,fO,fQ,fP){return E(fN,aV(fN,fO),fQ,fP)}function eK(fN,fP){if(fP>=fN.display.viewFrom&&fP<fN.display.viewTo){return fN.display.view[c6(fN,fP)]}var fO=fN.display.externalMeasured;if(fO&&fP>=fO.lineN&&fP<fO.lineN+fO.size){return fO}}function aV(fN,fP){var fQ=bD(fP);var fO=eK(fN,fQ);if(fO&&!fO.text){fO=null}else{if(fO&&fO.changes){aa(fN,fO,fQ,eL(fN))}}if(!fO){fO=cJ(fN,fP)}var fR=ch(fO,fP,fQ);return{line:fP,view:fO,rect:null,map:fR.map,cache:fR.cache,before:fR.before,hasHeights:false}}function E(fN,fT,fR,fO,fQ){if(fT.before){fR=-1}var fP=fR+(fO||""),fS;if(fT.cache.hasOwnProperty(fP)){fS=fT.cache[fP]}else{if(!fT.rect){fT.rect=fT.view.text.getBoundingClientRect()}if(!fT.hasHeights){b6(fN,fT.view,fT.rect);fT.hasHeights=true}fS=k(fN,fT,fR,fO);if(!fS.bogus){fT.cache[fP]=fS}}return{left:fS.left,right:fS.right,top:fQ?fS.rtop:fS.top,bottom:fQ?fS.rbottom:fS.bottom}}var ed={left:0,right:0,top:0,bottom:0};function k(fU,f4,fW,fS){var f8=f4.map;var f1,fR,fQ,fN;for(var f3=0;f3<f8.length;f3+=3){var f6=f8[f3],f2=f8[f3+1];if(fW<f6){fR=0;fQ=1;fN="left"}else{if(fW<f2){fR=fW-f6;fQ=fR+1}else{if(f3==f8.length-3||fW==f2&&f8[f3+3]>fW){fQ=f2-f6;fR=fQ-1;if(fW>=f2){fN="right"}}}}if(fR!=null){f1=f8[f3+2];if(f6==f2&&fS==(f1.insertLeft?"left":"right")){fN=fS}if(fS=="left"&&fR==0){while(f3&&f8[f3-2]==f8[f3-3]&&f8[f3-1].insertLeft){f1=f8[(f3-=3)+2];fN="left"}}if(fS=="right"&&fR==f2-f6){while(f3<f8.length-3&&f8[f3+3]==f8[f3+4]&&!f8[f3+5].insertLeft){f1=f8[(f3+=3)+2];fN="right"}}break}}var fO;if(f1.nodeType==3){while(fR&&eZ(f4.line.text.charAt(f6+fR))){--fR}while(f6+fQ<f2&&eZ(f4.line.text.charAt(f6+fQ))){++fQ}if(dm&&m<9&&fR==0&&fQ==f2-f6){fO=f1.parentNode.getBoundingClientRect()}else{if(dm&&fU.options.lineWrapping){var fP=b9(f1,fR,fQ).getClientRects();if(fP.length){fO=fP[fS=="right"?fP.length-1:0]}else{fO=ed}}else{fO=b9(f1,fR,fQ).getBoundingClientRect()||ed}}}else{if(fR>0){fN=fS="right"}var fP;if(fU.options.lineWrapping&&(fP=f1.getClientRects()).length>1){fO=fP[fS=="right"?fP.length-1:0]}else{fO=f1.getBoundingClientRect()}}if(dm&&m<9&&!fR&&(!fO||!fO.left&&!fO.right)){var fT=f1.parentNode.getClientRects()[0];if(fT){fO={left:fT.left,right:fT.left+dh(fU.display),top:fT.top,bottom:fT.bottom}}else{fO=ed}}var fZ=fO.top-f4.rect.top,fX=fO.bottom-f4.rect.top;var f7=(fZ+fX)/2;var f5=f4.view.measure.heights;for(var f3=0;f3<f5.length-1;f3++){if(f7<f5[f3]){break}}var f0=f3?f5[f3-1]:0,fY=f5[f3];var fV={left:(fN=="right"?fO.right:fO.left)-f4.rect.left,right:(fN=="left"?fO.left:fO.right)-f4.rect.left,top:f0,bottom:fY};if(!fO.left&&!fO.right){fV.bogus=true}if(!fU.options.singleCursorHeightPerLine){fV.rtop=fZ;fV.rbottom=fX}return fV}function aq(fO){if(fO.measure){fO.measure.cache={};fO.measure.heights=null;if(fO.rest){for(var fN=0;fN<fO.rest.length;fN++){fO.measure.caches[fN]={}}}}}function aG(fN){fN.display.externalMeasure=null;dD(fN.display.lineMeasure);for(var fO=0;fO<fN.display.view.length;fO++){aq(fN.display.view[fO])}}function aj(fN){aG(fN);fN.display.cachedCharWidth=fN.display.cachedTextHeight=fN.display.cachedPaddingH=null;if(!fN.options.lineWrapping){fN.display.maxLineChanged=true}fN.display.lineNumChars=null}function ci(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cg(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function es(fT,fQ,fS,fO){if(fQ.widgets){for(var fP=0;fP<fQ.widgets.length;++fP){if(fQ.widgets[fP].above){var fV=cG(fQ.widgets[fP]);fS.top+=fV;fS.bottom+=fV}}}if(fO=="line"){return fS}if(!fO){fO="local"}var fR=bC(fQ);if(fO=="local"){fR+=eH(fT.display)}else{fR-=fT.display.viewOffset}if(fO=="page"||fO=="window"){var fN=fT.display.lineSpace.getBoundingClientRect();fR+=fN.top+(fO=="window"?0:cg());var fU=fN.left+(fO=="window"?0:ci());fS.left+=fU;fS.right+=fU}fS.top+=fR;fS.bottom+=fR;return fS}function fJ(fO,fR,fP){if(fP=="div"){return fR}var fT=fR.left,fS=fR.top;if(fP=="page"){fT-=ci();fS-=cg()}else{if(fP=="local"||!fP){var fQ=fO.display.sizer.getBoundingClientRect();fT+=fQ.left;fS+=fQ.top}}var fN=fO.display.lineSpace.getBoundingClientRect();return{left:fT-fN.left,top:fS-fN.top}}function cv(fN,fR,fQ,fP,fO){if(!fP){fP=eO(fN.doc,fR.line)}return es(fN,fP,dS(fN,fP,fR.ch,fO),fQ)}function dw(fW,fV,fP,fT,fY,fU){fT=fT||eO(fW.doc,fV.line);if(!fY){fY=aV(fW,fT)}function fR(f1,f0){var fZ=E(fW,fY,f1,f0?"right":"left",fU);if(f0){fZ.left=fZ.right}else{fZ.right=fZ.left}return es(fW,fT,fZ,fP)}function fX(f2,fZ){var f0=fS[fZ],f1=f0.level%2;if(f2==dc(f0)&&fZ&&f0.level<fS[fZ-1].level){f0=fS[--fZ];f2=fI(f0)-(f0.level%2?0:1);f1=true}else{if(f2==fI(f0)&&fZ<fS.length-1&&f0.level<fS[fZ+1].level){f0=fS[++fZ];f2=dc(f0)-f0.level%2;f1=false}}if(f1&&f2==f0.to&&f2>f0.from){return fR(f2-1)}return fR(f2,f1)}var fS=a(fT),fN=fV.ch;if(!fS){return fR(fN)}var fO=aC(fS,fN);var fQ=fX(fN,fO);if(eD!=null){fQ.other=fX(fN,eD)}return fQ}function dl(fN,fR){var fQ=0,fR=fj(fN.doc,fR);if(!fN.options.lineWrapping){fQ=dh(fN.display)*fR.ch}var fO=eO(fN.doc,fR.line);var fP=bC(fO)+eH(fN.display);return{left:fQ,right:fQ,top:fP,bottom:fP+fO.height}}function fv(fN,fO,fP,fR){var fQ=X(fN,fO);fQ.xRel=fR;if(fP){fQ.outside=true}return fQ}function fo(fU,fR,fQ){var fT=fU.doc;fQ+=fU.display.viewOffset;if(fQ<0){return fv(fT.first,0,true,-1)}var fP=bw(fT,fQ),fV=fT.first+fT.size-1;if(fP>fV){return fv(fT.first+fT.size-1,eO(fT,fV).text.length,true,1)}if(fR<0){fR=0}var fO=eO(fT,fP);for(;;){var fW=cH(fU,fO,fP,fR,fQ);var fS=d6(fO);var fN=fS&&fS.find(0,true);if(fS&&(fW.ch>fN.from.ch||fW.ch==fN.from.ch&&fW.xRel>0)){fP=bD(fO=fN.to.line)}else{return fW}}}function cH(fX,fP,f0,fZ,fY){var fW=fY-bC(fP);var fT=false,f6=2*fX.display.wrapper.clientWidth;var f3=aV(fX,fP);function ga(gc){var gd=dw(fX,X(f0,gc),"line",fP,f3);fT=true;if(fW>gd.bottom){return gd.left-f6}else{if(fW<gd.top){return gd.left+f6}else{fT=false}}return gd.left}var f2=a(fP),f5=fP.text.length;var f7=cr(fP),fQ=cD(fP);var f4=ga(f7),fN=fT,fO=ga(fQ),fS=fT;if(fZ>fO){return fv(f0,fQ,fS,1)}for(;;){if(f2?fQ==f7||fQ==w(fP,f7,1):fQ-f7<=1){var f1=fZ<f4||fZ-f4<=fO-fZ?f7:fQ;var f9=fZ-(f1==f7?f4:fO);while(eZ(fP.text.charAt(f1))){++f1}var fV=fv(f0,f1,f1==f7?fN:fS,f9<-1?-1:f9>1?1:0);return fV}var fU=Math.ceil(f5/2),gb=f7+fU;if(f2){gb=f7;for(var f8=0;f8<fU;++f8){gb=w(fP,gb,1)}}var fR=ga(gb);if(fR>fZ){fQ=gb;fO=fR;if(fS=fT){fO+=1000}f5=fU}else{f7=gb;f4=fR;fN=fT;f5-=fU}}}var aD;function aO(fP){if(fP.cachedTextHeight!=null){return fP.cachedTextHeight}if(aD==null){aD=fw("pre");for(var fO=0;fO<49;++fO){aD.appendChild(document.createTextNode("x"));aD.appendChild(fw("br"))}aD.appendChild(document.createTextNode("x"))}bH(fP.measure,aD);var fN=aD.offsetHeight/50;if(fN>3){fP.cachedTextHeight=fN}dD(fP.measure);return fN||1}function dh(fR){if(fR.cachedCharWidth!=null){return fR.cachedCharWidth}var fN=fw("span","xxxxxxxxxx");var fQ=fw("pre",[fN]);bH(fR.measure,fQ);var fP=fN.getBoundingClientRect(),fO=(fP.right-fP.left)/10;if(fO>2){fR.cachedCharWidth=fO}return fO||10}var dK=0;function cu(fN){fN.curOp={viewChanged:false,startHeight:fN.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++dK};if(!cf++){bf=[]}}function ak(fY){var fT=fY.curOp,fX=fY.doc,fU=fY.display;fY.curOp=null;if(fT.updateMaxLine){h(fY)}if(fT.viewChanged||fT.forceUpdate||fT.scrollTop!=null||fT.scrollToPos&&(fT.scrollToPos.from.line<fU.viewFrom||fT.scrollToPos.to.line>=fU.viewTo)||fU.maxLineChanged&&fY.options.lineWrapping){var fR=dn(fY,{top:fT.scrollTop,ensure:fT.scrollToPos},fT.forceUpdate);if(fY.display.scroller.offsetHeight){fY.doc.scrollTop=fY.display.scroller.scrollTop}}if(!fR&&fT.selectionChanged){bs(fY)}if(!fR&&fT.startHeight!=fY.doc.height){eA(fY)}if(fU.wheelStartX!=null&&(fT.scrollTop!=null||fT.scrollLeft!=null||fT.scrollToPos)){fU.wheelStartX=fU.wheelStartY=null}if(fT.scrollTop!=null&&fU.scroller.scrollTop!=fT.scrollTop){var fV=Math.max(0,Math.min(fU.scroller.scrollHeight-fU.scroller.clientHeight,fT.scrollTop));fU.scroller.scrollTop=fU.scrollbarV.scrollTop=fX.scrollTop=fV}if(fT.scrollLeft!=null&&fU.scroller.scrollLeft!=fT.scrollLeft){var fO=Math.max(0,Math.min(fU.scroller.scrollWidth-fU.scroller.clientWidth,fT.scrollLeft));fU.scroller.scrollLeft=fU.scrollbarH.scrollLeft=fX.scrollLeft=fO;eh(fY)}if(fT.scrollToPos){var fW=F(fY,fj(fY.doc,fT.scrollToPos.from),fj(fY.doc,fT.scrollToPos.to),fT.scrollToPos.margin);if(fT.scrollToPos.isCursor&&fY.state.focused){dI(fY,fW)}}if(fT.selectionChanged){q(fY)}if(fY.state.focused&&fT.updateInput){eY(fY,fT.typing)}var fS=fT.maybeHiddenMarkers,fN=fT.maybeUnhiddenMarkers;if(fS){for(var fQ=0;fQ<fS.length;++fQ){if(!fS[fQ].lines.length){aA(fS[fQ],"hide")}}}if(fN){for(var fQ=0;fQ<fN.length;++fQ){if(fN[fQ].lines.length){aA(fN[fQ],"unhide")}}}var fP;if(!--cf){fP=bf;bf=null}if(fT.changeObjs){aA(fY,"changes",fY,fT.changeObjs)}if(fP){for(var fQ=0;fQ<fP.length;++fQ){fP[fQ]()}}if(fT.cursorActivityHandlers){for(var fQ=0;fQ<fT.cursorActivityHandlers.length;fQ++){fT.cursorActivityHandlers[fQ](fY)}}}function cx(fN,fO){if(fN.curOp){return fO()}cu(fN);try{return fO()}finally{ak(fN)}}function cK(fN,fO){return function(){if(fN.curOp){return fO.apply(fN,arguments)}cu(fN);try{return fO.apply(fN,arguments)}finally{ak(fN)}}}function cQ(fN){return function(){if(this.curOp){return fN.apply(this,arguments)}cu(this);try{return fN.apply(this,arguments)}finally{ak(this)}}}function cq(fN){return function(){var fO=this.cm;if(!fO||fO.curOp){return fN.apply(this,arguments)}cu(fO);try{return fN.apply(this,arguments)}finally{ak(fO)}}}function bm(fP,fN,fO){this.line=fN;this.rest=i(fN);this.size=this.rest?bD(fh(this.rest))-fO+1:1;this.node=this.text=null;this.hidden=e6(fP,fN)}function ex(fN,fT,fS){var fR=[],fP;for(var fQ=fT;fQ<fS;fQ=fP){var fO=new bm(fN.doc,eO(fN.doc,fQ),fQ);fP=fQ+fO.size;fR.push(fO)}return fR}function ag(fU,fS,fT,fV){if(fS==null){fS=fU.doc.first}if(fT==null){fT=fU.doc.first+fU.doc.size}if(!fV){fV=0}var fP=fU.display;if(fV&&fT<fP.viewTo&&(fP.updateLineNumbers==null||fP.updateLineNumbers>fS)){fP.updateLineNumbers=fS}fU.curOp.viewChanged=true;if(fS>=fP.viewTo){if(aY&&aN(fU.doc,fS)<fP.viewTo){d8(fU)}}else{if(fT<=fP.viewFrom){if(aY&&dF(fU.doc,fT+fV)>fP.viewFrom){d8(fU)}else{fP.viewFrom+=fV;fP.viewTo+=fV}}else{if(fS<=fP.viewFrom&&fT>=fP.viewTo){d8(fU)}else{if(fS<=fP.viewFrom){var fR=cW(fU,fT,fT+fV,1);if(fR){fP.view=fP.view.slice(fR.index);fP.viewFrom=fR.lineN;fP.viewTo+=fV}else{d8(fU)}}else{if(fT>=fP.viewTo){var fR=cW(fU,fS,fS,-1);if(fR){fP.view=fP.view.slice(0,fR.index);fP.viewTo=fR.lineN}else{d8(fU)}}else{var fQ=cW(fU,fS,fS,-1);var fO=cW(fU,fT,fT+fV,1);if(fQ&&fO){fP.view=fP.view.slice(0,fQ.index).concat(ex(fU,fQ.lineN,fO.lineN)).concat(fP.view.slice(fO.index));fP.viewTo+=fV}else{d8(fU)}}}}}}var fN=fP.externalMeasured;if(fN){if(fT<fN.lineN){fN.lineN+=fV}else{if(fS<fN.lineN+fN.size){fP.externalMeasured=null}}}}function S(fO,fP,fS){fO.curOp.viewChanged=true;var fT=fO.display,fR=fO.display.externalMeasured;if(fR&&fP>=fR.lineN&&fP<fR.lineN+fR.size){fT.externalMeasured=null}if(fP<fT.viewFrom||fP>=fT.viewTo){return}var fQ=fT.view[c6(fO,fP)];if(fQ.node==null){return}var fN=fQ.changes||(fQ.changes=[]);if(c0(fN,fS)==-1){fN.push(fS)}}function d8(fN){fN.display.viewFrom=fN.display.viewTo=fN.doc.first;fN.display.view=[];fN.display.viewOffset=0}function c6(fN,fQ){if(fQ>=fN.display.viewTo){return null}fQ-=fN.display.viewFrom;if(fQ<0){return null}var fO=fN.display.view;for(var fP=0;fP<fO.length;fP++){fQ-=fO[fP].size;if(fQ<0){return fP}}}function cW(fV,fP,fR,fO){var fS=c6(fV,fP),fU,fT=fV.display.view;if(!aY||fR==fV.doc.first+fV.doc.size){return{index:fS,lineN:fR}}for(var fQ=0,fN=fV.display.viewFrom;fQ<fS;fQ++){fN+=fT[fQ].size}if(fN!=fP){if(fO>0){if(fS==fT.length-1){return null}fU=(fN+fT[fS].size)-fP;fS++}else{fU=fN-fP}fP+=fU;fR+=fU}while(aN(fV.doc,fR)!=fR){if(fS==(fO<0?0:fT.length-1)){return null}fR+=fO*fT[fS-(fO<0?1:0)].size;fS+=fO}return{index:fS,lineN:fR}}function cC(fN,fR,fQ){var fP=fN.display,fO=fP.view;if(fO.length==0||fR>=fP.viewTo||fQ<=fP.viewFrom){fP.view=ex(fN,fR,fQ);fP.viewFrom=fR}else{if(fP.viewFrom>fR){fP.view=ex(fN,fR,fP.viewFrom).concat(fP.view)}else{if(fP.viewFrom<fR){fP.view=fP.view.slice(c6(fN,fR))}}fP.viewFrom=fR;if(fP.viewTo<fQ){fP.view=fP.view.concat(ex(fN,fP.viewTo,fQ))}else{if(fP.viewTo>fQ){fP.view=fP.view.slice(0,c6(fN,fQ))}}}fP.viewTo=fQ}function cT(fN){var fO=fN.display.view,fR=0;for(var fQ=0;fQ<fO.length;fQ++){var fP=fO[fQ];if(!fP.hidden&&(!fP.node||fP.changes)){++fR}}return fR}function bd(fN){if(fN.display.pollingFast){return}fN.display.poll.set(fN.options.pollInterval,function(){b5(fN);if(fN.state.focused){bd(fN)}})}function D(fN){var fO=false;fN.display.pollingFast=true;function fP(){var fQ=b5(fN);if(!fQ&&!fO){fO=true;fN.display.poll.set(60,fP)}else{fN.display.pollingFast=false;bd(fN)}}fN.display.poll.set(20,fP)}function b5(fR){var fS=fR.display.input,fV=fR.display.prevInput,f6=fR.doc;if(!fR.state.focused||(bj(fS)&&!fV)||ai(fR)||fR.options.disableInput){return false}if(fR.state.pasteIncoming&&fR.state.fakedLastChar){fS.value=fS.value.substring(0,fS.value.length-1);fR.state.fakedLastChar=false}var fU=fS.value;if(fU==fV&&!fR.somethingSelected()){return false}if(dm&&m>=9&&fR.display.inputHasSelection===fU){eY(fR);return false}var f2=!fR.curOp;if(f2){cu(fR)}fR.display.shift=false;if(fU.charCodeAt(0)==8203&&f6.sel==fR.display.selForContextMenu&&!fV){fV="\u200b"}var f1=0,fY=Math.min(fV.length,fU.length);while(f1<fY&&fV.charCodeAt(f1)==fU.charCodeAt(f1)){++f1}var fO=fU.slice(f1),fW=aR(fO);var f5=fR.state.pasteIncoming&&fW.length>1&&f6.sel.ranges.length==fW.length;for(var f3=f6.sel.ranges.length-1;f3>=0;f3--){var fX=f6.sel.ranges[f3];var fZ=fX.from(),fN=fX.to();if(f1<fV.length){fZ=X(fZ.line,fZ.ch-(fV.length-f1))}else{if(fR.state.overwrite&&fX.empty()&&!fR.state.pasteIncoming){fN=X(fN.line,Math.min(eO(f6,fN.line).text.length,fN.ch+fh(fW).length))}}var fQ=fR.curOp.updateInput;var f4={from:fZ,to:fN,text:f5?[fW[f3]]:fW,origin:fR.state.pasteIncoming?"paste":fR.state.cutIncoming?"cut":"+input"};a6(fR.doc,f4);ad(fR,"inputRead",fR,f4);if(fO&&!fR.state.pasteIncoming&&fR.options.electricChars&&fR.options.smartIndent&&fX.head.ch<100&&(!f3||f6.sel.ranges[f3-1].head.line!=fX.head.line)){var fT=fR.getModeAt(fX.head);if(fT.electricChars){for(var f0=0;f0<fT.electricChars.length;f0++){if(fO.indexOf(fT.electricChars.charAt(f0))>-1){ac(fR,fX.head.line,"smart");break}}}else{if(fT.electricInput){var fP=cF(f4);if(fT.electricInput.test(eO(f6,fP.line).text.slice(0,fP.ch))){ac(fR,fX.head.line,"smart")}}}}}fg(fR);fR.curOp.updateInput=fQ;fR.curOp.typing=true;if(fU.length>1000||fU.indexOf("\n")>-1){fS.value=fR.display.prevInput=""}else{fR.display.prevInput=fU}if(f2){ak(fR)}fR.state.pasteIncoming=fR.state.cutIncoming=false;return true}function eY(fN,fR){var fO,fQ,fT=fN.doc;if(fN.somethingSelected()){fN.display.prevInput="";var fP=fT.sel.primary();fO=cS&&(fP.to().line-fP.from().line>100||(fQ=fN.getSelection()).length>1000);var fS=fO?"-":fQ||fN.getSelection();fN.display.input.value=fS;if(fN.state.focused){dp(fN.display.input)}if(dm&&m>=9){fN.display.inputHasSelection=fS}}else{if(!fR){fN.display.prevInput=fN.display.input.value="";if(dm&&m>=9){fN.display.inputHasSelection=null}}}fN.display.inaccurateSelection=fO}function ec(fN){if(fN.options.readOnly!="nocursor"&&(!dR||dr()!=fN.display.input)){fN.display.input.focus()}}function t(fN){if(!fN.state.focused){ec(fN);co(fN)}}function ai(fN){return fN.options.readOnly||fN.doc.cantEdit}function fp(fN){var fP=fN.display;bN(fP.scroller,"mousedown",cK(fN,d4));if(dm&&m<11){bN(fP.scroller,"dblclick",cK(fN,function(fT){if(aJ(fN,fT)){return}var fU=cb(fN,fT);if(!fU||n(fN,fT)||a1(fN.display,fT)){return}cs(fT);var fS=at(fN,fU);ft(fN.doc,fS.anchor,fS.head)}))}else{bN(fP.scroller,"dblclick",function(fS){aJ(fN,fS)||cs(fS)})}bN(fP.lineSpace,"selectstart",function(fS){if(!a1(fP,fS)){cs(fS)}});if(!fE){bN(fP.scroller,"contextmenu",function(fS){aw(fN,fS)})}bN(fP.scroller,"scroll",function(){if(fP.scroller.clientHeight){O(fN,fP.scroller.scrollTop);bu(fN,fP.scroller.scrollLeft,true);aA(fN,"scroll",fN)}});bN(fP.scrollbarV,"scroll",function(){if(fP.scroller.clientHeight){O(fN,fP.scrollbarV.scrollTop)}});bN(fP.scrollbarH,"scroll",function(){if(fP.scroller.clientHeight){bu(fN,fP.scrollbarH.scrollLeft)}});bN(fP.scroller,"mousewheel",function(fS){c(fN,fS)});bN(fP.scroller,"DOMMouseScroll",function(fS){c(fN,fS)});function fR(){if(fN.state.focused){setTimeout(cj(ec,fN),0)}}bN(fP.scrollbarH,"mousedown",fR);bN(fP.scrollbarV,"mousedown",fR);bN(fP.wrapper,"scroll",function(){fP.wrapper.scrollTop=fP.wrapper.scrollLeft=0});bN(fP.input,"keyup",cK(fN,a8));bN(fP.input,"input",function(){if(dm&&m>=9&&fN.display.inputHasSelection){fN.display.inputHasSelection=null}D(fN)});bN(fP.input,"keydown",cK(fN,r));bN(fP.input,"keypress",cK(fN,cl));bN(fP.input,"focus",cj(co,fN));bN(fP.input,"blur",cj(aM,fN));function fO(fS){if(!aJ(fN,fS)){d2(fS)}}if(fN.options.dragDrop){bN(fP.scroller,"dragstart",function(fS){R(fN,fS)});bN(fP.scroller,"dragenter",fO);bN(fP.scroller,"dragover",fO);bN(fP.scroller,"drop",cK(fN,ba))}bN(fP.scroller,"paste",function(fS){if(a1(fP,fS)){return}fN.state.pasteIncoming=true;ec(fN);D(fN)});bN(fP.input,"paste",function(){if(cI&&!fN.state.fakedLastChar&&!(new Date-fN.state.lastMiddleDown<200)){var fT=fP.input.selectionStart,fS=fP.input.selectionEnd;fP.input.value+="$";fP.input.selectionEnd=fS;fP.input.selectionStart=fT;fN.state.fakedLastChar=true}fN.state.pasteIncoming=true;D(fN)});function fQ(fW){if(fN.somethingSelected()){if(fP.inaccurateSelection){fP.prevInput="";fP.inaccurateSelection=false;fP.input.value=fN.getSelection();dp(fP.input)}}else{var fX="",fT=[];for(var fU=0;fU<fN.doc.sel.ranges.length;fU++){var fS=fN.doc.sel.ranges[fU].head.line;var fV={anchor:X(fS,0),head:X(fS+1,0)};fT.push(fV);fX+=fN.getRange(fV.anchor,fV.head)}if(fW.type=="cut"){fN.setSelections(fT,null,Z)}else{fP.prevInput="";fP.input.value=fX;dp(fP.input)}}if(fW.type=="cut"){fN.state.cutIncoming=true}}bN(fP.input,"cut",fQ);bN(fP.input,"copy",fQ);if(a2){bN(fP.sizer,"mouseup",function(){if(dr()==fP.input){fP.input.blur()}ec(fN)})}}function aL(fN){var fO=fN.display;fO.cachedCharWidth=fO.cachedTextHeight=fO.cachedPaddingH=null;fN.setSize()}function a1(fO,fN){for(var fP=M(fN);fP!=fO.wrapper;fP=fP.parentNode){if(!fP||fP.ignoreEvents||fP.parentNode==fO.sizer&&fP!=fO.mover){return true}}}function cb(fX,fR,fO,fP){var fT=fX.display;if(!fO){var fS=M(fR);if(fS==fT.scrollbarH||fS==fT.scrollbarV||fS==fT.scrollbarFiller||fS==fT.gutterFiller){return null}}var fW,fU,fN=fT.lineSpace.getBoundingClientRect();try{fW=fR.clientX-fN.left;fU=fR.clientY-fN.top}catch(fR){return null}var fV=fo(fX,fW,fU),fY;if(fP&&fV.xRel==1&&(fY=eO(fX.doc,fV.line).text).length==fV.ch){var fQ=bJ(fY,fY.length,fX.options.tabSize)-fY.length;fV=X(fV.line,Math.max(0,Math.round((fW-eF(fX.display).left)/dh(fX.display))-fQ))}return fV}function d4(fP){if(aJ(this,fP)){return}var fN=this,fO=fN.display;fO.shift=fP.shiftKey;if(a1(fO,fP)){if(!cI){fO.scroller.draggable=false;setTimeout(function(){fO.scroller.draggable=true},100)}return}if(n(fN,fP)){return}var fQ=cb(fN,fP);window.focus();switch(fn(fP)){case 1:if(fQ){av(fN,fP,fQ)}else{if(M(fP)==fO.scroller){cs(fP)}}break;case 2:if(cI){fN.state.lastMiddleDown=+new Date}if(fQ){ft(fN.doc,fQ)}setTimeout(cj(ec,fN),20);cs(fP);break;case 3:if(fE){aw(fN,fP)}break}}var c3,cV;function av(fO,fS,fT){setTimeout(cj(t,fO),0);var fP=+new Date,fQ;if(cV&&cV.time>fP-400&&b3(cV.pos,fT)==0){fQ="triple"}else{if(c3&&c3.time>fP-400&&b3(c3.pos,fT)==0){fQ="double";cV={time:fP,pos:fT}}else{fQ="single";c3={time:fP,pos:fT}}}var fR=fO.doc.sel,fN=bV?fS.metaKey:fS.ctrlKey;if(fO.options.dragDrop&&eo&&!ai(fO)&&fQ=="single"&&fR.contains(fT)>-1&&fR.somethingSelected()){aU(fO,fS,fT,fN)}else{o(fO,fS,fT,fQ,fN)}}function aU(fP,fR,fS,fO){var fQ=fP.display;var fN=cK(fP,function(fT){if(cI){fQ.scroller.draggable=false}fP.state.draggingText=false;dO(document,"mouseup",fN);dO(fQ.scroller,"drop",fN);if(Math.abs(fR.clientX-fT.clientX)+Math.abs(fR.clientY-fT.clientY)<10){cs(fT);if(!fO){ft(fP.doc,fS)}ec(fP);if(dm&&m==9){setTimeout(function(){document.body.focus();ec(fP)},20)}}});if(cI){fQ.scroller.draggable=true}fP.state.draggingText=fN;if(fQ.scroller.dragDrop){fQ.scroller.dragDrop()}bN(document,"mouseup",fN);bN(fQ.scroller,"drop",fN)}function o(fQ,f4,fP,fN,fS){var f1=fQ.display,f6=fQ.doc;cs(f4);var fO,f5,fR=f6.sel;if(fS&&!f4.shiftKey){f5=f6.sel.contains(fP);if(f5>-1){fO=f6.sel.ranges[f5]}else{fO=new dA(fP,fP)}}else{fO=f6.sel.primary()}if(f4.altKey){fN="rect";if(!fS){fO=new dA(fP,fP)}fP=cb(fQ,f4,true,true);f5=-1}else{if(fN=="double"){var f2=at(fQ,fP);if(fQ.display.shift||f6.extend){fO=e5(f6,fO,f2.anchor,f2.head)}else{fO=f2}}else{if(fN=="triple"){var fV=new dA(X(fP.line,0),fj(f6,X(fP.line+1,0)));if(fQ.display.shift||f6.extend){fO=e5(f6,fO,fV.anchor,fV.head)}else{fO=fV}}else{fO=e5(f6,fO,fP)}}}if(!fS){f5=0;bK(f6,new fx([fO],0),N);fR=f6.sel}else{if(f5>-1){f(f6,f5,fO,N)}else{f5=f6.sel.ranges.length;bK(f6,ck(f6.sel.ranges.concat([fO]),f5),{scroll:false,origin:"*mouse"})}}var f0=fP;function fZ(gh){if(b3(f0,gh)==0){return}f0=gh;if(fN=="rect"){var f8=[],ge=fQ.options.tabSize;var f7=bJ(eO(f6,fP.line).text,fP.ch,ge);var gk=bJ(eO(f6,gh.line).text,gh.ch,ge);var f9=Math.min(f7,gk),gi=Math.max(f7,gk);for(var gl=Math.min(fP.line,gh.line),gb=Math.min(fQ.lastLine(),Math.max(fP.line,gh.line));gl<=gb;gl++){var gj=eO(f6,gl).text,ga=d1(gj,f9,ge);if(f9==gi){f8.push(new dA(X(gl,ga),X(gl,ga)))}else{if(gj.length>ga){f8.push(new dA(X(gl,ga),X(gl,d1(gj,gi,ge))))}}}if(!f8.length){f8.push(new dA(fP,fP))}bK(f6,ck(fR.ranges.slice(0,f5).concat(f8),f5),{origin:"*mouse",scroll:false});fQ.scrollIntoView(gh)}else{var gf=fO;var gc=gf.anchor,gg=gh;if(fN!="single"){if(fN=="double"){var gd=at(fQ,gh)}else{var gd=new dA(X(gh.line,0),fj(f6,X(gh.line+1,0)))}if(b3(gd.anchor,gc)>0){gg=gd.head;gc=an(gf.from(),gd.anchor)}else{gg=gd.anchor;gc=bo(gf.to(),gd.head)}}var f8=fR.ranges.slice(0);f8[f5]=new dA(fj(f6,gc),gg);bK(f6,ck(f8,f5),N)}}var fX=f1.wrapper.getBoundingClientRect();var fT=0;function f3(f9){var f7=++fT;var gb=cb(fQ,f9,true,fN=="rect");if(!gb){return}if(b3(gb,f0)!=0){t(fQ);fZ(gb);var ga=bU(f1,f6);if(gb.line>=ga.to||gb.line<ga.from){setTimeout(cK(fQ,function(){if(fT==f7){f3(f9)}}),150)}}else{var f8=f9.clientY<fX.top?-20:f9.clientY>fX.bottom?20:0;if(f8){setTimeout(cK(fQ,function(){if(fT!=f7){return}f1.scroller.scrollTop+=f8;f3(f9)}),50)}}}function fW(f7){fT=Infinity;cs(f7);ec(fQ);dO(document,"mousemove",fY);dO(document,"mouseup",fU);f6.history.lastSelOrigin=null}var fY=cK(fQ,function(f7){if(!fn(f7)){fW(f7)}else{f3(f7)}});var fU=cK(fQ,fW);bN(document,"mousemove",fY);bN(document,"mouseup",fU)}function fL(fY,fU,fW,fX,fQ){try{var fO=fU.clientX,fN=fU.clientY}catch(fU){return false}if(fO>=Math.floor(fY.display.gutters.getBoundingClientRect().right)){return false}if(fX){cs(fU)}var fV=fY.display;var fT=fV.lineDiv.getBoundingClientRect();if(fN>fT.bottom||!eR(fY,fW)){return bB(fU)}fN-=fT.top-fV.viewOffset;for(var fR=0;fR<fY.options.gutters.length;++fR){var fS=fV.gutters.childNodes[fR];if(fS&&fS.getBoundingClientRect().right>=fO){var fZ=bw(fY.doc,fN);var fP=fY.options.gutters[fR];fQ(fY,fW,fY,fZ,fP,fU);return bB(fU)}}}function n(fN,fO){return fL(fN,fO,"gutterClick",true,ad)}var af=0;function ba(fT){var fV=this;if(aJ(fV,fT)||a1(fV.display,fT)){return}cs(fT);if(dm){af=+new Date}var fU=cb(fV,fT,true),fN=fT.dataTransfer.files;if(!fU||ai(fV)){return}if(fN&&fN.length&&window.FileReader&&window.File){var fP=fN.length,fW=Array(fP),fO=0;var fR=function(fZ,fY){var fX=new FileReader;fX.onload=cK(fV,function(){fW[fY]=fX.result;if(++fO==fP){fU=fj(fV.doc,fU);var f0={from:fU,to:fU,text:aR(fW.join("\n")),origin:"paste"};a6(fV.doc,f0);eG(fV.doc,et(fU,cF(f0)))}});fX.readAsText(fZ)};for(var fS=0;fS<fP;++fS){fR(fN[fS],fS)}}else{if(fV.state.draggingText&&fV.doc.sel.contains(fU)>-1){fV.state.draggingText(fT);setTimeout(cj(ec,fV),20);return}try{var fW=fT.dataTransfer.getData("Text");if(fW){if(fV.state.draggingText&&!(bV?fT.metaKey:fT.ctrlKey)){var fQ=fV.listSelections()}d0(fV.doc,et(fU,fU));if(fQ){for(var fS=0;fS<fQ.length;++fS){aS(fV.doc,"",fQ[fS].anchor,fQ[fS].head,"drag")}}fV.replaceSelection(fW,"around","paste");ec(fV)}}catch(fT){}}}function R(fN,fP){if(dm&&(!fN.state.draggingText||+new Date-af<100)){d2(fP);return}if(aJ(fN,fP)||a1(fN.display,fP)){return}fP.dataTransfer.setData("Text",fN.getSelection());if(fP.dataTransfer.setDragImage&&!az){var fO=fw("img",null,null,"position: fixed; left: 0; top: 0;");fO.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(dE){fO.width=fO.height=1;fN.display.wrapper.appendChild(fO);fO._top=fO.offsetTop}fP.dataTransfer.setDragImage(fO,0,0);if(dE){fO.parentNode.removeChild(fO)}}}function O(fN,fO){if(Math.abs(fN.doc.scrollTop-fO)<2){return}fN.doc.scrollTop=fO;if(!cc){dn(fN,{top:fO})}if(fN.display.scroller.scrollTop!=fO){fN.display.scroller.scrollTop=fO}if(fN.display.scrollbarV.scrollTop!=fO){fN.display.scrollbarV.scrollTop=fO}if(cc){dn(fN)}dQ(fN,100)}function bu(fN,fP,fO){if(fO?fP==fN.doc.scrollLeft:Math.abs(fN.doc.scrollLeft-fP)<2){return}fP=Math.min(fP,fN.display.scroller.scrollWidth-fN.display.scroller.clientWidth);fN.doc.scrollLeft=fP;eh(fN);if(fN.display.scroller.scrollLeft!=fP){fN.display.scroller.scrollLeft=fP}if(fN.display.scrollbarH.scrollLeft!=fP){fN.display.scrollbarH.scrollLeft=fP}}var eV=0,b4=null;if(dm){b4=-0.53}else{if(cc){b4=15}else{if(cU){b4=-0.7}else{if(az){b4=-1/3}}}}function c(fV,fP){var fY=fP.wheelDeltaX,fX=fP.wheelDeltaY;if(fY==null&&fP.detail&&fP.axis==fP.HORIZONTAL_AXIS){fY=fP.detail}if(fX==null&&fP.detail&&fP.axis==fP.VERTICAL_AXIS){fX=fP.detail}else{if(fX==null){fX=fP.wheelDelta}}var fR=fV.display,fU=fR.scroller;if(!(fY&&fU.scrollWidth>fU.clientWidth||fX&&fU.scrollHeight>fU.clientHeight)){return}if(fX&&bV&&cI){outer:for(var fW=fP.target,fT=fR.view;fW!=fU;fW=fW.parentNode){for(var fO=0;fO<fT.length;fO++){if(fT[fO].node==fW){fV.display.currentWheelTarget=fW;break outer}}}}if(fY&&!cc&&!dE&&b4!=null){if(fX){O(fV,Math.max(0,Math.min(fU.scrollTop+fX*b4,fU.scrollHeight-fU.clientHeight)))}bu(fV,Math.max(0,Math.min(fU.scrollLeft+fY*b4,fU.scrollWidth-fU.clientWidth)));cs(fP);fR.wheelStartX=null;return}if(fX&&b4!=null){var fN=fX*b4;var fS=fV.doc.scrollTop,fQ=fS+fR.wrapper.clientHeight;if(fN<0){fS=Math.max(0,fS+fN-50)}else{fQ=Math.min(fV.doc.height,fQ+fN+50)}dn(fV,{top:fS,bottom:fQ})}if(eV<20){if(fR.wheelStartX==null){fR.wheelStartX=fU.scrollLeft;fR.wheelStartY=fU.scrollTop;fR.wheelDX=fY;fR.wheelDY=fX;setTimeout(function(){if(fR.wheelStartX==null){return}var fZ=fU.scrollLeft-fR.wheelStartX;var f1=fU.scrollTop-fR.wheelStartY;var f0=(f1&&fR.wheelDY&&f1/fR.wheelDY)||(fZ&&fR.wheelDX&&fZ/fR.wheelDX);fR.wheelStartX=fR.wheelStartY=null;if(!f0){return}b4=(b4*eV+f0)/(eV+1);++eV},200)}else{fR.wheelDX+=fY;fR.wheelDY+=fX}}}function fq(fO,fR,fN){if(typeof fR=="string"){fR=eg[fR];if(!fR){return false}}if(fO.display.pollingFast&&b5(fO)){fO.display.pollingFast=false}var fQ=fO.display.shift,fP=false;try{if(ai(fO)){fO.state.suppressEdits=true}if(fN){fO.display.shift=false}fP=fR(fO)!=bY}finally{fO.display.shift=fQ;fO.state.suppressEdits=false}return fP}function c8(fN){var fO=fN.state.keyMaps.slice(0);if(fN.options.extraKeys){fO.push(fN.options.extraKeys)}fO.push(fN.options.keyMap);return fO}var ao;function eS(fN,fT){var fO=fu(fN.options.keyMap),fR=fO.auto;clearTimeout(ao);if(fR&&!ef(fT)){ao=setTimeout(function(){if(fu(fN.options.keyMap)==fO){fN.options.keyMap=(fR.call?fR.call(null,fN):fR);fK(fN)}},50)}var fQ=e1(fT,true),fS=false;if(!fQ){return false}var fP=c8(fN);if(fT.shiftKey){fS=j("Shift-"+fQ,fP,function(fU){return fq(fN,fU,true)})||j(fQ,fP,function(fU){if(typeof fU=="string"?/^go[A-Z]/.test(fU):fU.motion){return fq(fN,fU)}})}else{fS=j(fQ,fP,function(fU){return fq(fN,fU)})}if(fS){cs(fT);q(fN);ad(fN,"keyHandled",fN,fQ,fT)}return fS}function dU(fN,fQ,fO){var fP=j("'"+fO+"'",c8(fN),function(fR){return fq(fN,fR,true)});if(fP){cs(fQ);q(fN);ad(fN,"keyHandled",fN,"'"+fO+"'",fQ)}return fP}var c2=null;function r(fQ){var fN=this;t(fN);if(aJ(fN,fQ)){return}if(dm&&m<11&&fQ.keyCode==27){fQ.returnValue=false}var fO=fQ.keyCode;fN.display.shift=fO==16||fQ.shiftKey;var fP=eS(fN,fQ);if(dE){c2=fP?fO:null;if(!fP&&fO==88&&!cS&&(bV?fQ.metaKey:fQ.ctrlKey)){fN.replaceSelection("",null,"cut")}}if(fO==18&&!/\bCodeMirror-crosshair\b/.test(fN.display.lineDiv.className)){ar(fN)}}function ar(fO){var fP=fO.display.lineDiv;fa(fP,"CodeMirror-crosshair");function fN(fQ){if(fQ.keyCode==18||!fQ.altKey){g(fP,"CodeMirror-crosshair");dO(document,"keyup",fN);dO(document,"mouseover",fN)}}bN(document,"keyup",fN);bN(document,"mouseover",fN)}function a8(fN){if(aJ(this,fN)){return}if(fN.keyCode==16){this.doc.sel.shift=false}}function cl(fR){var fN=this;if(aJ(fN,fR)||fR.ctrlKey||bV&&fR.metaKey){return}var fQ=fR.keyCode,fO=fR.charCode;if(dE&&fQ==c2){c2=null;cs(fR);return}if(((dE&&(!fR.which||fR.which<10))||a2)&&eS(fN,fR)){return}var fP=String.fromCharCode(fO==null?fQ:fO);if(dU(fN,fR,fP)){return}if(dm&&m>=9){fN.display.inputHasSelection=null}D(fN)}function co(fN){if(fN.options.readOnly=="nocursor"){return}if(!fN.state.focused){aA(fN,"focus",fN);fN.state.focused=true;fa(fN.display.wrapper,"CodeMirror-focused");if(!fN.curOp&&fN.display.selForContextMenu!=fN.doc.sel){eY(fN);if(cI){setTimeout(cj(eY,fN,true),0)}}}bd(fN);q(fN)}function aM(fN){if(fN.state.focused){aA(fN,"blur",fN);fN.state.focused=false;g(fN.display.wrapper,"CodeMirror-focused")}clearInterval(fN.display.blinker);setTimeout(function(){if(!fN.state.focused){fN.display.shift=false}},150)}function aw(fW,fR){if(aJ(fW,fR,"contextmenu")){return}var fT=fW.display;if(a1(fT,fR)||cZ(fW,fR)){return}var fV=cb(fW,fR),fN=fT.scroller.scrollTop;if(!fV||dE){return}var fP=fW.options.resetSelectionOnContextMenu;if(fP&&fW.doc.sel.contains(fV)==-1){cK(fW,bK)(fW.doc,et(fV),Z)}var fS=fT.input.style.cssText;fT.inputDiv.style.position="absolute";fT.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(fR.clientY-5)+"px; left: "+(fR.clientX-5)+"px; z-index: 1000; background: "+(dm?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";ec(fW);eY(fW);if(!fW.somethingSelected()){fT.input.value=fT.prevInput=" "}fT.selForContextMenu=fW.doc.sel;clearTimeout(fT.detectingSelectAll);function fQ(){if(fT.input.selectionStart!=null){var fX=fW.somethingSelected();var fY=fT.input.value="\u200b"+(fX?fT.input.value:"");fT.prevInput=fX?"":"\u200b";fT.input.selectionStart=1;fT.input.selectionEnd=fY.length;fT.selForContextMenu=fW.doc.sel}}function fU(){fT.inputDiv.style.position="relative";fT.input.style.cssText=fS;if(dm&&m<9){fT.scrollbarV.scrollTop=fT.scroller.scrollTop=fN}bd(fW);if(fT.input.selectionStart!=null){if(!dm||(dm&&m<9)){fQ()}var fX=0,fY=function(){if(fT.selForContextMenu==fW.doc.sel&&fT.input.selectionStart==0){cK(fW,eg.selectAll)(fW)}else{if(fX++<10){fT.detectingSelectAll=setTimeout(fY,500)}else{eY(fW)}}};fT.detectingSelectAll=setTimeout(fY,200)}}if(dm&&m>=9){fQ()}if(fE){d2(fR);var fO=function(){dO(window,"mouseup",fO);setTimeout(fU,20)};bN(window,"mouseup",fO)}else{setTimeout(fU,50)}}function cZ(fN,fO){if(!eR(fN,"gutterContextMenu")){return false}return fL(fN,fO,"gutterContextMenu",false,aA)}var cF=J.changeEnd=function(fN){if(!fN.text){return fN.to}return X(fN.from.line+fN.text.length-1,fh(fN.text).length+(fN.text.length==1?fN.from.ch:0))};function bP(fQ,fP){if(b3(fQ,fP.from)<0){return fQ}if(b3(fQ,fP.to)<=0){return cF(fP)}var fN=fQ.line+fP.text.length-(fP.to.line-fP.from.line)-1,fO=fQ.ch;if(fQ.line==fP.to.line){fO+=cF(fP).ch-fP.to.ch}return X(fN,fO)}function eT(fQ,fR){var fO=[];for(var fP=0;fP<fQ.sel.ranges.length;fP++){var fN=fQ.sel.ranges[fP];fO.push(new dA(bP(fN.anchor,fR),bP(fN.head,fR)))}return ck(fO,fQ.sel.primIndex)}function bl(fP,fO,fN){if(fP.line==fO.line){return X(fN.line,fP.ch-fO.ch+fN.ch)}else{return X(fN.line+(fP.line-fO.line),fP.ch)}}function ae(fX,fU,fO){var fP=[];var fN=X(fX.first,0),fY=fN;for(var fR=0;fR<fU.length;fR++){var fT=fU[fR];var fW=bl(fT.from,fN,fY);var fV=bl(cF(fT),fN,fY);fN=fT.to;fY=fV;if(fO=="around"){var fS=fX.sel.ranges[fR],fQ=b3(fS.head,fS.anchor)<0;fP[fR]=new dA(fQ?fV:fW,fQ?fW:fV)}else{fP[fR]=new dA(fW,fW)}}return new fx(fP,fX.sel.primIndex)}function du(fO,fQ,fP){var fN={canceled:false,from:fQ.from,to:fQ.to,text:fQ.text,origin:fQ.origin,cancel:function(){this.canceled=true}};if(fP){fN.update=function(fU,fT,fS,fR){if(fU){this.from=fj(fO,fU)}if(fT){this.to=fj(fO,fT)}if(fS){this.text=fS}if(fR!==undefined){this.origin=fR}}}aA(fO,"beforeChange",fO,fN);if(fO.cm){aA(fO.cm,"beforeChange",fO.cm,fN)}if(fN.canceled){return null}return{from:fN.from,to:fN.to,text:fN.text,origin:fN.origin}}function a6(fQ,fR,fP){if(fQ.cm){if(!fQ.cm.curOp){return cK(fQ.cm,a6)(fQ,fR,fP)}if(fQ.cm.state.suppressEdits){return}}if(eR(fQ,"beforeChange")||fQ.cm&&eR(fQ.cm,"beforeChange")){fR=du(fQ,fR,true);if(!fR){return}}var fO=fH&&!fP&&ct(fQ,fR.from,fR.to);if(fO){for(var fN=fO.length-1;fN>=0;--fN){L(fQ,{from:fO[fN].from,to:fO[fN].to,text:fN?[""]:fR.text})}}else{L(fQ,fR)}}function L(fP,fQ){if(fQ.text.length==1&&fQ.text[0]==""&&b3(fQ.from,fQ.to)==0){return}var fO=eT(fP,fQ);fm(fP,fQ,fO,fP.cm?fP.cm.curOp.id:NaN);dP(fP,fQ,fO,dV(fP,fQ));var fN=[];dJ(fP,function(fS,fR){if(!fR&&c0(fN,fS.history)==-1){di(fS.history,fQ);fN.push(fS.history)}dP(fS,fQ,null,dV(fS,fQ))})}function bW(fY,fW,f0){if(fY.cm&&fY.cm.state.suppressEdits){return}var fV=fY.history,fP,fR=fY.sel;var fN=fW=="undo"?fV.done:fV.undone,fZ=fW=="undo"?fV.undone:fV.done;for(var fS=0;fS<fN.length;fS++){fP=fN[fS];if(f0?fP.ranges&&!fP.equals(fY.sel):!fP.ranges){break}}if(fS==fN.length){return}fV.lastOrigin=fV.lastSelOrigin=null;for(;;){fP=fN.pop();if(fP.ranges){cy(fP,fZ);if(f0&&!fP.equals(fY.sel)){bK(fY,fP,{clearRedo:false});return}fR=fP}else{break}}var fU=[];cy(fR,fZ);fZ.push({changes:fU,generation:fV.generation});fV.generation=fP.generation||++fV.maxGeneration;var fQ=eR(fY,"beforeChange")||fY.cm&&eR(fY.cm,"beforeChange");for(var fS=fP.changes.length-1;fS>=0;--fS){var fX=fP.changes[fS];fX.origin=fW;if(fQ&&!du(fY,fX,false)){fN.length=0;return}fU.push(c9(fY,fX));var fO=fS?eT(fY,fX,null):fh(fN);dP(fY,fX,fO,dL(fY,fX));if(!fS&&fY.cm){fY.cm.scrollIntoView(fX)}var fT=[];dJ(fY,function(f2,f1){if(!f1&&c0(fT,f2.history)==-1){di(f2.history,fX);fT.push(f2.history)}dP(f2,fX,null,dL(f2,fX))})}}function eW(fO,fQ){if(fQ==0){return}fO.first+=fQ;fO.sel=new fx(bI(fO.sel.ranges,function(fR){return new dA(X(fR.anchor.line+fQ,fR.anchor.ch),X(fR.head.line+fQ,fR.head.ch))}),fO.sel.primIndex);if(fO.cm){ag(fO.cm,fO.first,fO.first-fQ,fQ);for(var fP=fO.cm.display,fN=fP.viewFrom;fN<fP.viewTo;fN++){S(fO.cm,fN,"gutter")}}}function dP(fR,fS,fQ,fO){if(fR.cm&&!fR.cm.curOp){return cK(fR.cm,dP)(fR,fS,fQ,fO)}if(fS.to.line<fR.first){eW(fR,fS.text.length-1-(fS.to.line-fS.from.line));return}if(fS.from.line>fR.lastLine()){return}if(fS.from.line<fR.first){var fN=fS.text.length-1-(fR.first-fS.from.line);eW(fR,fN);fS={from:X(fR.first,0),to:X(fS.to.line+fN,fS.to.ch),text:[fh(fS.text)],origin:fS.origin}}var fP=fR.lastLine();if(fS.to.line>fP){fS={from:fS.from,to:X(fP,eO(fR,fP).text.length),text:[fS.text[0]],origin:fS.origin}}fS.removed=fy(fR,fS.from,fS.to);if(!fQ){fQ=eT(fR,fS,null)}if(fR.cm){aE(fR.cm,fS,fO)}else{e8(fR,fS,fO)}d0(fR,fQ,Z)}function aE(fY,fU,fS){var fX=fY.doc,fT=fY.display,fV=fU.from,fW=fU.to;var fN=false,fR=fV.line;if(!fY.options.lineWrapping){fR=bD(A(eO(fX,fV.line)));fX.iter(fR,fW.line+1,function(f0){if(f0==fT.maxLine){fN=true;return true}})}if(fX.sel.contains(fU.from,fU.to)>-1){W(fY)}e8(fX,fU,fS,a4(fY));if(!fY.options.lineWrapping){fX.iter(fR,fV.line+fU.text.length,function(f1){var f0=dX(f1);if(f0>fT.maxLineLength){fT.maxLine=f1;fT.maxLineLength=f0;fT.maxLineChanged=true;fN=false}});if(fN){fY.curOp.updateMaxLine=true}}fX.frontier=Math.min(fX.frontier,fV.line);dQ(fY,400);var fZ=fU.text.length-(fW.line-fV.line)-1;if(fV.line==fW.line&&fU.text.length==1&&!dv(fY.doc,fU)){S(fY,fV.line,"text")}else{ag(fY,fV.line,fW.line+1,fZ)}var fP=eR(fY,"changes"),fQ=eR(fY,"change");if(fQ||fP){var fO={from:fV,to:fW,text:fU.text,removed:fU.removed,origin:fU.origin};if(fQ){ad(fY,"change",fY,fO)}if(fP){(fY.curOp.changeObjs||(fY.curOp.changeObjs=[])).push(fO)}}fY.display.selForContextMenu=null}function aS(fQ,fP,fS,fR,fN){if(!fR){fR=fS}if(b3(fR,fS)<0){var fO=fR;fR=fS;fS=fO}if(typeof fP=="string"){fP=aR(fP)}a6(fQ,{from:fS,to:fR,text:fP,origin:fN})}function dI(fO,fR){var fS=fO.display,fP=fS.sizer.getBoundingClientRect(),fN=null;if(fR.top+fP.top<0){fN=true}else{if(fR.bottom+fP.top>(window.innerHeight||document.documentElement.clientHeight)){fN=false}}if(fN!=null&&!e4){var fQ=fw("div","\u200b",null,"position: absolute; top: "+(fR.top-fS.viewOffset-eH(fO.display))+"px; height: "+(fR.bottom-fR.top+bb)+"px; left: "+fR.left+"px; width: 2px;");fO.display.lineSpace.appendChild(fQ);fQ.scrollIntoView(fN);fO.display.lineSpace.removeChild(fQ)}}function F(fW,fU,fR,fQ){if(fQ==null){fQ=0}for(;;){var fS=false,fV=dw(fW,fU);var fN=!fR||fR==fU?fV:dw(fW,fR);var fP=I(fW,Math.min(fV.left,fN.left),Math.min(fV.top,fN.top)-fQ,Math.max(fV.left,fN.left),Math.max(fV.bottom,fN.bottom)+fQ);var fT=fW.doc.scrollTop,fO=fW.doc.scrollLeft;if(fP.scrollTop!=null){O(fW,fP.scrollTop);if(Math.abs(fW.doc.scrollTop-fT)>1){fS=true}}if(fP.scrollLeft!=null){bu(fW,fP.scrollLeft);if(Math.abs(fW.doc.scrollLeft-fO)>1){fS=true}}if(!fS){return fV}}}function G(fN,fP,fR,fO,fQ){var fS=I(fN,fP,fR,fO,fQ);if(fS.scrollTop!=null){O(fN,fS.scrollTop)}if(fS.scrollLeft!=null){bu(fN,fS.scrollLeft)}}function I(fT,f1,fQ,f0,fP){var fY=fT.display,fX=aO(fT.display);if(fQ<0){fQ=0}var fW=fT.curOp&&fT.curOp.scrollTop!=null?fT.curOp.scrollTop:fY.scroller.scrollTop;var fO=fY.scroller.clientHeight-bb,fV={};var f3=fT.doc.height+by(fY);var f4=fQ<fX,fZ=fP>f3-fX;if(fQ<fW){fV.scrollTop=f4?0:fQ}else{if(fP>fW+fO){var fU=Math.min(fQ,(fZ?f3:fP)-fO);if(fU!=fW){fV.scrollTop=fU}}}var fN=fT.curOp&&fT.curOp.scrollLeft!=null?fT.curOp.scrollLeft:fY.scroller.scrollLeft;var fS=fY.scroller.clientWidth-bb;f1+=fY.gutters.offsetWidth;f0+=fY.gutters.offsetWidth;var fR=fY.gutters.offsetWidth;var f2=f1<fR+10;if(f1<fN+fR||f2){if(f2){f1=0}fV.scrollLeft=Math.max(0,f1-10-fR)}else{if(f0>fS+fN-3){fV.scrollLeft=f0+10-fS}}return fV}function cw(fN,fP,fO){if(fP!=null||fO!=null){fc(fN)}if(fP!=null){fN.curOp.scrollLeft=(fN.curOp.scrollLeft==null?fN.doc.scrollLeft:fN.curOp.scrollLeft)+fP}if(fO!=null){fN.curOp.scrollTop=(fN.curOp.scrollTop==null?fN.doc.scrollTop:fN.curOp.scrollTop)+fO}}function fg(fN){fc(fN);var fO=fN.getCursor(),fQ=fO,fP=fO;if(!fN.options.lineWrapping){fQ=fO.ch?X(fO.line,fO.ch-1):fO;fP=X(fO.line,fO.ch+1)}fN.curOp.scrollToPos={from:fQ,to:fP,margin:fN.options.cursorScrollMargin,isCursor:true}}function fc(fN){var fP=fN.curOp.scrollToPos;if(fP){fN.curOp.scrollToPos=null;var fR=dl(fN,fP.from),fQ=dl(fN,fP.to);var fO=I(fN,Math.min(fR.left,fQ.left),Math.min(fR.top,fQ.top)-fP.margin,Math.max(fR.right,fQ.right),Math.max(fR.bottom,fQ.bottom)+fP.margin);fN.scrollTo(fO.scrollLeft,fO.scrollTop)}}function ac(f0,fQ,fZ,fP){var fY=f0.doc,fO;if(fZ==null){fZ="add"}if(fZ=="smart"){if(!f0.doc.mode.indent){fZ="prev"}else{fO=df(f0,fQ)}}var fU=f0.options.tabSize;var f1=eO(fY,fQ),fT=bJ(f1.text,null,fU);if(f1.stateAfter){f1.stateAfter=null}var fN=f1.text.match(/^\s*/)[0],fW;if(!fP&&!/\S/.test(f1.text)){fW=0;fZ="not"}else{if(fZ=="smart"){fW=f0.doc.mode.indent(fO,f1.text.slice(fN.length),f1.text);if(fW==bY){if(!fP){return}fZ="prev"}}}if(fZ=="prev"){if(fQ>fY.first){fW=bJ(eO(fY,fQ-1).text,null,fU)}else{fW=0}}else{if(fZ=="add"){fW=fT+f0.options.indentUnit}else{if(fZ=="subtract"){fW=fT-f0.options.indentUnit}else{if(typeof fZ=="number"){fW=fT+fZ}}}}fW=Math.max(0,fW);var fX="",fV=0;if(f0.options.indentWithTabs){for(var fR=Math.floor(fW/fU);fR;--fR){fV+=fU;fX+="\t"}}if(fV<fW){fX+=cd(fW-fV)}if(fX!=fN){aS(f0.doc,fX,X(fQ,0),X(fQ,fN.length),"+input")}else{for(var fR=0;fR<fY.sel.ranges.length;fR++){var fS=fY.sel.ranges[fR];if(fS.head.line==fQ&&fS.head.ch<fN.length){var fV=X(fQ,fN.length);f(fY,fR,new dA(fV,fV));break}}}f1.stateAfter=null}function ea(fQ,fP,fN,fS){var fR=fP,fO=fP;if(typeof fP=="number"){fO=eO(fQ,cN(fQ,fP))}else{fR=bD(fP)}if(fR==null){return null}if(fS(fO,fR)&&fQ.cm){S(fQ.cm,fR,fN)}return fO}function ez(fN,fT){var fO=fN.doc.sel.ranges,fR=[];for(var fQ=0;fQ<fO.length;fQ++){var fP=fT(fO[fQ]);while(fR.length&&b3(fP.from,fh(fR).to)<=0){var fS=fR.pop();if(b3(fS.from,fP.from)<0){fP.from=fS.from;break}}fR.push(fP)}cx(fN,function(){for(var fU=fR.length-1;fU>=0;fU--){aS(fN.doc,"",fR[fU].from,fR[fU].to,"+delete")}fg(fN)})}function bn(f5,fR,fZ,fY,fT){var fW=fR.line,fX=fR.ch,f4=fZ;var fO=eO(f5,fW);var f2=true;function f3(){var f6=fW+fZ;if(f6<f5.first||f6>=f5.first+f5.size){return(f2=false)}fW=f6;return fO=eO(f5,f6)}function f1(f7){var f6=(fT?w:ah)(fO,fX,fZ,true);if(f6==null){if(!f7&&f3()){if(fT){fX=(fZ<0?cD:cr)(fO)}else{fX=fZ<0?fO.text.length:0}}else{return(f2=false)}}else{fX=f6}return true}if(fY=="char"){f1()}else{if(fY=="column"){f1(true)}else{if(fY=="word"||fY=="group"){var f0=null,fU=fY=="group";var fN=f5.cm&&f5.cm.getHelper(fR,"wordChars");for(var fS=true;;fS=false){if(fZ<0&&!f1(!fS)){break}var fP=fO.text.charAt(fX)||"\n";var fQ=cn(fP,fN)?"w":fU&&fP=="\n"?"n":!fU||/\s/.test(fP)?null:"p";if(fU&&!fS&&!fQ){fQ="s"}if(f0&&f0!=fQ){if(fZ<0){fZ=1;f1()}break}if(fQ){f0=fQ}if(fZ>0&&!f1(!fS)){break}}}}}var fV=bL(f5,X(fW,fX),f4,true);if(!f2){fV.hitSide=true}return fV}function bh(fV,fQ,fN,fU){var fT=fV.doc,fS=fQ.left,fR;if(fU=="page"){var fP=Math.min(fV.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);fR=fQ.top+fN*(fP-(fN<0?1.5:0.5)*aO(fV.display))}else{if(fU=="line"){fR=fN>0?fQ.bottom+3:fQ.top-3}}for(;;){var fO=fo(fV,fS,fR);if(!fO.outside){break}if(fN<0?fR<=0:fR>=fT.height){fO.hitSide=true;break}fR+=fN*5}return fO}function at(fT,fR){var fS=fT.doc,fU=eO(fS,fR.line).text;var fO=fR.ch,fQ=fR.ch;if(fU){var fP=fT.getHelper(fR,"wordChars");if((fR.xRel<0||fQ==fU.length)&&fO){--fO}else{++fQ}var fV=fU.charAt(fO);var fN=cn(fV,fP)?function(fW){return cn(fW,fP)}:/\s/.test(fV)?function(fW){return/\s/.test(fW)}:function(fW){return !/\s/.test(fW)&&!cn(fW)};while(fO>0&&fN(fU.charAt(fO-1))){--fO}while(fQ<fU.length&&fN(fU.charAt(fQ))){++fQ}}return new dA(X(fR.line,fO),X(fR.line,fQ))}J.prototype={constructor:J,focus:function(){window.focus();ec(this);D(this)},setOption:function(fP,fQ){var fO=this.options,fN=fO[fP];if(fO[fP]==fQ&&fP!="mode"){return}fO[fP]=fQ;if(a5.hasOwnProperty(fP)){cK(this,a5[fP])(this,fQ,fN)}},getOption:function(fN){return this.options[fN]},getDoc:function(){return this.doc},addKeyMap:function(fO,fN){this.state.keyMaps[fN?"push":"unshift"](fO)},removeKeyMap:function(fO){var fP=this.state.keyMaps;for(var fN=0;fN<fP.length;++fN){if(fP[fN]==fO||(typeof fP[fN]!="string"&&fP[fN].name==fO)){fP.splice(fN,1);return true}}},addOverlay:cQ(function(fN,fO){var fP=fN.token?fN:J.getMode(this.options,fN);if(fP.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:fP,modeSpec:fN,opaque:fO&&fO.opaque});this.state.modeGen++;ag(this)}),removeOverlay:cQ(function(fN){var fP=this.state.overlays;for(var fO=0;fO<fP.length;++fO){var fQ=fP[fO].modeSpec;if(fQ==fN||typeof fN=="string"&&fQ.name==fN){fP.splice(fO,1);this.state.modeGen++;ag(this);return}}}),indentLine:cQ(function(fP,fN,fO){if(typeof fN!="string"&&typeof fN!="number"){if(fN==null){fN=this.options.smartIndent?"smart":"prev"}else{fN=fN?"add":"subtract"}}if(bX(this.doc,fP)){ac(this,fP,fN,fO)}}),indentSelection:cQ(function(fS){var fO=this.doc.sel.ranges,fN=-1;for(var fR=0;fR<fO.length;fR++){var fP=fO[fR];if(!fP.empty()){var fU=Math.max(fN,fP.from().line);var fT=fP.to();fN=Math.min(this.lastLine(),fT.line-(fT.ch?0:1))+1;for(var fQ=fU;fQ<fN;++fQ){ac(this,fQ,fS)}}else{if(fP.head.line>fN){ac(this,fP.head.line,fS,true);fN=fP.head.line;if(fR==this.doc.sel.primIndex){fg(this)}}}}}),getTokenAt:function(fU,fO){var fR=this.doc;fU=fj(fR,fU);var fQ=df(this,fU.line,fO),fT=this.doc.mode;var fN=eO(fR,fU.line);var fS=new ev(fN.text,this.options.tabSize);while(fS.pos<fU.ch&&!fS.eol()){fS.start=fS.pos;var fP=ee(fT,fS,fQ)}return{start:fS.start,end:fS.pos,string:fS.current(),type:fP||null,state:fQ}},getTokenTypeAt:function(fU){fU=fj(this.doc,fU);var fQ=cP(this,eO(this.doc,fU.line));var fS=0,fT=(fQ.length-1)/2,fP=fU.ch;var fO;if(fP==0){fO=fQ[2]}else{for(;;){var fN=(fS+fT)>>1;if((fN?fQ[fN*2-1]:0)>=fP){fT=fN}else{if(fQ[fN*2+1]<fP){fS=fN+1}else{fO=fQ[fN*2+2];break}}}}var fR=fO?fO.indexOf("cm-overlay "):-1;return fR<0?fO:fR==0?null:fO.slice(0,fR-1)},getModeAt:function(fO){var fN=this.doc.mode;if(!fN.innerMode){return fN}return J.innerMode(fN,this.getTokenAt(fO).state).mode},getHelper:function(fO,fN){return this.getHelpers(fO,fN)[0]},getHelpers:function(fU,fP){var fQ=[];if(!eX.hasOwnProperty(fP)){return eX}var fN=eX[fP],fT=this.getModeAt(fU);if(typeof fT[fP]=="string"){if(fN[fT[fP]]){fQ.push(fN[fT[fP]])}}else{if(fT[fP]){for(var fO=0;fO<fT[fP].length;fO++){var fS=fN[fT[fP][fO]];if(fS){fQ.push(fS)}}}else{if(fT.helperType&&fN[fT.helperType]){fQ.push(fN[fT.helperType])}else{if(fN[fT.name]){fQ.push(fN[fT.name])}}}}for(var fO=0;fO<fN._global.length;fO++){var fR=fN._global[fO];if(fR.pred(fT,this)&&c0(fQ,fR.val)==-1){fQ.push(fR.val)}}return fQ},getStateAfter:function(fO,fN){var fP=this.doc;fO=cN(fP,fO==null?fP.first+fP.size-1:fO);return df(this,fO+1,fN)},cursorCoords:function(fQ,fO){var fP,fN=this.doc.sel.primary();if(fQ==null){fP=fN.head}else{if(typeof fQ=="object"){fP=fj(this.doc,fQ)}else{fP=fQ?fN.from():fN.to()}}return dw(this,fP,fO||"page")},charCoords:function(fO,fN){return cv(this,fj(this.doc,fO),fN||"page")},coordsChar:function(fN,fO){fN=fJ(this,fN,fO||"page");return fo(this,fN.left,fN.top)},lineAtHeight:function(fN,fO){fN=fJ(this,{top:fN,left:0},fO||"page").top;return bw(this.doc,fN+this.display.viewOffset)},heightAtLine:function(fO,fR){var fN=false,fQ=this.doc.first+this.doc.size-1;if(fO<this.doc.first){fO=this.doc.first}else{if(fO>fQ){fO=fQ;fN=true}}var fP=eO(this.doc,fO);return es(this,fP,{top:0,left:0},fR||"page").top+(fN?this.doc.height-bC(fP):0)},defaultTextHeight:function(){return aO(this.display)},defaultCharWidth:function(){return dh(this.display)},setGutterMarker:cQ(function(fN,fO,fP){return ea(this.doc,fN,"gutter",function(fQ){var fR=fQ.gutterMarkers||(fQ.gutterMarkers={});fR[fO]=fP;if(!fP&&ew(fR)){fQ.gutterMarkers=null}return true})}),clearGutter:cQ(function(fP){var fN=this,fQ=fN.doc,fO=fQ.first;fQ.iter(function(fR){if(fR.gutterMarkers&&fR.gutterMarkers[fP]){fR.gutterMarkers[fP]=null;S(fN,fO,"gutter");if(ew(fR.gutterMarkers)){fR.gutterMarkers=null}}++fO})}),addLineWidget:cQ(function(fP,fO,fN){return bx(this,fP,fO,fN)}),removeLineWidget:function(fN){fN.clear()},lineInfo:function(fN){if(typeof fN=="number"){if(!bX(this.doc,fN)){return null}var fO=fN;fN=eO(this.doc,fN);if(!fN){return null}}else{var fO=bD(fN);if(fO==null){return null}}return{line:fO,handle:fN,text:fN.text,gutterMarkers:fN.gutterMarkers,textClass:fN.textClass,bgClass:fN.bgClass,wrapClass:fN.wrapClass,widgets:fN.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(fS,fP,fU,fQ,fW){var fR=this.display;fS=dw(this,fj(this.doc,fS));var fT=fS.bottom,fO=fS.left;fP.style.position="absolute";fR.sizer.appendChild(fP);if(fQ=="over"){fT=fS.top}else{if(fQ=="above"||fQ=="near"){var fN=Math.max(fR.wrapper.clientHeight,this.doc.height),fV=Math.max(fR.sizer.clientWidth,fR.lineSpace.clientWidth);if((fQ=="above"||fS.bottom+fP.offsetHeight>fN)&&fS.top>fP.offsetHeight){fT=fS.top-fP.offsetHeight}else{if(fS.bottom+fP.offsetHeight<=fN){fT=fS.bottom}}if(fO+fP.offsetWidth>fV){fO=fV-fP.offsetWidth}}}fP.style.top=fT+"px";fP.style.left=fP.style.right="";if(fW=="right"){fO=fR.sizer.clientWidth-fP.offsetWidth;fP.style.right="0px"}else{if(fW=="left"){fO=0}else{if(fW=="middle"){fO=(fR.sizer.clientWidth-fP.offsetWidth)/2}}fP.style.left=fO+"px"}if(fU){G(this,fO,fT,fO+fP.offsetWidth,fT+fP.offsetHeight)}},triggerOnKeyDown:cQ(r),triggerOnKeyPress:cQ(cl),triggerOnKeyUp:cQ(a8),execCommand:function(fN){if(eg.hasOwnProperty(fN)){return eg[fN](this)}},findPosH:function(fT,fQ,fR,fO){var fN=1;if(fQ<0){fN=-1;fQ=-fQ}for(var fP=0,fS=fj(this.doc,fT);fP<fQ;++fP){fS=bn(this.doc,fS,fN,fR,fO);if(fS.hitSide){break}}return fS},moveH:cQ(function(fO,fP){var fN=this;fN.extendSelectionsBy(function(fQ){if(fN.display.shift||fN.doc.extend||fQ.empty()){return bn(fN.doc,fQ.head,fO,fP,fN.options.rtlMoveVisually)}else{return fO<0?fQ.from():fQ.to()}},cE)}),deleteH:cQ(function(fN,fO){var fP=this.doc.sel,fQ=this.doc;if(fP.somethingSelected()){fQ.replaceSelection("",null,"+delete")}else{ez(this,function(fS){var fR=bn(fQ,fS.head,fN,fO,false);return fN<0?{from:fR,to:fS.head}:{from:fS.head,to:fR}})}}),findPosV:function(fS,fP,fT,fV){var fN=1,fR=fV;if(fP<0){fN=-1;fP=-fP}for(var fO=0,fU=fj(this.doc,fS);fO<fP;++fO){var fQ=dw(this,fU,"div");if(fR==null){fR=fQ.left}else{fQ.left=fR}fU=bh(this,fQ,fN,fT);if(fU.hitSide){break}}return fU},moveV:cQ(function(fO,fQ){var fN=this,fS=this.doc,fR=[];var fT=!fN.display.shift&&!fS.extend&&fS.sel.somethingSelected();fS.extendSelectionsBy(function(fU){if(fT){return fO<0?fU.from():fU.to()}var fW=dw(fN,fU.head,"div");if(fU.goalColumn!=null){fW.left=fU.goalColumn}fR.push(fW.left);var fV=bh(fN,fW,fO,fQ);if(fQ=="page"&&fU==fS.sel.primary()){cw(fN,null,cv(fN,fV,"div").top-fW.top)}return fV},cE);if(fR.length){for(var fP=0;fP<fS.sel.ranges.length;fP++){fS.sel.ranges[fP].goalColumn=fR[fP]}}}),toggleOverwrite:function(fN){if(fN!=null&&fN==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){fa(this.display.cursorDiv,"CodeMirror-overwrite")}else{g(this.display.cursorDiv,"CodeMirror-overwrite")}aA(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return dr()==this.display.input},scrollTo:cQ(function(fN,fO){if(fN!=null||fO!=null){fc(this)}if(fN!=null){this.curOp.scrollLeft=fN}if(fO!=null){this.curOp.scrollTop=fO}}),getScrollInfo:function(){var fN=this.display.scroller,fO=bb;return{left:fN.scrollLeft,top:fN.scrollTop,height:fN.scrollHeight-fO,width:fN.scrollWidth-fO,clientHeight:fN.clientHeight-fO,clientWidth:fN.clientWidth-fO}},scrollIntoView:cQ(function(fO,fP){if(fO==null){fO={from:this.doc.sel.primary().head,to:null};if(fP==null){fP=this.options.cursorScrollMargin}}else{if(typeof fO=="number"){fO={from:X(fO,0),to:null}}else{if(fO.from==null){fO={from:fO,to:null}}}}if(!fO.to){fO.to=fO.from}fO.margin=fP||0;if(fO.from.line!=null){fc(this);this.curOp.scrollToPos=fO}else{var fN=I(this,Math.min(fO.from.left,fO.to.left),Math.min(fO.from.top,fO.to.top)-fO.margin,Math.max(fO.from.right,fO.to.right),Math.max(fO.from.bottom,fO.to.bottom)+fO.margin);this.scrollTo(fN.scrollLeft,fN.scrollTop)}}),setSize:cQ(function(fQ,fO){var fN=this;function fP(fS){return typeof fS=="number"||/^\d+$/.test(String(fS))?fS+"px":fS}if(fQ!=null){fN.display.wrapper.style.width=fP(fQ)}if(fO!=null){fN.display.wrapper.style.height=fP(fO)}if(fN.options.lineWrapping){aG(this)}var fR=fN.display.viewFrom;fN.doc.iter(fR,fN.display.viewTo,function(fS){if(fS.widgets){for(var fT=0;fT<fS.widgets.length;fT++){if(fS.widgets[fT].noHScroll){S(fN,fR,"widget");break}}}++fR});fN.curOp.forceUpdate=true;aA(fN,"refresh",this)}),operation:function(fN){return cx(this,fN)},refresh:cQ(function(){var fN=this.display.cachedTextHeight;ag(this);this.curOp.forceUpdate=true;aj(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);cM(this);if(fN==null||Math.abs(fN-aO(this.display))>0.5){Y(this)}aA(this,"refresh",this)}),swapDoc:cQ(function(fO){var fN=this.doc;fN.cm=null;dM(this,fO);aj(this);eY(this);this.scrollTo(fO.scrollLeft,fO.scrollTop);ad(this,"swapDoc",this,fN);return fN}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bp(J);var eE=J.defaults={};var a5=J.optionHandlers={};function u(fN,fQ,fP,fO){J.defaults[fN]=fQ;if(fP){a5[fN]=fO?function(fR,fT,fS){if(fS!=b0){fP(fR,fT,fS)}}:fP}}var b0=J.Init={toString:function(){return"CodeMirror.Init"}};u("value","",function(fN,fO){fN.setValue(fO)},true);u("mode",null,function(fN,fO){fN.doc.modeOption=fO;bi(fN)},true);u("indentUnit",2,bi,true);u("indentWithTabs",false);u("smartIndent",true);u("tabSize",4,function(fN){dW(fN);aj(fN);ag(fN)},true);u("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(fN,fO){fN.options.specialChars=new RegExp(fO.source+(fO.test("\t")?"":"|\t"),"g");fN.refresh()},true);u("specialCharPlaceholder",eM,function(fN){fN.refresh()},true);u("electricChars",true);u("rtlMoveVisually",!aH);u("wholeLineUpdateBefore",true);u("theme","default",function(fN){cz(fN);da(fN)},true);u("keyMap","default",fK);u("extraKeys",null);u("lineWrapping",false,ej,true);u("gutters",[],function(fN){b2(fN.options);da(fN)},true);u("fixedGutter",true,function(fN,fO){fN.display.gutters.style.left=fO?dz(fN.display)+"px":"0";fN.refresh()},true);u("coverGutterNextToScrollbar",false,eA,true);u("lineNumbers",false,function(fN){b2(fN.options);da(fN)},true);u("firstLineNumber",1,da,true);u("lineNumberFormatter",function(fN){return fN},da,true);u("showCursorWhenSelecting",false,bs,true);u("resetSelectionOnContextMenu",true);u("readOnly",false,function(fN,fO){if(fO=="nocursor"){aM(fN);fN.display.input.blur();fN.display.disabled=true}else{fN.display.disabled=false;if(!fO){eY(fN)}}});u("disableInput",false,function(fN,fO){if(!fO){eY(fN)}},true);u("dragDrop",true);u("cursorBlinkRate",530);u("cursorScrollMargin",0);u("cursorHeight",1,bs,true);u("singleCursorHeightPerLine",true,bs,true);u("workTime",100);u("workDelay",100);u("flattenSpans",true,dW,true);u("addModeClass",false,dW,true);u("pollInterval",100);u("undoDepth",200,function(fN,fO){fN.doc.history.undoDepth=fO});u("historyEventDelay",1250);u("viewportMargin",10,function(fN){fN.refresh()},true);u("maxHighlightLength",10000,dW,true);u("moveInputWithCursor",true,function(fN,fO){if(!fO){fN.display.inputDiv.style.top=fN.display.inputDiv.style.left=0}});u("tabindex",null,function(fN,fO){fN.display.input.tabIndex=fO||""});u("autofocus",null);var c7=J.modes={},aK=J.mimeModes={};J.defineMode=function(fN,fP){if(!J.defaults.mode&&fN!="null"){J.defaults.mode=fN}if(arguments.length>2){fP.dependencies=[];for(var fO=2;fO<arguments.length;++fO){fP.dependencies.push(arguments[fO])}}c7[fN]=fP};J.defineMIME=function(fO,fN){aK[fO]=fN};J.resolveMode=function(fN){if(typeof fN=="string"&&aK.hasOwnProperty(fN)){fN=aK[fN]}else{if(fN&&typeof fN.name=="string"&&aK.hasOwnProperty(fN.name)){var fO=aK[fN.name];if(typeof fO=="string"){fO={name:fO}}fN=b8(fO,fN);fN.name=fO.name}else{if(typeof fN=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(fN)){return J.resolveMode("application/xml")}}}if(typeof fN=="string"){return{name:fN}}else{return fN||{name:"null"}}};J.getMode=function(fO,fN){var fN=J.resolveMode(fN);var fQ=c7[fN.name];if(!fQ){return J.getMode(fO,"text/plain")}var fR=fQ(fO,fN);if(c4.hasOwnProperty(fN.name)){var fP=c4[fN.name];for(var fS in fP){if(!fP.hasOwnProperty(fS)){continue}if(fR.hasOwnProperty(fS)){fR["_"+fS]=fR[fS]}fR[fS]=fP[fS]}}fR.name=fN.name;if(fN.helperType){fR.helperType=fN.helperType}if(fN.modeProps){for(var fS in fN.modeProps){fR[fS]=fN.modeProps[fS]}}return fR};J.defineMode("null",function(){return{token:function(fN){fN.skipToEnd()}}});J.defineMIME("text/plain","null");var c4=J.modeExtensions={};J.extendMode=function(fP,fO){var fN=c4.hasOwnProperty(fP)?c4[fP]:(c4[fP]={});aF(fO,fN)};J.defineExtension=function(fN,fO){J.prototype[fN]=fO};J.defineDocExtension=function(fN,fO){ap.prototype[fN]=fO};J.defineOption=u;var aZ=[];J.defineInitHook=function(fN){aZ.push(fN)};var eX=J.helpers={};J.registerHelper=function(fO,fN,fP){if(!eX.hasOwnProperty(fO)){eX[fO]=J[fO]={_global:[]}}eX[fO][fN]=fP};J.registerGlobalHelper=function(fP,fO,fN,fQ){J.registerHelper(fP,fO,fQ);eX[fP]._global.push({pred:fN,val:fQ})};var bS=J.copyState=function(fQ,fN){if(fN===true){return fN}if(fQ.copyState){return fQ.copyState(fN)}var fP={};for(var fR in fN){var fO=fN[fR];if(fO instanceof Array){fO=fO.concat([])}fP[fR]=fO}return fP};var bQ=J.startState=function(fP,fO,fN){return fP.startState?fP.startState(fO,fN):true};J.innerMode=function(fP,fN){while(fP.innerMode){var fO=fP.innerMode(fN);if(!fO||fO.mode==fP){break}fN=fO.state;fP=fO.mode}return fO||{mode:fP,state:fN}};var eg=J.commands={selectAll:function(fN){fN.setSelection(X(fN.firstLine(),0),X(fN.lastLine()),Z)},singleSelection:function(fN){fN.setSelection(fN.getCursor("anchor"),fN.getCursor("head"),Z)},killLine:function(fN){ez(fN,function(fP){if(fP.empty()){var fO=eO(fN.doc,fP.head.line).text.length;if(fP.head.ch==fO&&fP.head.line<fN.lastLine()){return{from:fP.head,to:X(fP.head.line+1,0)}}else{return{from:fP.head,to:X(fP.head.line,fO)}}}else{return{from:fP.from(),to:fP.to()}}})},deleteLine:function(fN){ez(fN,function(fO){return{from:X(fO.from().line,0),to:fj(fN.doc,X(fO.to().line+1,0))}})},delLineLeft:function(fN){ez(fN,function(fO){return{from:X(fO.from().line,0),to:fO.from()}})},undo:function(fN){fN.undo()},redo:function(fN){fN.redo()},undoSelection:function(fN){fN.undoSelection()},redoSelection:function(fN){fN.redoSelection()},goDocStart:function(fN){fN.extendSelection(X(fN.firstLine(),0))},goDocEnd:function(fN){fN.extendSelection(X(fN.lastLine()))},goLineStart:function(fN){fN.extendSelectionsBy(function(fO){return bk(fN,fO.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(fN){fN.extendSelectionsBy(function(fQ){var fT=bk(fN,fQ.head.line);var fP=fN.getLineHandle(fT.line);var fO=a(fP);if(!fO||fO[0].level==0){var fS=Math.max(0,fP.text.search(/\S/));var fR=fQ.head.line==fT.line&&fQ.head.ch<=fS&&fQ.head.ch;return X(fT.line,fR?0:fS)}return fT},{origin:"+move",bias:1})},goLineEnd:function(fN){fN.extendSelectionsBy(function(fO){return ds(fN,fO.head.line)},{origin:"+move",bias:-1})},goLineRight:function(fN){fN.extendSelectionsBy(function(fO){var fP=fN.charCoords(fO.head,"div").top+5;return fN.coordsChar({left:fN.display.lineDiv.offsetWidth+100,top:fP},"div")},cE)},goLineLeft:function(fN){fN.extendSelectionsBy(function(fO){var fP=fN.charCoords(fO.head,"div").top+5;return fN.coordsChar({left:0,top:fP},"div")},cE)},goLineUp:function(fN){fN.moveV(-1,"line")},goLineDown:function(fN){fN.moveV(1,"line")},goPageUp:function(fN){fN.moveV(-1,"page")},goPageDown:function(fN){fN.moveV(1,"page")},goCharLeft:function(fN){fN.moveH(-1,"char")},goCharRight:function(fN){fN.moveH(1,"char")},goColumnLeft:function(fN){fN.moveH(-1,"column")},goColumnRight:function(fN){fN.moveH(1,"column")},goWordLeft:function(fN){fN.moveH(-1,"word")},goGroupRight:function(fN){fN.moveH(1,"group")},goGroupLeft:function(fN){fN.moveH(-1,"group")},goWordRight:function(fN){fN.moveH(1,"word")},delCharBefore:function(fN){fN.deleteH(-1,"char")},delCharAfter:function(fN){fN.deleteH(1,"char")},delWordBefore:function(fN){fN.deleteH(-1,"word")},delWordAfter:function(fN){fN.deleteH(1,"word")},delGroupBefore:function(fN){fN.deleteH(-1,"group")},delGroupAfter:function(fN){fN.deleteH(1,"group")},indentAuto:function(fN){fN.indentSelection("smart")},indentMore:function(fN){fN.indentSelection("add")},indentLess:function(fN){fN.indentSelection("subtract")},insertTab:function(fN){fN.replaceSelection("\t")},insertSoftTab:function(fN){var fP=[],fO=fN.listSelections(),fS=fN.options.tabSize;for(var fR=0;fR<fO.length;fR++){var fT=fO[fR].from();var fQ=bJ(fN.getLine(fT.line),fT.ch,fS);fP.push(new Array(fS-fQ%fS+1).join(" "))}fN.replaceSelections(fP)},defaultTab:function(fN){if(fN.somethingSelected()){fN.indentSelection("add")}else{fN.execCommand("insertTab")}},transposeChars:function(fN){cx(fN,function(){var fQ=fN.listSelections(),fP=[];for(var fR=0;fR<fQ.length;fR++){var fT=fQ[fR].head,fO=eO(fN.doc,fT.line).text;if(fO){if(fT.ch==fO.length){fT=new X(fT.line,fT.ch-1)}if(fT.ch>0){fT=new X(fT.line,fT.ch+1);fN.replaceRange(fO.charAt(fT.ch-1)+fO.charAt(fT.ch-2),X(fT.line,fT.ch-2),fT,"+transpose")}else{if(fT.line>fN.doc.first){var fS=eO(fN.doc,fT.line-1).text;if(fS){fN.replaceRange(fO.charAt(0)+"\n"+fS.charAt(fS.length-1),X(fT.line-1,fS.length-1),X(fT.line,1),"+transpose")}}}}fP.push(new dA(fT,fT))}fN.setSelections(fP)})},newlineAndIndent:function(fN){cx(fN,function(){var fO=fN.listSelections().length;for(var fQ=0;fQ<fO;fQ++){var fP=fN.listSelections()[fQ];fN.replaceRange("\n",fP.anchor,fP.head,"+input");fN.indentLine(fP.from().line+1,null,true);fg(fN)}})},toggleOverwrite:function(fN){fN.toggleOverwrite()}};var eJ=J.keyMap={};eJ.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};eJ.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};eJ.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection",fallthrough:["basic","emacsy"]};eJ.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};eJ["default"]=bV?eJ.macDefault:eJ.pcDefault;function fu(fN){if(typeof fN=="string"){return eJ[fN]}else{return fN}}var j=J.lookupKey=function(fO,fS,fQ){function fR(fX){fX=fu(fX);var fW=fX[fO];if(fW===false){return"stop"}if(fW!=null&&fQ(fW)){return true}if(fX.nofallthrough){return"stop"}var fV=fX.fallthrough;if(fV==null){return false}if(Object.prototype.toString.call(fV)!="[object Array]"){return fR(fV)}for(var fU=0;fU<fV.length;++fU){var fT=fR(fV[fU]);if(fT){return fT}}return false}for(var fP=0;fP<fS.length;++fP){var fN=fR(fS[fP]);if(fN){return fN!="stop"}}};var ef=J.isModifierKey=function(fO){var fN=eP[fO.keyCode];return fN=="Ctrl"||fN=="Alt"||fN=="Shift"||fN=="Mod"};var e1=J.keyName=function(fO,fP){if(dE&&fO.keyCode==34&&fO["char"]){return false}var fN=eP[fO.keyCode];if(fN==null||fO.altGraphKey){return false}if(fO.altKey){fN="Alt-"+fN}if(bG?fO.metaKey:fO.ctrlKey){fN="Ctrl-"+fN}if(bG?fO.ctrlKey:fO.metaKey){fN="Cmd-"+fN}if(!fP&&fO.shiftKey){fN="Shift-"+fN}return fN};J.fromTextArea=function(fU,fV){if(!fV){fV={}}fV.value=fU.value;if(!fV.tabindex&&fU.tabindex){fV.tabindex=fU.tabindex}if(!fV.placeholder&&fU.placeholder){fV.placeholder=fU.placeholder}if(fV.autofocus==null){var fN=dr();fV.autofocus=fN==fU||fU.getAttribute("autofocus")!=null&&fN==document.body}function fR(){fU.value=fT.getValue()}if(fU.form){bN(fU.form,"submit",fR);if(!fV.leaveSubmitMethodAlone){var fO=fU.form,fS=fO.submit;try{var fQ=fO.submit=function(){fR();fO.submit=fS;fO.submit();fO.submit=fQ}}catch(fP){}}}fU.style.display="none";var fT=J(function(fW){fU.parentNode.insertBefore(fW,fU.nextSibling)},fV);fT.save=fR;fT.getTextArea=function(){return fU};fT.toTextArea=function(){fR();fU.parentNode.removeChild(fT.getWrapperElement());fU.style.display="";if(fU.form){dO(fU.form,"submit",fR);if(typeof fU.form.submit=="function"){fU.form.submit=fS}}};return fT};var ev=J.StringStream=function(fN,fO){this.pos=this.start=0;this.string=fN;this.tabSize=fO||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};ev.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(fN){var fP=this.string.charAt(this.pos);if(typeof fN=="string"){var fO=fP==fN}else{var fO=fP&&(fN.test?fN.test(fP):fN(fP))}if(fO){++this.pos;return fP}},eatWhile:function(fN){var fO=this.pos;while(this.eat(fN)){}return this.pos>fO},eatSpace:function(){var fN=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>fN},skipToEnd:function(){this.pos=this.string.length},skipTo:function(fN){var fO=this.string.indexOf(fN,this.pos);if(fO>-1){this.pos=fO;return true}},backUp:function(fN){this.pos-=fN},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bJ(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bJ(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bJ(this.string,null,this.tabSize)-(this.lineStart?bJ(this.string,this.lineStart,this.tabSize):0)},match:function(fR,fO,fN){if(typeof fR=="string"){var fS=function(fT){return fN?fT.toLowerCase():fT};var fQ=this.string.substr(this.pos,fR.length);if(fS(fQ)==fS(fR)){if(fO!==false){this.pos+=fR.length}return true}}else{var fP=this.string.slice(this.pos).match(fR);if(fP&&fP.index>0){return null}if(fP&&fO!==false){this.pos+=fP[0].length}return fP}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(fO,fN){this.lineStart+=fO;try{return fN()}finally{this.lineStart-=fO}}};var Q=J.TextMarker=function(fO,fN){this.lines=[];this.type=fN;this.doc=fO};bp(Q);Q.prototype.clear=function(){if(this.explicitlyCleared){return}var fU=this.doc.cm,fO=fU&&!fU.curOp;if(fO){cu(fU)}if(eR(this,"clear")){var fV=this.find();if(fV){ad(this,"clear",fV.from,fV.to)}}var fP=null,fS=null;for(var fQ=0;fQ<this.lines.length;++fQ){var fW=this.lines[fQ];var fT=eI(fW.markedSpans,this);if(fU&&!this.collapsed){S(fU,bD(fW),"text")}else{if(fU){if(fT.to!=null){fS=bD(fW)}if(fT.from!=null){fP=bD(fW)}}}fW.markedSpans=ek(fW.markedSpans,fT);if(fT.from==null&&this.collapsed&&!e6(this.doc,fW)&&fU){fA(fW,aO(fU.display))}}if(fU&&this.collapsed&&!fU.options.lineWrapping){for(var fQ=0;fQ<this.lines.length;++fQ){var fN=A(this.lines[fQ]),fR=dX(fN);if(fR>fU.display.maxLineLength){fU.display.maxLine=fN;fU.display.maxLineLength=fR;fU.display.maxLineChanged=true}}}if(fP!=null&&fU&&this.collapsed){ag(fU,fP,fS+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(fU){d9(fU.doc)}}if(fU){ad(fU,"markerCleared",fU,this)}if(fO){ak(fU)}if(this.parent){this.parent.clear()}};Q.prototype.find=function(fQ,fO){if(fQ==null&&this.type=="bookmark"){fQ=1}var fT,fS;for(var fP=0;fP<this.lines.length;++fP){var fN=this.lines[fP];var fR=eI(fN.markedSpans,this);if(fR.from!=null){fT=X(fO?fN:bD(fN),fR.from);if(fQ==-1){return fT}}if(fR.to!=null){fS=X(fO?fN:bD(fN),fR.to);if(fQ==1){return fS}}}return fT&&{from:fT,to:fS}};Q.prototype.changed=function(){var fP=this.find(-1,true),fO=this,fN=this.doc.cm;if(!fP||!fN){return}cx(fN,function(){var fR=fP.line,fS=bD(fP.line);var fQ=eK(fN,fS);if(fQ){aq(fQ);fN.curOp.selectionChanged=fN.curOp.forceUpdate=true}fN.curOp.updateMaxLine=true;if(!e6(fO.doc,fR)&&fO.height!=null){var fU=fO.height;fO.height=null;var fT=cG(fO)-fU;if(fT){fA(fR,fR.height+fT)}}})};Q.prototype.attachLine=function(fN){if(!this.lines.length&&this.doc.cm){var fO=this.doc.cm.curOp;if(!fO.maybeHiddenMarkers||c0(fO.maybeHiddenMarkers,this)==-1){(fO.maybeUnhiddenMarkers||(fO.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(fN)};Q.prototype.detachLine=function(fN){this.lines.splice(c0(this.lines,fN),1);if(!this.lines.length&&this.doc.cm){var fO=this.doc.cm.curOp;(fO.maybeHiddenMarkers||(fO.maybeHiddenMarkers=[])).push(this)}};var aW=0;function ei(fV,fT,fU,fX,fR){if(fX&&fX.shared){return P(fV,fT,fU,fX,fR)}if(fV.cm&&!fV.cm.curOp){return cK(fV.cm,ei)(fV,fT,fU,fX,fR)}var fQ=new Q(fV,fR),fW=b3(fT,fU);if(fX){aF(fX,fQ,false)}if(fW>0||fW==0&&fQ.clearWhenEmpty!==false){return fQ}if(fQ.replacedWith){fQ.collapsed=true;fQ.widgetNode=fw("span",[fQ.replacedWith],"CodeMirror-widget");if(!fX.handleMouseEvents){fQ.widgetNode.ignoreEvents=true}if(fX.insertLeft){fQ.widgetNode.insertLeft=true}}if(fQ.collapsed){if(B(fV,fT.line,fT,fU,fQ)||fT.line!=fU.line&&B(fV,fU.line,fT,fU,fQ)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}aY=true}if(fQ.addToHistory){fm(fV,{from:fT,to:fU,origin:"markText"},fV.sel,NaN)}var fO=fT.line,fS=fV.cm,fN;fV.iter(fO,fU.line+1,function(fY){if(fS&&fQ.collapsed&&!fS.options.lineWrapping&&A(fY)==fS.display.maxLine){fN=true}if(fQ.collapsed&&fO!=fT.line){fA(fY,0)}b1(fY,new dT(fQ,fO==fT.line?fT.ch:null,fO==fU.line?fU.ch:null));++fO});if(fQ.collapsed){fV.iter(fT.line,fU.line+1,function(fY){if(e6(fV,fY)){fA(fY,0)}})}if(fQ.clearOnEnter){bN(fQ,"beforeCursorEnter",function(){fQ.clear()})}if(fQ.readOnly){fH=true;if(fV.history.done.length||fV.history.undone.length){fV.clearHistory()}}if(fQ.collapsed){fQ.id=++aW;fQ.atomic=true}if(fS){if(fN){fS.curOp.updateMaxLine=true}if(fQ.collapsed){ag(fS,fT.line,fU.line+1)}else{if(fQ.className||fQ.title||fQ.startStyle||fQ.endStyle){for(var fP=fT.line;fP<=fU.line;fP++){S(fS,fP,"text")}}}if(fQ.atomic){d9(fS.doc)}ad(fS,"markerAdded",fS,fQ)}return fQ}var z=J.SharedTextMarker=function(fP,fO){this.markers=fP;this.primary=fO;for(var fN=0;fN<fP.length;++fN){fP[fN].parent=this}};bp(z);z.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var fN=0;fN<this.markers.length;++fN){this.markers[fN].clear()}ad(this,"clear")};z.prototype.find=function(fO,fN){return this.primary.find(fO,fN)};function P(fR,fU,fT,fN,fP){fN=aF(fN);fN.shared=false;var fS=[ei(fR,fU,fT,fN,fP)],fO=fS[0];var fQ=fN.widgetNode;dJ(fR,function(fW){if(fQ){fN.widgetNode=fQ.cloneNode(true)}fS.push(ei(fW,fj(fW,fU),fj(fW,fT),fN,fP));for(var fV=0;fV<fW.linked.length;++fV){if(fW.linked[fV].isParent){return}}fO=fh(fS)});return new z(fS,fO)}function er(fN){return fN.findMarks(X(fN.first,0),fN.clipPos(X(fN.lastLine())),function(fO){return fO.parent})}function dj(fS,fT){for(var fQ=0;fQ<fT.length;fQ++){var fO=fT[fQ],fU=fO.find();var fN=fS.clipPos(fU.from),fR=fS.clipPos(fU.to);if(b3(fN,fR)){var fP=ei(fS,fN,fR,fO.primary,fO.primary.type);fO.markers.push(fP);fP.parent=fO}}}function dZ(fQ){for(var fP=0;fP<fQ.length;fP++){var fN=fQ[fP],fS=[fN.primary.doc];dJ(fN.primary.doc,function(fT){fS.push(fT)});for(var fO=0;fO<fN.markers.length;fO++){var fR=fN.markers[fO];if(c0(fS,fR.doc)==-1){fR.parent=null;fN.markers.splice(fO--,1)}}}}function dT(fN,fP,fO){this.marker=fN;this.from=fP;this.to=fO}function eI(fP,fN){if(fP){for(var fO=0;fO<fP.length;++fO){var fQ=fP[fO];if(fQ.marker==fN){return fQ}}}}function ek(fO,fP){for(var fQ,fN=0;fN<fO.length;++fN){if(fO[fN]!=fP){(fQ||(fQ=[])).push(fO[fN])}}return fQ}function b1(fN,fO){fN.markedSpans=fN.markedSpans?fN.markedSpans.concat([fO]):[fO];fO.marker.attachLine(fN)}function aI(fO,fP,fT){if(fO){for(var fR=0,fU;fR<fO.length;++fR){var fV=fO[fR],fS=fV.marker;var fN=fV.from==null||(fS.inclusiveLeft?fV.from<=fP:fV.from<fP);if(fN||fV.from==fP&&fS.type=="bookmark"&&(!fT||!fV.marker.insertLeft)){var fQ=fV.to==null||(fS.inclusiveRight?fV.to>=fP:fV.to>fP);(fU||(fU=[])).push(new dT(fS,fV.from,fQ?null:fV.to))}}}return fU}function ay(fO,fQ,fT){if(fO){for(var fR=0,fU;fR<fO.length;++fR){var fV=fO[fR],fS=fV.marker;var fP=fV.to==null||(fS.inclusiveRight?fV.to>=fQ:fV.to>fQ);if(fP||fV.from==fQ&&fS.type=="bookmark"&&(!fT||fV.marker.insertLeft)){var fN=fV.from==null||(fS.inclusiveLeft?fV.from<=fQ:fV.from<fQ);(fU||(fU=[])).push(new dT(fS,fN?null:fV.from-fQ,fV.to==null?null:fV.to-fQ))}}}return fU}function dV(fZ,fW){var fV=bX(fZ,fW.from.line)&&eO(fZ,fW.from.line).markedSpans;var f2=bX(fZ,fW.to.line)&&eO(fZ,fW.to.line).markedSpans;if(!fV&&!f2){return null}var fO=fW.from.ch,fR=fW.to.ch,fU=b3(fW.from,fW.to)==0;var fT=aI(fV,fO,fU);var f1=ay(f2,fR,fU);var f0=fW.text.length==1,fP=fh(fW.text).length+(f0?fO:0);if(fT){for(var fQ=0;fQ<fT.length;++fQ){var fY=fT[fQ];if(fY.to==null){var f3=eI(f1,fY.marker);if(!f3){fY.to=fO}else{if(f0){fY.to=f3.to==null?null:f3.to+fP}}}}}if(f1){for(var fQ=0;fQ<f1.length;++fQ){var fY=f1[fQ];if(fY.to!=null){fY.to+=fP}if(fY.from==null){var f3=eI(fT,fY.marker);if(!f3){fY.from=fP;if(f0){(fT||(fT=[])).push(fY)}}}else{fY.from+=fP;if(f0){(fT||(fT=[])).push(fY)}}}}if(fT){fT=s(fT)}if(f1&&f1!=fT){f1=s(f1)}var fS=[fT];if(!f0){var fX=fW.text.length-2,fN;if(fX>0&&fT){for(var fQ=0;fQ<fT.length;++fQ){if(fT[fQ].to==null){(fN||(fN=[])).push(new dT(fT[fQ].marker,null,null))}}}for(var fQ=0;fQ<fX;++fQ){fS.push(fN)}fS.push(f1)}return fS}function s(fO){for(var fN=0;fN<fO.length;++fN){var fP=fO[fN];if(fP.from!=null&&fP.from==fP.to&&fP.marker.clearWhenEmpty!==false){fO.splice(fN--,1)}}if(!fO.length){return null}return fO}function dL(fV,fT){var fN=bT(fV,fT);var fW=dV(fV,fT);if(!fN){return fW}if(!fW){return fN}for(var fQ=0;fQ<fN.length;++fQ){var fR=fN[fQ],fS=fW[fQ];if(fR&&fS){spans:for(var fP=0;fP<fS.length;++fP){var fU=fS[fP];for(var fO=0;fO<fR.length;++fO){if(fR[fO].marker==fU.marker){continue spans}}fR.push(fU)}}else{if(fS){fN[fQ]=fS}}}return fN}function ct(fZ,fX,fY){var fR=null;fZ.iter(fX.line,fY.line+1,function(f0){if(f0.markedSpans){for(var f1=0;f1<f0.markedSpans.length;++f1){var f2=f0.markedSpans[f1].marker;if(f2.readOnly&&(!fR||c0(fR,f2)==-1)){(fR||(fR=[])).push(f2)}}}});if(!fR){return null}var fS=[{from:fX,to:fY}];for(var fT=0;fT<fR.length;++fT){var fU=fR[fT],fP=fU.find(0);for(var fQ=0;fQ<fS.length;++fQ){var fO=fS[fQ];if(b3(fO.to,fP.from)<0||b3(fO.from,fP.to)>0){continue}var fW=[fQ,1],fN=b3(fO.from,fP.from),fV=b3(fO.to,fP.to);if(fN<0||!fU.inclusiveLeft&&!fN){fW.push({from:fO.from,to:fP.from})}if(fV>0||!fU.inclusiveRight&&!fV){fW.push({from:fP.to,to:fO.to})}fS.splice.apply(fS,fW);fQ+=fW.length-1}}return fS}function fD(fN){var fP=fN.markedSpans;if(!fP){return}for(var fO=0;fO<fP.length;++fO){fP[fO].marker.detachLine(fN)}fN.markedSpans=null}function cL(fN,fP){if(!fP){return}for(var fO=0;fO<fP.length;++fO){fP[fO].marker.attachLine(fN)}fN.markedSpans=fP}function x(fN){return fN.inclusiveLeft?-1:0}function bM(fN){return fN.inclusiveRight?1:0}function dt(fQ,fO){var fS=fQ.lines.length-fO.lines.length;if(fS!=0){return fS}var fP=fQ.find(),fT=fO.find();var fN=b3(fP.from,fT.from)||x(fQ)-x(fO);if(fN){return -fN}var fR=b3(fP.to,fT.to)||bM(fQ)-bM(fO);if(fR){return fR}return fO.id-fQ.id}function aX(fO,fS){var fN=aY&&fO.markedSpans,fR;if(fN){for(var fQ,fP=0;fP<fN.length;++fP){fQ=fN[fP];if(fQ.marker.collapsed&&(fS?fQ.from:fQ.to)==null&&(!fR||dt(fR,fQ.marker)<0)){fR=fQ.marker}}}return fR}function eq(fN){return aX(fN,true)}function d6(fN){return aX(fN,false)}function B(fV,fP,fT,fU,fR){var fY=eO(fV,fP);var fN=aY&&fY.markedSpans;if(fN){for(var fQ=0;fQ<fN.length;++fQ){var fO=fN[fQ];if(!fO.marker.collapsed){continue}var fX=fO.marker.find(0);var fW=b3(fX.from,fT)||x(fO.marker)-x(fR);var fS=b3(fX.to,fU)||bM(fO.marker)-bM(fR);if(fW>=0&&fS<=0||fW<=0&&fS>=0){continue}if(fW<=0&&(b3(fX.to,fT)>0||(fO.marker.inclusiveRight&&fR.inclusiveLeft))||fW>=0&&(b3(fX.from,fU)<0||(fO.marker.inclusiveLeft&&fR.inclusiveRight))){return true}}}}function A(fO){var fN;while(fN=eq(fO)){fO=fN.find(-1,true).line}return fO}function i(fP){var fN,fO;while(fN=d6(fP)){fP=fN.find(1,true).line;(fO||(fO=[])).push(fP)}return fO}function aN(fQ,fO){var fN=eO(fQ,fO),fP=A(fN);if(fN==fP){return fO}return bD(fP)}function dF(fQ,fP){if(fP>fQ.lastLine()){return fP}var fO=eO(fQ,fP),fN;if(!e6(fQ,fO)){return fP}while(fN=d6(fO)){fO=fN.find(1,true).line}return bD(fO)+1}function e6(fR,fO){var fN=aY&&fO.markedSpans;if(fN){for(var fQ,fP=0;fP<fN.length;++fP){fQ=fN[fP];if(!fQ.marker.collapsed){continue}if(fQ.from==null){return true}if(fQ.marker.widgetNode){continue}if(fQ.from==0&&fQ.marker.inclusiveLeft&&U(fR,fO,fQ)){return true}}}}function U(fS,fO,fQ){if(fQ.to==null){var fN=fQ.marker.find(1,true);return U(fS,fN.line,eI(fN.line.markedSpans,fQ.marker))}if(fQ.marker.inclusiveRight&&fQ.to==fO.text.length){return true}for(var fR,fP=0;fP<fO.markedSpans.length;++fP){fR=fO.markedSpans[fP];if(fR.marker.collapsed&&!fR.marker.widgetNode&&fR.from==fQ.to&&(fR.to==null||fR.to!=fQ.from)&&(fR.marker.inclusiveLeft||fQ.marker.inclusiveRight)&&U(fS,fO,fR)){return true}}}var dg=J.LineWidget=function(fN,fQ,fO){if(fO){for(var fP in fO){if(fO.hasOwnProperty(fP)){this[fP]=fO[fP]}}}this.cm=fN;this.node=fQ};bp(dg);function dC(fN,fO,fP){if(bC(fO)<((fN.curOp&&fN.curOp.scrollTop)||fN.doc.scrollTop)){cw(fN,null,fP)}}dg.prototype.clear=function(){var fO=this.cm,fQ=this.line.widgets,fP=this.line,fS=bD(fP);if(fS==null||!fQ){return}for(var fR=0;fR<fQ.length;++fR){if(fQ[fR]==this){fQ.splice(fR--,1)}}if(!fQ.length){fP.widgets=null}var fN=cG(this);cx(fO,function(){dC(fO,fP,-fN);S(fO,fS,"widget");fA(fP,Math.max(0,fP.height-fN))})};dg.prototype.changed=function(){var fO=this.height,fN=this.cm,fP=this.line;this.height=null;var fQ=cG(this)-fO;if(!fQ){return}cx(fN,function(){fN.curOp.forceUpdate=true;dC(fN,fP,fQ);fA(fP,fP.height+fQ)})};function cG(fO){if(fO.height!=null){return fO.height}if(!fF(document.body,fO.node)){var fN="position: relative;";if(fO.coverGutter){fN+="margin-left: -"+fO.cm.getGutterElement().offsetWidth+"px;"}bH(fO.cm.display.measure,fw("div",[fO.node],null,fN))}return fO.height=fO.node.offsetHeight}function bx(fN,fR,fP,fO){var fQ=new dg(fN,fP,fO);if(fQ.noHScroll){fN.display.alignWidgets=true}ea(fN.doc,fR,"widget",function(fT){var fU=fT.widgets||(fT.widgets=[]);if(fQ.insertAt==null){fU.push(fQ)}else{fU.splice(Math.min(fU.length-1,Math.max(0,fQ.insertAt)),0,fQ)}fQ.line=fT;if(!e6(fN.doc,fT)){var fS=bC(fT)<fN.doc.scrollTop;fA(fT,fT.height+cG(fQ));if(fS){cw(fN,null,fQ.height)}fN.curOp.forceUpdate=true}return true});return fQ}var fC=J.Line=function(fP,fO,fN){this.text=fP;cL(this,fO);this.height=fN?fN(this):1};bp(fC);fC.prototype.lineNo=function(){return bD(this)};function dY(fO,fR,fP,fN){fO.text=fR;if(fO.stateAfter){fO.stateAfter=null}if(fO.styles){fO.styles=null}if(fO.order!=null){fO.order=null}fD(fO);cL(fO,fP);var fQ=fN?fN(fO):1;if(fQ!=fO.height){fA(fO,fQ)}}function br(fN){fN.parent=null;fD(fN)}function c1(fP,fO){if(fP){for(;;){var fN=fP.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!fN){break}fP=fP.slice(0,fN.index)+fP.slice(fN.index+fN[0].length);var fQ=fN[1]?"bgClass":"textClass";if(fO[fQ]==null){fO[fQ]=fN[2]}else{if(!(new RegExp("(?:^|s)"+fN[2]+"(?:$|s)")).test(fO[fQ])){fO[fQ]+=" "+fN[2]}}}}return fP}function e0(fP,fO){if(fP.blankLine){return fP.blankLine(fO)}if(!fP.innerMode){return}var fN=J.innerMode(fP,fO);if(fN.mode.blankLine){return fN.mode.blankLine(fN.state)}}function ee(fR,fQ,fP){for(var fN=0;fN<10;fN++){var fO=fR.token(fQ,fP);if(fQ.pos>fQ.start){return fO}}throw new Error("Mode "+fR.name+" failed to advance stream.")}function y(fX,fZ,fS,fO,fT,fQ,fR){var fP=fS.flattenSpans;if(fP==null){fP=fX.options.flattenSpans}var fV=0,fU=null;var fY=new ev(fZ,fX.options.tabSize),fN;if(fZ==""){c1(e0(fS,fO),fQ)}while(!fY.eol()){if(fY.pos>fX.options.maxHighlightLength){fP=false;if(fR){db(fX,fZ,fO,fY.pos)}fY.pos=fZ.length;fN=null}else{fN=c1(ee(fS,fY,fO),fQ)}if(fX.options.addModeClass){var f0=J.innerMode(fS,fO).mode.name;if(f0){fN="m-"+(fN?f0+" "+fN:f0)}}if(!fP||fU!=fN){if(fV<fY.start){fT(fY.start,fU)}fV=fY.start;fU=fN}fY.start=fY.pos}while(fV<fY.pos){var fW=Math.min(fY.pos,fV+50000);fT(fW,fU);fV=fW}}function e9(fU,fW,fN,fR){var fV=[fU.state.modeGen],fQ={};y(fU,fW.text,fU.doc.mode,fN,function(fX,fY){fV.push(fX,fY)},fQ,fR);for(var fO=0;fO<fU.state.overlays.length;++fO){var fS=fU.state.overlays[fO],fT=1,fP=0;y(fU,fW.text,fS.mode,true,function(fX,fZ){var f1=fT;while(fP<fX){var fY=fV[fT];if(fY>fX){fV.splice(fT,1,fX,fV[fT+1],fY)}fT+=2;fP=Math.min(fX,fY)}if(!fZ){return}if(fS.opaque){fV.splice(f1,fT-f1,fX,"cm-overlay "+fZ);fT=f1+2}else{for(;f1<fT;f1+=2){var f0=fV[f1+1];fV[f1+1]=(f0?f0+" ":"")+"cm-overlay "+fZ}}},fQ)}return{styles:fV,classes:fQ.bgClass||fQ.textClass?fQ:null}}function cP(fO,fP){if(!fP.styles||fP.styles[0]!=fO.state.modeGen){var fN=e9(fO,fP,fP.stateAfter=df(fO,bD(fP)));fP.styles=fN.styles;if(fN.classes){fP.styleClasses=fN.classes}else{if(fP.styleClasses){fP.styleClasses=null}}}return fP.styles}function db(fN,fS,fP,fO){var fR=fN.doc.mode;var fQ=new ev(fS,fN.options.tabSize);fQ.start=fQ.pos=fO||0;if(fS==""){e0(fR,fP)}while(!fQ.eol()&&fQ.pos<=fN.options.maxHighlightLength){ee(fR,fQ,fP);fQ.start=fQ.pos}}var dy={},bR={};function ey(fP,fO){if(!fP||/^\s*$/.test(fP)){return null}var fN=fO.addModeClass?bR:dy;return fN[fP]||(fN[fP]=fP.replace(/\S+/g,"cm-$&"))}function eu(fO,fS){var fT=fw("span",null,null,cI?"padding-right: .1px":null);var fQ={pre:fw("pre",[fT]),content:fT,col:0,pos:0,cm:fO};fS.measure={};for(var fR=0;fR<=(fS.rest?fS.rest.length:0);fR++){var fP=fR?fS.rest[fR-1]:fS.line,fN;fQ.pos=0;fQ.addToken=v;if((dm||cI)&&fO.getOption("lineWrapping")){fQ.addToken=ff(fQ.addToken)}if(bE(fO.display.measure)&&(fN=a(fP))){fQ.addToken=V(fQ.addToken,fN)}fQ.map=[];bg(fP,fQ,cP(fO,fP));if(fP.styleClasses){if(fP.styleClasses.bgClass){fQ.bgClass=fr(fP.styleClasses.bgClass,fQ.bgClass||"")}if(fP.styleClasses.textClass){fQ.textClass=fr(fP.styleClasses.textClass,fQ.textClass||"")}}if(fQ.map.length==0){fQ.map.push(0,0,fQ.content.appendChild(be(fO.display.measure)))}if(fR==0){fS.measure.map=fQ.map;fS.measure.cache={}}else{(fS.measure.maps||(fS.measure.maps=[])).push(fQ.map);(fS.measure.caches||(fS.measure.caches=[])).push({})}}aA(fO,"renderLine",fO,fS.line,fQ.pre);if(fQ.pre.className){fQ.textClass=fr(fQ.pre.className,fQ.textClass||"")}return fQ}function eM(fO){var fN=fw("span","\u2022","cm-invalidchar");fN.title="\\u"+fO.charCodeAt(0).toString(16);return fN}function v(fS,f2,fN,fQ,f3,f1){if(!f2){return}var fX=fS.cm.options.specialChars,fW=false;if(!fX.test(f2)){fS.col+=f2.length;var fV=document.createTextNode(f2);fS.map.push(fS.pos,fS.pos+f2.length,fV);if(dm&&m<9){fW=true}fS.pos+=f2.length}else{var fV=document.createDocumentFragment(),fZ=0;while(true){fX.lastIndex=fZ;var fO=fX.exec(f2);var fU=fO?fO.index-fZ:f2.length-fZ;if(fU){var fR=document.createTextNode(f2.slice(fZ,fZ+fU));if(dm&&m<9){fV.appendChild(fw("span",[fR]))}else{fV.appendChild(fR)}fS.map.push(fS.pos,fS.pos+fU,fR);fS.col+=fU;fS.pos+=fU}if(!fO){break}fZ+=fU+1;if(fO[0]=="\t"){var fT=fS.cm.options.tabSize,fY=fT-fS.col%fT;var fR=fV.appendChild(fw("span",cd(fY),"cm-tab"));fS.col+=fY}else{var fR=fS.cm.options.specialCharPlaceholder(fO[0]);if(dm&&m<9){fV.appendChild(fw("span",[fR]))}else{fV.appendChild(fR)}fS.col+=1}fS.map.push(fS.pos,fS.pos+1,fR);fS.pos++}}if(fN||fQ||f3||fW){var f0=fN||"";if(fQ){f0+=fQ}if(f3){f0+=f3}var fP=fw("span",[fV],f0);if(f1){fP.title=f1}return fS.content.appendChild(fP)}fS.content.appendChild(fV)}function ff(fN){function fO(fP){var fQ=" ";for(var fR=0;fR<fP.length-2;++fR){fQ+=fR%2?" ":"\u00a0"}fQ+=" ";return fQ}return function(fQ,fU,fR,fP,fT,fS){fN(fQ,fU.replace(/ {3,}/g,fO),fR,fP,fT,fS)}}function V(fO,fN){return function(fV,fX,fP,fT,fY,fW){fP=fP?fP+" cm-force-border":"cm-force-border";var fQ=fV.pos,fS=fQ+fX.length;for(;;){for(var fU=0;fU<fN.length;fU++){var fR=fN[fU];if(fR.to>fQ&&fR.from<=fQ){break}}if(fR.to>=fS){return fO(fV,fX,fP,fT,fY,fW)}fO(fV,fX.slice(0,fR.to-fQ),fP,fT,null,fW);fT=null;fX=fX.slice(fR.to-fQ);fQ=fR.to}}}function ab(fO,fQ,fN,fP){var fR=!fP&&fN.widgetNode;if(fR){fO.map.push(fO.pos,fO.pos+fQ,fR);fO.content.appendChild(fR)}fO.pos+=fQ}function bg(fW,f2,fV){var fS=fW.markedSpans,fU=fW.text,f0=0;if(!fS){for(var f5=1;f5<fV.length;f5+=2){f2.addToken(f2,fU.slice(f0,f0=fV[f5]),ey(fV[f5+1],f2.cm.options))}return}var f6=fU.length,fR=0,f5=1,fY="",f7;var f9=0,fN,f8,fZ,ga,fP;for(;;){if(f9==fR){fN=f8=fZ=ga="";fP=null;f9=Infinity;var fT=[];for(var f3=0;f3<fS.length;++f3){var f4=fS[f3],f1=f4.marker;if(f4.from<=fR&&(f4.to==null||f4.to>fR)){if(f4.to!=null&&f9>f4.to){f9=f4.to;f8=""}if(f1.className){fN+=" "+f1.className}if(f1.startStyle&&f4.from==fR){fZ+=" "+f1.startStyle}if(f1.endStyle&&f4.to==f9){f8+=" "+f1.endStyle}if(f1.title&&!ga){ga=f1.title}if(f1.collapsed&&(!fP||dt(fP.marker,f1)<0)){fP=f4}}else{if(f4.from>fR&&f9>f4.from){f9=f4.from}}if(f1.type=="bookmark"&&f4.from==fR&&f1.widgetNode){fT.push(f1)}}if(fP&&(fP.from||0)==fR){ab(f2,(fP.to==null?f6+1:fP.to)-fR,fP.marker,fP.from==null);if(fP.to==null){return}}if(!fP&&fT.length){for(var f3=0;f3<fT.length;++f3){ab(f2,0,fT[f3])}}}if(fR>=f6){break}var fX=Math.min(f6,f9);while(true){if(fY){var fO=fR+fY.length;if(!fP){var fQ=fO>fX?fY.slice(0,fX-fR):fY;f2.addToken(f2,fQ,f7?f7+fN:fN,fZ,fR+fQ.length==f9?f8:"",ga)}if(fO>=fX){fY=fY.slice(fX-fR);fR=fX;break}fR=fO;fZ=""}fY=fU.slice(f0,f0=fV[f5++]);f7=ey(fV[f5++],f2.cm.options)}}}function dv(fN,fO){return fO.from.ch==0&&fO.to.ch==0&&fh(fO.text)==""&&(!fN.cm||fN.cm.options.wholeLineUpdateBefore)}function e8(f0,fV,fN,fR){function f1(f3){return fN?fN[f3]:null}function fO(f3,f5,f4){dY(f3,f5,f4,fR);ad(f3,"change",f3,fV)}var fY=fV.from,fZ=fV.to,f2=fV.text;var fW=eO(f0,fY.line),fX=eO(f0,fZ.line);var fU=fh(f2),fQ=f1(f2.length-1),fT=fZ.line-fY.line;if(dv(f0,fV)){for(var fP=0,fS=[];fP<f2.length-1;++fP){fS.push(new fC(f2[fP],f1(fP),fR))}fO(fX,fX.text,fQ);if(fT){f0.remove(fY.line,fT)}if(fS.length){f0.insert(fY.line,fS)}}else{if(fW==fX){if(f2.length==1){fO(fW,fW.text.slice(0,fY.ch)+fU+fW.text.slice(fZ.ch),fQ)}else{for(var fS=[],fP=1;fP<f2.length-1;++fP){fS.push(new fC(f2[fP],f1(fP),fR))}fS.push(new fC(fU+fW.text.slice(fZ.ch),fQ,fR));fO(fW,fW.text.slice(0,fY.ch)+f2[0],f1(0));f0.insert(fY.line+1,fS)}}else{if(f2.length==1){fO(fW,fW.text.slice(0,fY.ch)+f2[0]+fX.text.slice(fZ.ch),f1(0));f0.remove(fY.line+1,fT)}else{fO(fW,fW.text.slice(0,fY.ch)+f2[0],f1(0));fO(fX,fU+fX.text.slice(fZ.ch),fQ);for(var fP=1,fS=[];fP<f2.length-1;++fP){fS.push(new fC(f2[fP],f1(fP),fR))}if(fT>1){f0.remove(fY.line+1,fT-1)}f0.insert(fY.line+1,fS)}}}ad(f0,"change",f0,fV)}function eB(fO){this.lines=fO;this.parent=null;for(var fP=0,fN=0;fP<fO.length;++fP){fO[fP].parent=this;fN+=fO[fP].height}this.height=fN}eB.prototype={chunkSize:function(){return this.lines.length},removeInner:function(fN,fR){for(var fP=fN,fQ=fN+fR;fP<fQ;++fP){var fO=this.lines[fP];this.height-=fO.height;br(fO);ad(fO,"delete")}this.lines.splice(fN,fR)},collapse:function(fN){fN.push.apply(fN,this.lines)},insertInner:function(fO,fP,fN){this.height+=fN;this.lines=this.lines.slice(0,fO).concat(fP).concat(this.lines.slice(fO));for(var fQ=0;fQ<fP.length;++fQ){fP[fQ].parent=this}},iterN:function(fN,fQ,fP){for(var fO=fN+fQ;fN<fO;++fN){if(fP(this.lines[fN])){return true}}}};function e7(fQ){this.children=fQ;var fP=0,fN=0;for(var fO=0;fO<fQ.length;++fO){var fR=fQ[fO];fP+=fR.chunkSize();fN+=fR.height;fR.parent=this}this.size=fP;this.height=fN;this.parent=null}e7.prototype={chunkSize:function(){return this.size},removeInner:function(fN,fU){this.size-=fU;for(var fP=0;fP<this.children.length;++fP){var fT=this.children[fP],fR=fT.chunkSize();if(fN<fR){var fQ=Math.min(fU,fR-fN),fS=fT.height;fT.removeInner(fN,fQ);this.height-=fS-fT.height;if(fR==fQ){this.children.splice(fP--,1);fT.parent=null}if((fU-=fQ)==0){break}fN=0}else{fN-=fR}}if(this.size-fU<25&&(this.children.length>1||!(this.children[0] instanceof eB))){var fO=[];this.collapse(fO);this.children=[new eB(fO)];this.children[0].parent=this}},collapse:function(fN){for(var fO=0;fO<this.children.length;++fO){this.children[fO].collapse(fN)}},insertInner:function(fO,fP,fN){this.size+=fP.length;this.height+=fN;for(var fS=0;fS<this.children.length;++fS){var fU=this.children[fS],fT=fU.chunkSize();if(fO<=fT){fU.insertInner(fO,fP,fN);if(fU.lines&&fU.lines.length>50){while(fU.lines.length>50){var fR=fU.lines.splice(fU.lines.length-25,25);var fQ=new eB(fR);fU.height-=fQ.height;this.children.splice(fS+1,0,fQ);fQ.parent=this}this.maybeSpill()}break}fO-=fT}},maybeSpill:function(){if(this.children.length<=10){return}var fQ=this;do{var fO=fQ.children.splice(fQ.children.length-5,5);var fP=new e7(fO);if(!fQ.parent){var fR=new e7(fQ.children);fR.parent=fQ;fQ.children=[fR,fP];fQ=fR}else{fQ.size-=fP.size;fQ.height-=fP.height;var fN=c0(fQ.parent.children,fQ);fQ.parent.children.splice(fN+1,0,fP)}fP.parent=fQ.parent}while(fQ.children.length>10);fQ.parent.maybeSpill()},iterN:function(fN,fT,fS){for(var fO=0;fO<this.children.length;++fO){var fR=this.children[fO],fQ=fR.chunkSize();if(fN<fQ){var fP=Math.min(fT,fQ-fN);if(fR.iterN(fN,fP,fS)){return true}if((fT-=fP)==0){break}fN=0}else{fN-=fQ}}}};var ce=0;var ap=J.Doc=function(fP,fO,fN){if(!(this instanceof ap)){return new ap(fP,fO,fN)}if(fN==null){fN=0}e7.call(this,[new eB([new fC("",null)])]);this.first=fN;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=fN;var fQ=X(fN,0);this.sel=et(fQ);this.history=new fs(null);this.id=++ce;this.modeOption=fO;if(typeof fP=="string"){fP=aR(fP)}e8(this,{from:fQ,to:fQ,text:fP});bK(this,et(fQ),Z)};ap.prototype=b8(e7.prototype,{constructor:ap,iter:function(fP,fO,fN){if(fN){this.iterN(fP-this.first,fO-fP,fN)}else{this.iterN(this.first,this.first+this.size,fP)}},insert:function(fO,fP){var fN=0;for(var fQ=0;fQ<fP.length;++fQ){fN+=fP[fQ].height}this.insertInner(fO-this.first,fP,fN)},remove:function(fN,fO){this.removeInner(fN-this.first,fO)},getValue:function(fO){var fN=aT(this,this.first,this.first+this.size);if(fO===false){return fN}return fN.join(fO||"\n")},setValue:cq(function(fO){var fP=X(this.first,0),fN=this.first+this.size-1;a6(this,{from:fP,to:X(fN,eO(this,fN).text.length),text:aR(fO),origin:"setValue"},true);bK(this,et(fP))}),replaceRange:function(fO,fQ,fP,fN){fQ=fj(this,fQ);fP=fP?fj(this,fP):fQ;aS(this,fO,fQ,fP,fN)},getRange:function(fQ,fP,fO){var fN=fy(this,fj(this,fQ),fj(this,fP));if(fO===false){return fN}return fN.join(fO||"\n")},getLine:function(fO){var fN=this.getLineHandle(fO);return fN&&fN.text},getLineHandle:function(fN){if(bX(this,fN)){return eO(this,fN)}},getLineNumber:function(fN){return bD(fN)},getLineHandleVisualStart:function(fN){if(typeof fN=="number"){fN=eO(this,fN)}return A(fN)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(fN){return fj(this,fN)},getCursor:function(fP){var fN=this.sel.primary(),fO;if(fP==null||fP=="head"){fO=fN.head}else{if(fP=="anchor"){fO=fN.anchor}else{if(fP=="end"||fP=="to"||fP===false){fO=fN.to()}else{fO=fN.from()}}}return fO},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:cq(function(fN,fP,fO){H(this,fj(this,typeof fN=="number"?X(fN,fP||0):fN),null,fO)}),setSelection:cq(function(fO,fP,fN){H(this,fj(this,fO),fj(this,fP||fO),fN)}),extendSelection:cq(function(fP,fN,fO){ft(this,fj(this,fP),fN&&fj(this,fN),fO)}),extendSelections:cq(function(fO,fN){au(this,dB(this,fO,fN))}),extendSelectionsBy:cq(function(fO,fN){au(this,bI(this.sel.ranges,fO),fN)}),setSelections:cq(function(fN,fR,fP){if(!fN.length){return}for(var fQ=0,fO=[];fQ<fN.length;fQ++){fO[fQ]=new dA(fj(this,fN[fQ].anchor),fj(this,fN[fQ].head))}if(fR==null){fR=Math.min(fN.length-1,this.sel.primIndex)}bK(this,ck(fO,fR),fP)}),addSelection:cq(function(fP,fQ,fO){var fN=this.sel.ranges.slice(0);fN.push(new dA(fj(this,fP),fj(this,fQ||fP)));bK(this,ck(fN,fN.length-1),fO)}),getSelection:function(fR){var fO=this.sel.ranges,fN;for(var fP=0;fP<fO.length;fP++){var fQ=fy(this,fO[fP].from(),fO[fP].to());fN=fN?fN.concat(fQ):fQ}if(fR===false){return fN}else{return fN.join(fR||"\n")}},getSelections:function(fR){var fQ=[],fN=this.sel.ranges;for(var fO=0;fO<fN.length;fO++){var fP=fy(this,fN[fO].from(),fN[fO].to());if(fR!==false){fP=fP.join(fR||"\n")}fQ[fO]=fP}return fQ},replaceSelection:function(fP,fR,fN){var fQ=[];for(var fO=0;fO<this.sel.ranges.length;fO++){fQ[fO]=fP}this.replaceSelections(fQ,fR,fN||"+input")},replaceSelections:cq(function(fS,fU,fP){var fR=[],fT=this.sel;for(var fQ=0;fQ<fT.ranges.length;fQ++){var fO=fT.ranges[fQ];fR[fQ]={from:fO.from(),to:fO.to(),text:aR(fS[fQ]),origin:fP}}var fN=fU&&fU!="end"&&ae(this,fR,fU);for(var fQ=fR.length-1;fQ>=0;fQ--){a6(this,fR[fQ])}if(fN){eG(this,fN)}else{if(this.cm){fg(this.cm)}}}),undo:cq(function(){bW(this,"undo")}),redo:cq(function(){bW(this,"redo")}),undoSelection:cq(function(){bW(this,"undo",true)}),redoSelection:cq(function(){bW(this,"redo",true)}),setExtending:function(fN){this.extend=fN},getExtending:function(){return this.extend},historySize:function(){var fQ=this.history,fN=0,fP=0;for(var fO=0;fO<fQ.done.length;fO++){if(!fQ.done[fO].ranges){++fN}}for(var fO=0;fO<fQ.undone.length;fO++){if(!fQ.undone[fO].ranges){++fP}}return{undo:fN,redo:fP}},clearHistory:function(){this.history=new fs(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(fN){if(fN){this.history.lastOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(fN){return this.history.generation==(fN||this.cleanGeneration)},getHistory:function(){return{done:bF(this.history.done),undone:bF(this.history.undone)}},setHistory:function(fO){var fN=this.history=new fs(this.history.maxGeneration);fN.done=bF(fO.done.slice(0),null,true);fN.undone=bF(fO.undone.slice(0),null,true)},addLineClass:cq(function(fP,fO,fN){return ea(this,fP,"class",function(fQ){var fR=fO=="text"?"textClass":fO=="background"?"bgClass":"wrapClass";if(!fQ[fR]){fQ[fR]=fN}else{if(new RegExp("(?:^|\\s)"+fN+"(?:$|\\s)").test(fQ[fR])){return false}else{fQ[fR]+=" "+fN}}return true})}),removeLineClass:cq(function(fP,fO,fN){return ea(this,fP,"class",function(fR){var fU=fO=="text"?"textClass":fO=="background"?"bgClass":"wrapClass";var fT=fR[fU];if(!fT){return false}else{if(fN==null){fR[fU]=null}else{var fS=fT.match(new RegExp("(?:^|\\s+)"+fN+"(?:$|\\s+)"));if(!fS){return false}var fQ=fS.index+fS[0].length;fR[fU]=fT.slice(0,fS.index)+(!fS.index||fQ==fT.length?"":" ")+fT.slice(fQ)||null}}return true})}),markText:function(fP,fO,fN){return ei(this,fj(this,fP),fj(this,fO),fN,"range")},setBookmark:function(fP,fN){var fO={replacedWith:fN&&(fN.nodeType==null?fN.widget:fN),insertLeft:fN&&fN.insertLeft,clearWhenEmpty:false,shared:fN&&fN.shared};fP=fj(this,fP);return ei(this,fP,fP,fO,"bookmark")},findMarksAt:function(fR){fR=fj(this,fR);var fQ=[],fO=eO(this,fR.line).markedSpans;if(fO){for(var fN=0;fN<fO.length;++fN){var fP=fO[fN];if((fP.from==null||fP.from<=fR.ch)&&(fP.to==null||fP.to>=fR.ch)){fQ.push(fP.marker.parent||fP.marker)}}}return fQ},findMarks:function(fR,fQ,fN){fR=fj(this,fR);fQ=fj(this,fQ);var fO=[],fP=fR.line;this.iter(fR.line,fQ.line+1,function(fS){var fU=fS.markedSpans;if(fU){for(var fT=0;fT<fU.length;fT++){var fV=fU[fT];if(!(fP==fR.line&&fR.ch>fV.to||fV.from==null&&fP!=fR.line||fP==fQ.line&&fV.from>fQ.ch)&&(!fN||fN(fV.marker))){fO.push(fV.marker.parent||fV.marker)}}}++fP});return fO},getAllMarks:function(){var fN=[];this.iter(function(fP){var fO=fP.markedSpans;if(fO){for(var fQ=0;fQ<fO.length;++fQ){if(fO[fQ].from!=null){fN.push(fO[fQ].marker)}}}});return fN},posFromIndex:function(fO){var fN,fP=this.first;this.iter(function(fQ){var fR=fQ.text.length+1;if(fR>fO){fN=fO;return true}fO-=fR;++fP});return fj(this,X(fP,fN))},indexFromPos:function(fO){fO=fj(this,fO);var fN=fO.ch;if(fO.line<this.first||fO.ch<0){return 0}this.iter(this.first,fO.line,function(fP){fN+=fP.text.length+1});return fN},copy:function(fN){var fO=new ap(aT(this,this.first,this.first+this.size),this.modeOption,this.first);fO.scrollTop=this.scrollTop;fO.scrollLeft=this.scrollLeft;fO.sel=this.sel;fO.extend=false;if(fN){fO.history.undoDepth=this.history.undoDepth;fO.setHistory(this.getHistory())}return fO},linkedDoc:function(fN){if(!fN){fN={}}var fQ=this.first,fP=this.first+this.size;if(fN.from!=null&&fN.from>fQ){fQ=fN.from}if(fN.to!=null&&fN.to<fP){fP=fN.to}var fO=new ap(aT(this,fQ,fP),fN.mode||this.modeOption,fQ);if(fN.sharedHist){fO.history=this.history}(this.linked||(this.linked=[])).push({doc:fO,sharedHist:fN.sharedHist});fO.linked=[{doc:this,isParent:true,sharedHist:fN.sharedHist}];dj(fO,er(this));return fO},unlinkDoc:function(fO){if(fO instanceof J){fO=fO.doc}if(this.linked){for(var fP=0;fP<this.linked.length;++fP){var fQ=this.linked[fP];if(fQ.doc!=fO){continue}this.linked.splice(fP,1);fO.unlinkDoc(this);dZ(er(this));break}}if(fO.history==this.history){var fN=[fO.id];dJ(fO,function(fR){fN.push(fR.id)},true);fO.history=new fs(null);fO.history.done=bF(this.history.done,fN);fO.history.undone=bF(this.history.undone,fN)}},iterLinkedDocs:function(fN){dJ(this,fN)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});ap.prototype.eachLine=ap.prototype.iter;var e="iter insert remove copy getEditor".split(" ");for(var bA in ap.prototype){if(ap.prototype.hasOwnProperty(bA)&&c0(e,bA)<0){J.prototype[bA]=(function(fN){return function(){return fN.apply(this.doc,arguments)}})(ap.prototype[bA])}}bp(ap);function dJ(fQ,fP,fO){function fN(fW,fU,fS){if(fW.linked){for(var fT=0;fT<fW.linked.length;++fT){var fR=fW.linked[fT];if(fR.doc==fU){continue}var fV=fS&&fR.sharedHist;if(fO&&!fV){continue}fP(fR.doc,fV);fN(fR.doc,fW,fV)}}}fN(fQ,null,true)}function dM(fN,fO){if(fO.cm){throw new Error("This document is already in use.")}fN.doc=fO;fO.cm=fN;Y(fN);bi(fN);if(!fN.options.lineWrapping){h(fN)}fN.options.mode=fO.modeOption;ag(fN)}function eO(fQ,fS){fS-=fQ.first;if(fS<0||fS>=fQ.size){throw new Error("There is no line "+(fS+fQ.first)+" in the document.")}for(var fN=fQ;!fN.lines;){for(var fO=0;;++fO){var fR=fN.children[fO],fP=fR.chunkSize();if(fS<fP){fN=fR;break}fS-=fP}}return fN.lines[fS]}function fy(fP,fR,fN){var fO=[],fQ=fR.line;fP.iter(fR.line,fN.line+1,function(fS){var fT=fS.text;if(fQ==fN.line){fT=fT.slice(0,fN.ch)}if(fQ==fR.line){fT=fT.slice(fR.ch)}fO.push(fT);++fQ});return fO}function aT(fO,fQ,fP){var fN=[];fO.iter(fQ,fP,function(fR){fN.push(fR.text)});return fN}function fA(fO,fN){var fP=fN-fO.height;if(fP){for(var fQ=fO;fQ;fQ=fQ.parent){fQ.height+=fP}}}function bD(fN){if(fN.parent==null){return null}var fR=fN.parent,fQ=c0(fR.lines,fN);for(var fO=fR.parent;fO;fR=fO,fO=fO.parent){for(var fP=0;;++fP){if(fO.children[fP]==fR){break}fQ+=fO.children[fP].chunkSize()}}return fQ+fR.first}function bw(fP,fS){var fU=fP.first;outer:do{for(var fQ=0;fQ<fP.children.length;++fQ){var fT=fP.children[fQ],fR=fT.height;if(fS<fR){fP=fT;continue outer}fS-=fR;fU+=fT.chunkSize()}return fU}while(!fP.lines);for(var fQ=0;fQ<fP.lines.length;++fQ){var fO=fP.lines[fQ],fN=fO.height;if(fS<fN){break}fS-=fN}return fU+fQ}function bC(fP){fP=A(fP);var fR=0,fO=fP.parent;for(var fQ=0;fQ<fO.lines.length;++fQ){var fN=fO.lines[fQ];if(fN==fP){break}else{fR+=fN.height}}for(var fS=fO.parent;fS;fO=fS,fS=fO.parent){for(var fQ=0;fQ<fS.children.length;++fQ){var fT=fS.children[fQ];if(fT==fO){break}else{fR+=fT.height}}}return fR}function a(fO){var fN=fO.order;if(fN==null){fN=fO.order=a7(fO.text)}return fN}function fs(fN){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=fN||1}function c9(fN,fP){var fO={from:b7(fP.from),to:cF(fP),text:fy(fN,fP.from,fP.to)};bO(fN,fO,fP.from.line,fP.to.line+1);dJ(fN,function(fQ){bO(fQ,fO,fP.from.line,fP.to.line+1)},true);return fO}function fb(fO){while(fO.length){var fN=fh(fO);if(fN.ranges){fO.pop()}else{break}}}function ep(fO,fN){if(fN){fb(fO.done);return fh(fO.done)}else{if(fO.done.length&&!fh(fO.done).ranges){return fh(fO.done)}else{if(fO.done.length>1&&!fO.done[fO.done.length-2].ranges){fO.done.pop();return fh(fO.done)}}}}function fm(fT,fR,fN,fQ){var fP=fT.history;fP.undone.length=0;var fO=+new Date,fU;if((fP.lastOp==fQ||fP.lastOrigin==fR.origin&&fR.origin&&((fR.origin.charAt(0)=="+"&&fT.cm&&fP.lastModTime>fO-fT.cm.options.historyEventDelay)||fR.origin.charAt(0)=="*"))&&(fU=ep(fP,fP.lastOp==fQ))){var fV=fh(fU.changes);if(b3(fR.from,fR.to)==0&&b3(fR.from,fV.to)==0){fV.to=cF(fR)}else{fU.changes.push(c9(fT,fR))}}else{var fS=fh(fP.done);if(!fS||!fS.ranges){cy(fT.sel,fP.done)}fU={changes:[c9(fT,fR)],generation:fP.generation};fP.done.push(fU);while(fP.done.length>fP.undoDepth){fP.done.shift();if(!fP.done[0].ranges){fP.done.shift()}}}fP.done.push(fN);fP.generation=++fP.maxGeneration;fP.lastModTime=fP.lastSelTime=fO;fP.lastOp=fQ;fP.lastOrigin=fP.lastSelOrigin=fR.origin;if(!fV){aA(fT,"historyAdded")}}function bq(fR,fN,fP,fQ){var fO=fN.charAt(0);return fO=="*"||fO=="+"&&fP.ranges.length==fQ.ranges.length&&fP.somethingSelected()==fQ.somethingSelected()&&new Date-fR.history.lastSelTime<=(fR.cm?fR.cm.options.historyEventDelay:500)}function fG(fS,fQ,fN,fP){var fR=fS.history,fO=fP&&fP.origin;if(fN==fR.lastOp||(fO&&fR.lastSelOrigin==fO&&(fR.lastModTime==fR.lastSelTime&&fR.lastOrigin==fO||bq(fS,fO,fh(fR.done),fQ)))){fR.done[fR.done.length-1]=fQ}else{cy(fQ,fR.done)}fR.lastSelTime=+new Date;fR.lastSelOrigin=fO;fR.lastOp=fN;if(fP&&fP.clearRedo!==false){fb(fR.undone)}}function cy(fO,fN){var fP=fh(fN);if(!(fP&&fP.ranges&&fP.equals(fO))){fN.push(fO)}}function bO(fO,fS,fR,fQ){var fN=fS["spans_"+fO.id],fP=0;fO.iter(Math.max(fO.first,fR),Math.min(fO.first+fO.size,fQ),function(fT){if(fT.markedSpans){(fN||(fN=fS["spans_"+fO.id]={}))[fP]=fT.markedSpans}++fP})}function bc(fP){if(!fP){return null}for(var fO=0,fN;fO<fP.length;++fO){if(fP[fO].marker.explicitlyCleared){if(!fN){fN=fP.slice(0,fO)}}else{if(fN){fN.push(fP[fO])}}}return !fN?fP:fN.length?fN:null}function bT(fQ,fR){var fP=fR["spans_"+fQ.id];if(!fP){return null}for(var fO=0,fN=[];fO<fR.text.length;++fO){fN.push(bc(fP[fO]))}return fN}function bF(fY,fQ,fX){for(var fT=0,fO=[];fT<fY.length;++fT){var fP=fY[fT];if(fP.ranges){fO.push(fX?fx.prototype.deepCopy.call(fP):fP);continue}var fV=fP.changes,fW=[];fO.push({changes:fW});for(var fS=0;fS<fV.length;++fS){var fU=fV[fS],fR;fW.push({from:fU.from,to:fU.to,text:fU.text});if(fQ){for(var fN in fU){if(fR=fN.match(/^spans_(\d+)$/)){if(c0(fQ,Number(fR[1]))>-1){fh(fW)[fN]=fU[fN];delete fU[fN]}}}}}}return fO}function K(fQ,fP,fO,fN){if(fO<fQ.line){fQ.line+=fN}else{if(fP<fQ.line){fQ.line=fP;fQ.ch=0}}}function eQ(fQ,fS,fT,fU){for(var fP=0;fP<fQ.length;++fP){var fN=fQ[fP],fR=true;if(fN.ranges){if(!fN.copied){fN=fQ[fP]=fN.deepCopy();fN.copied=true}for(var fO=0;fO<fN.ranges.length;fO++){K(fN.ranges[fO].anchor,fS,fT,fU);K(fN.ranges[fO].head,fS,fT,fU)}continue}for(var fO=0;fO<fN.changes.length;++fO){var fV=fN.changes[fO];if(fT<fV.from.line){fV.from=X(fV.from.line+fU,fV.from.ch);fV.to=X(fV.to.line+fU,fV.to.ch)}else{if(fS<=fV.to.line){fR=false;break}}}if(!fR){fQ.splice(0,fP+1);fP=0}}}function di(fO,fR){var fQ=fR.from.line,fP=fR.to.line,fN=fR.text.length-(fP-fQ)-1;eQ(fO.done,fQ,fP,fN);eQ(fO.undone,fQ,fP,fN)}var cs=J.e_preventDefault=function(fN){if(fN.preventDefault){fN.preventDefault()}else{fN.returnValue=false}};var c5=J.e_stopPropagation=function(fN){if(fN.stopPropagation){fN.stopPropagation()}else{fN.cancelBubble=true}};function bB(fN){return fN.defaultPrevented!=null?fN.defaultPrevented:fN.returnValue==false}var d2=J.e_stop=function(fN){cs(fN);c5(fN)};function M(fN){return fN.target||fN.srcElement}function fn(fO){var fN=fO.which;if(fN==null){if(fO.button&1){fN=1}else{if(fO.button&2){fN=3}else{if(fO.button&4){fN=2}}}}if(bV&&fO.ctrlKey&&fN==1){fN=3}return fN}var bN=J.on=function(fQ,fO,fP){if(fQ.addEventListener){fQ.addEventListener(fO,fP,false)}else{if(fQ.attachEvent){fQ.attachEvent("on"+fO,fP)}else{var fR=fQ._handlers||(fQ._handlers={});var fN=fR[fO]||(fR[fO]=[]);fN.push(fP)}}};var dO=J.off=function(fR,fP,fQ){if(fR.removeEventListener){fR.removeEventListener(fP,fQ,false)}else{if(fR.detachEvent){fR.detachEvent("on"+fP,fQ)}else{var fN=fR._handlers&&fR._handlers[fP];if(!fN){return}for(var fO=0;fO<fN.length;++fO){if(fN[fO]==fQ){fN.splice(fO,1);break}}}}};var aA=J.signal=function(fR,fQ){var fN=fR._handlers&&fR._handlers[fQ];if(!fN){return}var fO=Array.prototype.slice.call(arguments,2);for(var fP=0;fP<fN.length;++fP){fN[fP].apply(null,fO)}};var bf,cf=0;function ad(fS,fR){var fN=fS._handlers&&fS._handlers[fR];if(!fN){return}var fP=Array.prototype.slice.call(arguments,2);if(!bf){++cf;bf=[];setTimeout(eb,0)}function fO(fT){return function(){fT.apply(null,fP)}}for(var fQ=0;fQ<fN.length;++fQ){bf.push(fO(fN[fQ]))}}function eb(){--cf;var fN=bf;bf=null;for(var fO=0;fO<fN.length;++fO){fN[fO]()}}function aJ(fN,fP,fO){aA(fN,fO||fP.type,fN,fP);return bB(fP)||fP.codemirrorIgnore}function W(fO){var fN=fO._handlers&&fO._handlers.cursorActivity;if(!fN){return}var fQ=fO.curOp.cursorActivityHandlers||(fO.curOp.cursorActivityHandlers=[]);for(var fP=0;fP<fN.length;++fP){if(c0(fQ,fN[fP])==-1){fQ.push(fN[fP])}}}function eR(fP,fO){var fN=fP._handlers&&fP._handlers[fO];return fN&&fN.length>0}function bp(fN){fN.prototype.on=function(fO,fP){bN(this,fO,fP)};fN.prototype.off=function(fO,fP){dO(this,fO,fP)}}var bb=30;var bY=J.Pass={toString:function(){return"CodeMirror.Pass"}};var Z={scroll:false},N={origin:"*mouse"},cE={origin:"+move"};function fM(){this.id=null}fM.prototype.set=function(fN,fO){clearTimeout(this.id);this.id=setTimeout(fO,fN)};var bJ=J.countColumn=function(fQ,fO,fS,fT,fP){if(fO==null){fO=fQ.search(/[^\s\u00a0]/);if(fO==-1){fO=fQ.length}}for(var fR=fT||0,fU=fP||0;;){var fN=fQ.indexOf("\t",fR);if(fN<0||fN>=fO){return fU+(fO-fR)}fU+=fN-fR;fU+=fS-(fU%fS);fR=fN+1}};function d1(fR,fQ,fS){for(var fT=0,fP=0;;){var fO=fR.indexOf("\t",fT);if(fO==-1){fO=fR.length}var fN=fO-fT;if(fO==fR.length||fP+fN>=fQ){return fT+Math.min(fN,fQ-fP)}fP+=fO-fT;fP+=fS-(fP%fS);fT=fO+1;if(fP>=fQ){return fT}}}var aQ=[""];function cd(fN){while(aQ.length<=fN){aQ.push(fh(aQ)+" ")}return aQ[fN]}function fh(fN){return fN[fN.length-1]}var dp=function(fN){fN.select()};if(eC){dp=function(fN){fN.selectionStart=0;fN.selectionEnd=fN.value.length}}else{if(dm){dp=function(fO){try{fO.select()}catch(fN){}}}}function c0(fP,fN){for(var fO=0;fO<fP.length;++fO){if(fP[fO]==fN){return fO}}return -1}if([].indexOf){c0=function(fO,fN){return fO.indexOf(fN)}}function bI(fQ,fP){var fN=[];for(var fO=0;fO<fQ.length;fO++){fN[fO]=fP(fQ[fO],fO)}return fN}if([].map){bI=function(fO,fN){return fO.map(fN)}}function b8(fQ,fN){var fP;if(Object.create){fP=Object.create(fQ)}else{var fO=function(){};fO.prototype=fQ;fP=new fO()}if(fN){aF(fN,fP)}return fP}function aF(fP,fO,fN){if(!fO){fO={}}for(var fQ in fP){if(fP.hasOwnProperty(fQ)&&(fN!==false||!fO.hasOwnProperty(fQ))){fO[fQ]=fP[fQ]}}return fO}function cj(fO){var fN=Array.prototype.slice.call(arguments,1);return function(){return fO.apply(null,fN)}}var a3=/[\u00df\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var fd=J.isWordChar=function(fN){return/\w/.test(fN)||fN>"\x80"&&(fN.toUpperCase()!=fN.toLowerCase()||a3.test(fN))};function cn(fN,fO){if(!fO){return fd(fN)}if(fO.source.indexOf("\\w")>-1&&fd(fN)){return true}return fO.test(fN)}function ew(fN){for(var fO in fN){if(fN.hasOwnProperty(fO)&&fN[fO]){return false}}return true}var em=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function eZ(fN){return fN.charCodeAt(0)>=768&&em.test(fN)}function fw(fN,fR,fQ,fP){var fS=document.createElement(fN);if(fQ){fS.className=fQ}if(fP){fS.style.cssText=fP}if(typeof fR=="string"){fS.appendChild(document.createTextNode(fR))}else{if(fR){for(var fO=0;fO<fR.length;++fO){fS.appendChild(fR[fO])}}}return fS}var b9;if(document.createRange){b9=function(fP,fQ,fN){var fO=document.createRange();fO.setEnd(fP,fN);fO.setStart(fP,fQ);return fO}}else{b9=function(fP,fQ,fN){var fO=document.body.createTextRange();fO.moveToElementText(fP.parentNode);fO.collapse(true);fO.moveEnd("character",fN);fO.moveStart("character",fQ);return fO}}function dD(fO){for(var fN=fO.childNodes.length;fN>0;--fN){fO.removeChild(fO.firstChild)}return fO}function bH(fN,fO){return dD(fN).appendChild(fO)}function fF(fN,fO){if(fN.contains){return fN.contains(fO)}while(fO=fO.parentNode){if(fO==fN){return true}}}function dr(){return document.activeElement}if(dm&&m<11){dr=function(){try{return document.activeElement}catch(fN){return document.body}}}function T(fN){return new RegExp("\\b"+fN+"\\b\\s*")}function g(fO,fN){var fP=T(fN);if(fP.test(fO.className)){fO.className=fO.className.replace(fP,"")}}function fa(fO,fN){if(!T(fN).test(fO.className)){fO.className+=" "+fN}}function fr(fP,fN){var fO=fP.split(" ");for(var fQ=0;fQ<fO.length;fQ++){if(fO[fQ]&&!T(fO[fQ]).test(fN)){fN+=" "+fO[fQ]}}return fN}function ax(fQ){if(!document.body.getElementsByClassName){return}var fP=document.body.getElementsByClassName("CodeMirror");for(var fO=0;fO<fP.length;fO++){var fN=fP[fO].CodeMirror;if(fN){fQ(fN)}}}var cp=false;function a9(){if(cp){return}fe();cp=true}function fe(){var fN;bN(window,"resize",function(){if(fN==null){fN=setTimeout(function(){fN=null;d7=null;ax(aL)},100)}});bN(window,"blur",function(){ax(aM)})}var eo=function(){if(dm&&m<9){return false}var fN=fw("div");return"draggable" in fN||"dragDrop" in fN}();var d7;function l(fN){if(d7!=null){return d7}var fO=fw("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");bH(fN,fO);if(fO.offsetWidth){d7=fO.offsetHeight-fO.clientHeight}return d7||0}var fl;function be(fN){if(fl==null){var fO=fw("span","\u200b");bH(fN,fw("span",[fO,document.createTextNode("x")]));if(fN.firstChild.offsetHeight!=0){fl=fO.offsetWidth<=1&&fO.offsetHeight>2&&!(dm&&m<8)}}if(fl){return fw("span","\u200b")}else{return fw("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px")}}var fk;function bE(fQ){if(fk!=null){return fk}var fN=bH(fQ,document.createTextNode("A\u062eA"));var fP=b9(fN,0,1).getBoundingClientRect();if(fP.left==fP.right){return false}var fO=b9(fN,1,2).getBoundingClientRect();return fk=(fO.right-fP.right<3)}var aR=J.splitLines="\n\nb".split(/\n/).length!=3?function(fS){var fT=0,fN=[],fR=fS.length;while(fT<=fR){var fQ=fS.indexOf("\n",fT);if(fQ==-1){fQ=fS.length}var fP=fS.slice(fT,fS.charAt(fQ-1)=="\r"?fQ-1:fQ);var fO=fP.indexOf("\r");if(fO!=-1){fN.push(fP.slice(0,fO));fT+=fO+1}else{fN.push(fP);fT=fQ+1}}return fN}:function(fN){return fN.split(/\r\n?|\n/)};var bj=window.getSelection?function(fO){try{return fO.selectionStart!=fO.selectionEnd}catch(fN){return false}}:function(fP){try{var fN=fP.ownerDocument.selection.createRange()}catch(fO){}if(!fN||fN.parentElement()!=fP){return false}return fN.compareEndPoints("StartToEnd",fN)!=0};var cS=(function(){var fN=fw("div");if("oncopy" in fN){return true}fN.setAttribute("oncopy","return;");return typeof fN.oncopy=="function"})();var eP={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};J.keyNames=eP;(function(){for(var fN=0;fN<10;fN++){eP[fN+48]=eP[fN+96]=String(fN)}for(var fN=65;fN<=90;fN++){eP[fN]=String.fromCharCode(fN)}for(var fN=1;fN<=12;fN++){eP[fN+111]=eP[fN+63235]="F"+fN}})();function dG(fN,fT,fS,fR){if(!fN){return fR(fT,fS,"ltr")}var fQ=false;for(var fP=0;fP<fN.length;++fP){var fO=fN[fP];if(fO.from<fS&&fO.to>fT||fT==fS&&fO.to==fT){fR(Math.max(fO.from,fT),Math.min(fO.to,fS),fO.level==1?"rtl":"ltr");fQ=true}}if(!fQ){fR(fT,fS,"ltr")}}function dc(fN){return fN.level%2?fN.to:fN.from}function fI(fN){return fN.level%2?fN.from:fN.to}function cr(fO){var fN=a(fO);return fN?dc(fN[0]):0}function cD(fO){var fN=a(fO);if(!fN){return fO.text.length}return fI(fh(fN))}function bk(fO,fR){var fP=eO(fO.doc,fR);var fS=A(fP);if(fS!=fP){fR=bD(fS)}var fN=a(fS);var fQ=!fN?0:fN[0].level%2?cD(fS):cr(fS);return X(fR,fQ)}function ds(fP,fS){var fO,fQ=eO(fP.doc,fS);while(fO=d6(fQ)){fQ=fO.find(1,true).line;fS=null}var fN=a(fQ);var fR=!fN?fQ.text.length:fN[0].level%2?cr(fQ):cD(fQ);return X(fS==null?bD(fQ):fS,fR)}function al(fO,fP,fN){var fQ=fO[0].level;if(fP==fQ){return true}if(fN==fQ){return false}return fP<fN}var eD;function aC(fN,fR){eD=null;for(var fO=0,fP;fO<fN.length;++fO){var fQ=fN[fO];if(fQ.from<fR&&fQ.to>fR){return fO}if((fQ.from==fR||fQ.to==fR)){if(fP==null){fP=fO}else{if(al(fN,fQ.level,fN[fP].level)){if(fQ.from!=fQ.to){eD=fP}return fO}else{if(fQ.from!=fQ.to){eD=fO}return fP}}}}return fP}function eN(fN,fQ,fO,fP){if(!fP){return fQ+fO}do{fQ+=fO}while(fQ>0&&eZ(fN.text.charAt(fQ)));return fQ}function w(fN,fU,fP,fQ){var fR=a(fN);if(!fR){return ah(fN,fU,fP,fQ)}var fT=aC(fR,fU),fO=fR[fT];var fS=eN(fN,fU,fO.level%2?-fP:fP,fQ);for(;;){if(fS>fO.from&&fS<fO.to){return fS}if(fS==fO.from||fS==fO.to){if(aC(fR,fS)==fT){return fS}fO=fR[fT+=fP];return(fP>0)==fO.level%2?fO.to:fO.from}else{fO=fR[fT+=fP];if(!fO){return null}if((fP>0)==fO.level%2){fS=eN(fN,fO.to,-1,fQ)}else{fS=eN(fN,fO.from,1,fQ)}}}}function ah(fN,fR,fO,fP){var fQ=fR+fO;if(fP){while(fQ>0&&eZ(fN.text.charAt(fQ))){fQ+=fO}}return fQ<0||fQ>fN.text.length?null:fQ}var a7=(function(){var fT="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var fR="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function fQ(fX){if(fX<=247){return fT.charAt(fX)}else{if(1424<=fX&&fX<=1524){return"R"}else{if(1536<=fX&&fX<=1773){return fR.charAt(fX-1536)}else{if(1774<=fX&&fX<=2220){return"r"}else{if(8192<=fX&&fX<=8203){return"w"}else{if(fX==8204){return"b"}else{return"L"}}}}}}}var fN=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var fW=/[stwN]/,fP=/[LRr]/,fO=/[Lb1n]/,fS=/[1n]/;var fV="L";function fU(fZ,fY,fX){this.level=fZ;this.from=fY;this.to=fX}return function(f7){if(!fN.test(f7)){return false}var gd=f7.length,f3=[];for(var gc=0,fZ;gc<gd;++gc){f3.push(fZ=fQ(f7.charCodeAt(gc)))}for(var gc=0,f6=fV;gc<gd;++gc){var fZ=f3[gc];if(fZ=="m"){f3[gc]=f6}else{f6=fZ}}for(var gc=0,fX=fV;gc<gd;++gc){var fZ=f3[gc];if(fZ=="1"&&fX=="r"){f3[gc]="n"}else{if(fP.test(fZ)){fX=fZ;if(fZ=="r"){f3[gc]="R"}}}}for(var gc=1,f6=f3[0];gc<gd-1;++gc){var fZ=f3[gc];if(fZ=="+"&&f6=="1"&&f3[gc+1]=="1"){f3[gc]="1"}else{if(fZ==","&&f6==f3[gc+1]&&(f6=="1"||f6=="n")){f3[gc]=f6}}f6=fZ}for(var gc=0;gc<gd;++gc){var fZ=f3[gc];if(fZ==","){f3[gc]="N"}else{if(fZ=="%"){for(var f0=gc+1;f0<gd&&f3[f0]=="%";++f0){}var ge=(gc&&f3[gc-1]=="!")||(f0<gd&&f3[f0]=="1")?"1":"N";for(var ga=gc;ga<f0;++ga){f3[ga]=ge}gc=f0-1}}}for(var gc=0,fX=fV;gc<gd;++gc){var fZ=f3[gc];if(fX=="L"&&fZ=="1"){f3[gc]="L"}else{if(fP.test(fZ)){fX=fZ}}}for(var gc=0;gc<gd;++gc){if(fW.test(f3[gc])){for(var f0=gc+1;f0<gd&&fW.test(f3[f0]);++f0){}var f4=(gc?f3[gc-1]:fV)=="L";var fY=(f0<gd?f3[f0]:fV)=="L";var ge=f4||fY?"L":"R";for(var ga=gc;ga<f0;++ga){f3[ga]=ge}gc=f0-1}}var gb=[],f8;for(var gc=0;gc<gd;){if(fO.test(f3[gc])){var f1=gc;for(++gc;gc<gd&&fO.test(f3[gc]);++gc){}gb.push(new fU(0,f1,gc))}else{var f2=gc,f5=gb.length;for(++gc;gc<gd&&f3[gc]!="L";++gc){}for(var ga=f2;ga<gc;){if(fS.test(f3[ga])){if(f2<ga){gb.splice(f5,0,new fU(1,f2,ga))}var f9=ga;for(++ga;ga<gc&&fS.test(f3[ga]);++ga){}gb.splice(f5,0,new fU(2,f9,ga));f2=ga}else{++ga}}if(f2<gc){gb.splice(f5,0,new fU(1,f2,gc))}}}if(gb[0].level==1&&(f8=f7.match(/^\s+/))){gb[0].from=f8[0].length;gb.unshift(new fU(0,0,f8[0].length))}if(fh(gb).level==1&&(f8=f7.match(/\s+$/))){fh(gb).to-=f8[0].length;gb.push(new fU(0,gd-f8[0].length,gd))}if(gb[0].level!=fh(gb).level){gb.push(new fU(gb[0].level,gd,gd))}return gb}})();J.version="4.3.0";return J});