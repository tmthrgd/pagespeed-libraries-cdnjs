(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../../mode/sql/sql"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../../mode/sql/sql"],a)}else{a(CodeMirror)}}})(function(d){var k;var e;var m={QUERY_DIV:";",ALIAS_KEYWORD:"AS"};var i=d.Pos;function l(o){var p=o.doc.modeOption;if(p==="sql"){p="text/x-sql"}return d.resolveMode(p).keywords}function f(p,r){var o=p.length;var q=r.substr(0,o);return p.toUpperCase()===q.toUpperCase()}function c(o,q,r,p){for(var s in r){if(!r.hasOwnProperty(s)){continue}if(Array.isArray(r)){s=r[s]}if(f(q,s)){o.push(p(s))}}}function a(o,s){var u=s.getCursor();var r=s.getTokenAt(u);var p=r.string.substr(1);var v=i(u.line,r.start);var t=s.getTokenAt(v).string;if(!k.hasOwnProperty(t)){t=n(t,s)}var q=k[t];if(!q){return}c(o,p,q,function(x){return"."+x})}function b(p,r){if(!p){return}var o=/[,;]/g;var s=p.split(" ");for(var q=0;q<s.length;q++){r(s[q]?s[q].replace(o,""):"")}}function h(o){return o.line+o.ch/Math.pow(10,6)}function j(o){return i(Math.floor(o),+o.toString().split(".").pop())}function n(t,u){var C=u.doc;var p=C.getValue();var o=t.toUpperCase();var v="";var D="";var s=[];var B={start:i(0,0),end:i(u.lastLine(),u.getLineHandle(u.lastLine()).length)};var r=p.indexOf(m.QUERY_DIV);while(r!=-1){s.push(C.posFromIndex(r));r=p.indexOf(m.QUERY_DIV,r+1)}s.unshift(i(0,0));s.push(i(u.lastLine(),u.getLineHandle(u.lastLine()).text.length));var z=0;var w=h(u.getCursor());for(var q=0;q<s.length;q++){var A=h(s[q]);if(w>z&&w<=A){B={start:j(z),end:j(A)};break}z=A}var x=C.getRange(B.start,B.end,false);for(var q=0;q<x.length;q++){var y=x[q];b(y,function(F){var E=F.toUpperCase();if(E===o&&k.hasOwnProperty(v)){D=v}if(E!==m.ALIAS_KEYWORD){v=F}});if(D){break}}return D}function g(t,q){k=(q&&q.tables)||{};e=e||l(t);var u=t.getCursor();var s=t.getTokenAt(u),p=s.end;var o=[];var r=s.string.trim();if(r.charAt(0)=="."){a(o,t);if(!o.length){while(s.start&&r.charAt(0)=="."){s=t.getTokenAt(i(u.line,s.start-1));r=s.string+r}c(o,r,k,function(v){return v})}}else{c(o,r,e,function(v){return v.toUpperCase()});c(o,r,k,function(v){return v})}return{list:o,from:i(u.line,s.start),to:i(u.line,p)}}d.registerHelper("hint","sql",g)});