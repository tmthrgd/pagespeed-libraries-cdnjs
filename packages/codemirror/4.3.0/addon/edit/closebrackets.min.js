(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){var h="()[]{}''\"\"";var a="[]{}";var g=/\s/;var e=b.Pos;b.defineOption("autoCloseBrackets",false,function(i,n,j){if(j!=b.Init&&j){i.removeKeyMap("autoCloseBrackets")}if(!n){return}var l=h,k=a;if(typeof n=="string"){l=n}else{if(typeof n=="object"){if(n.pairs!=null){l=n.pairs}if(n.explode!=null){k=n.explode}}}var m=f(l);if(k){m.Enter=c(k)}i.addKeyMap(m)});function d(i,k){var j=i.getRange(e(k.line,k.ch-1),e(k.line,k.ch+1));return j.length==2?j:null}function f(l){var m={name:"autoCloseBrackets",Backspace:function(n){if(n.getOption("disableInput")){return b.Pass}var o=n.listSelections();for(var p=0;p<o.length;p++){if(!o[p].empty()){return b.Pass}var q=d(n,o[p].head);if(!q||l.indexOf(q)%2!=0){return b.Pass}}for(var p=o.length-1;p>=0;p--){var r=o[p].head;n.replaceRange("",e(r.line,r.ch-1),e(r.line,r.ch+1))}}};var k="";for(var j=0;j<l.length;j+=2){(function(n,i){if(n!=i){k+=i}m["'"+n+"'"]=function(o){if(o.getOption("disableInput")){return b.Pass}var p=o.listSelections(),u,t;for(var s=0;s<p.length;s++){var q=p[s],v=q.head,r;if(n=="'"&&o.getTokenTypeAt(v)=="comment"){return b.Pass}var t=o.getRange(v,e(v.line,v.ch+1));if(!q.empty()){r="surround"}else{if(n==i&&t==i){if(o.getRange(v,e(v.line,v.ch+3))==n+n+n){r="skipThree"}else{r="skip"}}else{if(n==i&&v.ch>1&&o.getRange(e(v.line,v.ch-2),v)==n+n&&(v.ch<=2||o.getRange(e(v.line,v.ch-3),e(v.line,v.ch-2))!=n)){r="addFour"}else{if(n==i&&b.isWordChar(t)){return b.Pass}else{if(o.getLine(v.line).length==v.ch||k.indexOf(t)>=0||g.test(t)){r="both"}else{return b.Pass}}}}}if(!u){u=r}else{if(u!=r){return b.Pass}}}o.operation(function(){if(u=="skip"){o.execCommand("goCharRight")}else{if(u=="skipThree"){for(var x=0;x<3;x++){o.execCommand("goCharRight")}}else{if(u=="surround"){var w=o.getSelections();for(var x=0;x<w.length;x++){w[x]=n+w[x]+i}o.replaceSelections(w,"around")}else{if(u=="both"){o.replaceSelection(n+i,null);o.execCommand("goCharLeft")}else{if(u=="addFour"){o.replaceSelection(n+n+n+n,"before");o.execCommand("goCharRight")}}}}}})};if(n!=i){m["'"+i+"'"]=function(o){var p=o.listSelections();for(var r=0;r<p.length;r++){var q=p[r];if(!q.empty()||o.getRange(q.head,e(q.head.line,q.head.ch+1))!=i){return b.Pass}}o.execCommand("goCharRight")}}})(l.charAt(j),l.charAt(j+1))}return m}function c(i){return function(j){if(j.getOption("disableInput")){return b.Pass}var k=j.listSelections();for(var l=0;l<k.length;l++){if(!k[l].empty()){return b.Pass}var m=d(j,k[l].head);if(!m||i.indexOf(m)%2!=0){return b.Pass}}j.operation(function(){j.replaceSelection("\n\n",null);j.execCommand("goCharLeft");k=j.listSelections();for(var o=0;o<k.length;o++){var n=k[o].head.line;j.indentLine(n,null,true);j.indentLine(n+1,null,true)}})}}});