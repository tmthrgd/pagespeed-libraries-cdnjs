(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function d(n,m,o,i){if(o&&o.call){var g=o;o=null}else{var g=c(n,o,"rangeFinder")}if(typeof m=="number"){m=b.Pos(m,0)}var h=c(n,o,"minFoldSize");function f(p){var q=g(n,m);if(!q||q.to.line-q.from.line<h){return null}var s=n.findMarksAt(q.from);for(var r=0;r<s.length;++r){if(s[r].__isFold&&i!=="fold"){if(!p){return null}q.cleared=true;s[r].clear()}}return q}var k=f(true);if(c(n,o,"scanUp")){while(!k&&m.line>n.firstLine()){m=b.Pos(m.line-1,0);k=f(false)}}if(!k||k.cleared||i==="unfold"){return}var l=e(n,o);b.on(l,"mousedown",function(p){j.clear();b.e_preventDefault(p)});var j=n.markText(k.from,k.to,{replacedWith:l,clearOnEnter:true,__isFold:true});j.on("clear",function(q,p){b.signal(n,"unfold",n,q,p)});b.signal(n,"fold",n,k.from,k.to)}function e(f,g){var h=c(f,g,"widget");if(typeof h=="string"){var i=document.createTextNode(h);h=document.createElement("span");h.appendChild(i);h.className="CodeMirror-foldmarker"}return h}b.newFoldFunction=function(g,f){return function(h,i){d(h,i,{rangeFinder:g,widget:f})}};b.defineExtension("foldCode",function(h,f,g){d(this,h,f,g)});b.defineExtension("isFolded",function(h){var g=this.findMarksAt(h);for(var f=0;f<g.length;++f){if(g[f].__isFold){return true}}});b.commands.toggleFold=function(f){f.foldCode(f.getCursor())};b.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold")};b.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold")};b.commands.foldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"fold")}})};b.commands.unfoldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"unfold")}})};b.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(g,k){for(var h=0;h<f.length;++h){var j=f[h](g,k);if(j){return j}}}});b.registerHelper("fold","auto",function(f,k){var h=f.getHelpers(k,"fold");for(var g=0;g<h.length;g++){var j=h[g](f,k);if(j){return j}}});var a={rangeFinder:b.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:false};b.defineOption("foldOptions",null);function c(f,h,g){if(h&&h[g]!==undefined){return h[g]}var i=f.options.foldOptions;if(i&&i[g]!==undefined){return i[g]}return a[g]}});