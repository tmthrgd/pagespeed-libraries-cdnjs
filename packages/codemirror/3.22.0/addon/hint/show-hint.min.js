!function(){"use strict";function t(t,e,o){this.cm=t,this.getHints=e,this.options=o,this.widget=this.onClose=null}function e(t){return"string"==typeof t?t:t.text}function o(t,e){function o(t,o){var s;s="string"!=typeof o?function(t){return o(t,e)}:i.hasOwnProperty(o)?i[o]:o,n[t]=s}var i={Up:function(){e.moveFocus(-1)},Down:function(){e.moveFocus(1)},PageUp:function(){e.moveFocus(-e.menuSize()+1,!0)},PageDown:function(){e.moveFocus(e.menuSize()-1,!0)},Home:function(){e.setFocus(0)},End:function(){e.setFocus(e.length-1)},Enter:e.pick,Tab:e.pick,Esc:e.close},n=t.customKeys?{}:i;if(t.customKeys)for(var s in t.customKeys)t.customKeys.hasOwnProperty(s)&&o(s,t.customKeys[s]);if(t.extraKeys)for(var s in t.extraKeys)t.extraKeys.hasOwnProperty(s)&&o(s,t.extraKeys[s]);return n}function i(t,e){for(;e&&e!=t;){if("LI"===e.nodeName.toUpperCase()&&e.parentNode==t)return e;e=e.parentNode}}function n(t,n){this.completion=t,this.data=n;var c=this,l=t.cm,h=t.options,a=this.hints=document.createElement("ul");a.className="CodeMirror-hints",this.selectedHint=h.getDefaultSelection?h.getDefaultSelection(l,h,n):0;for(var u=n.list,f=0;f<u.length;++f){var d=a.appendChild(document.createElement("li")),m=u[f],p=s+(f!=this.selectedHint?"":" "+r);null!=m.className&&(p=m.className+" "+p),d.className=p,m.render?m.render(d,n,m):d.appendChild(document.createTextNode(m.displayText||e(m))),d.hintId=f}var g=l.cursorCoords(h.alignWithWord!==!1?n.from:null),v=g.left,C=g.bottom,w=!0;a.style.left=v+"px",a.style.top=C+"px";var y=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),M=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(h.container||document.body).appendChild(a);var H=a.getBoundingClientRect(),x=H.bottom-M;if(x>0){var A=H.bottom-H.top,T=H.top-(g.bottom-g.top);if(T-A>0)a.style.top=(C=T-A)+"px",w=!1;else if(A>M){a.style.height=M-5+"px",a.style.top=(C=g.bottom-H.top)+"px";var k=l.getCursor();n.from.ch!=k.ch&&(g=l.cursorCoords(k),a.style.left=(v=g.left)+"px",H=a.getBoundingClientRect())}}var b=H.left-y;if(b>0&&(H.right-H.left>y&&(a.style.width=y-5+"px",b-=H.right-H.left-y),a.style.left=(v=g.left-b)+"px"),l.addKeyMap(this.keyMap=o(h,{moveFocus:function(t,e){c.changeActive(c.selectedHint+t,e)},setFocus:function(t){c.changeActive(t)},menuSize:function(){return c.screenAmount()},length:u.length,close:function(){t.close()},pick:function(){c.pick()},data:n})),h.closeOnUnfocus!==!1){var N;l.on("blur",this.onBlur=function(){N=setTimeout(function(){t.close()},100)}),l.on("focus",this.onFocus=function(){clearTimeout(N)})}var S=l.getScrollInfo();return l.on("scroll",this.onScroll=function(){var e=l.getScrollInfo(),o=l.getWrapperElement().getBoundingClientRect(),i=C+S.top-e.top,n=i-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return w||(n+=a.offsetHeight),n<=o.top||n>=o.bottom?t.close():(a.style.top=i+"px",void(a.style.left=v+S.left-e.left+"px"))}),CodeMirror.on(a,"dblclick",function(t){var e=i(a,t.target||t.srcElement);e&&null!=e.hintId&&(c.changeActive(e.hintId),c.pick())}),CodeMirror.on(a,"click",function(t){var e=i(a,t.target||t.srcElement);e&&null!=e.hintId&&(c.changeActive(e.hintId),h.completeOnSingleClick&&c.pick())}),CodeMirror.on(a,"mousedown",function(){setTimeout(function(){l.focus()},20)}),CodeMirror.signal(n,"select",u[0],a.firstChild),!0}var s="CodeMirror-hint",r="CodeMirror-hint-active";CodeMirror.showHint=function(e,o,i){if(!e.somethingSelected()){if(null==o){if(i&&i.async)return;o=CodeMirror.hint.auto}e.state.completionActive&&e.state.completionActive.close();var n=e.state.completionActive=new t(e,o,i||{});return CodeMirror.signal(e,"startCompletion",e),n.options.async?void o(e,function(t){n.showHints(t)},n.options):n.showHints(o(e,n.options))}},t.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.widget&&this.widget.close(),this.onClose&&this.onClose(),CodeMirror.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,o){var i=t.list[o];i.hint?i.hint(this.cm,t,i):this.cm.replaceRange(e(i),i.from||t.from,i.to||t.to),CodeMirror.signal(t,"pick",i),this.close()},showHints:function(t){return t&&t.list.length&&this.active()?void(0!=this.options.completeSingle&&1==t.list.length?this.pick(t,0):this.showWidget(t)):this.close()},showWidget:function(t){function e(){c||(c=!0,h.close(),h.cm.off("cursorActivity",r),t&&CodeMirror.signal(t,"close"))}function o(){c||(CodeMirror.signal(t,"update"),h.options.async?h.getHints(h.cm,i,h.options):i(h.getHints(h.cm,h.options)))}function i(o){return t=o,c?void 0:t&&t.list.length?void(h.widget=new n(h,t)):e()}function s(){l&&(m(l),l=0)}function r(){s();var t=h.cm.getCursor(),e=h.cm.getLine(t.line);t.line!=u.line||e.length-t.ch!=f-u.ch||t.ch<u.ch||h.cm.somethingSelected()||t.ch&&a.test(e.charAt(t.ch-1))?h.close():(l=d(o),h.widget&&h.widget.close())}this.widget=new n(this,t),CodeMirror.signal(t,"shown");var c,l=0,h=this,a=this.options.closeCharacters||/[\s()\[\]{};:>,]/,u=this.cm.getCursor(),f=this.cm.getLine(u.line).length,d=window.requestAnimationFrame||function(t){return setTimeout(t,1e3/60)},m=window.cancelAnimationFrame||clearTimeout;this.cm.on("cursorActivity",r),this.onClose=e}},n.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var t=this.completion.cm;this.completion.options.closeOnUnfocus!==!1&&(t.off("blur",this.onBlur),t.off("focus",this.onFocus)),t.off("scroll",this.onScroll)}},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,e){if(t>=this.data.list.length?t=e?this.data.list.length-1:0:0>t&&(t=e?0:this.data.list.length-1),this.selectedHint!=t){var o=this.hints.childNodes[this.selectedHint];o.className=o.className.replace(" "+r,""),o=this.hints.childNodes[this.selectedHint=t],o.className+=" "+r,o.offsetTop<this.hints.scrollTop?this.hints.scrollTop=o.offsetTop-3:o.offsetTop+o.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=o.offsetTop+o.offsetHeight-this.hints.clientHeight+3),CodeMirror.signal(this.data,"select",this.data.list[this.selectedHint],o)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},CodeMirror.registerHelper("hint","auto",function(t,e){var o,i=t.getHelpers(t.getCursor(),"hint");if(i.length)for(var n=0;n<i.length;n++){var s=i[n](t,e);if(s&&s.list.length)return s}else if(o=t.getHelper(t.getCursor(),"hintWords")){if(o)return CodeMirror.hint.fromList(t,{words:o})}else if(CodeMirror.hint.anyword)return CodeMirror.hint.anyword(t,e)}),CodeMirror.registerHelper("hint","fromList",function(t,e){for(var o=t.getCursor(),i=t.getTokenAt(o),n=[],s=0;s<e.words.length;s++){var r=e.words[s];r.slice(0,i.string.length)==i.string&&n.push(r)}return n.length?{list:n,from:CodeMirror.Pos(o.line,i.start),to:CodeMirror.Pos(o.line,i.end)}:void 0}),CodeMirror.commands.autocomplete=CodeMirror.showHint}();