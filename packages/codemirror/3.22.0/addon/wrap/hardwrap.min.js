!function(){"use strict";function r(r,t,e){for(var n=e.paragraphStart||r.getHelper(t,"paragraphStart"),a=t.line,o=r.firstLine();a>o;--a){var i=r.getLine(a);if(n&&n.test(i))break;if(!/\S/.test(i)){++a;break}}for(var f=e.paragraphEnd||r.getHelper(t,"paragraphEnd"),l=t.line+1,h=r.lastLine();h>=l;++l){var i=r.getLine(l);if(f&&f.test(i)){++l;break}if(!/\S/.test(i))break}return{from:a,to:l}}function t(r,t,e,n){for(var a=t;a>0&&!e.test(r.slice(a-1,a+1));--a);0==a&&(a=t);var o=a;if(n)for(;" "==r.charAt(o-1);)--o;return{from:o,to:a}}function e(r,e,a,o){e=r.clipPos(e),a=r.clipPos(a);var i=o.column||80,f=o.wrapOn||/\s\S|-[^\.\d]/,l=o.killTrailingSpace!==!1,h=[],g="",s=e.line,p=r.getRange(e,a,!1);if(!p.length)return null;for(var c=p[0].match(/^[ \t]*/)[0],u=0;u<p.length;++u){var v=p[u],m=g.length,d=0;g&&v&&!f.test(g.charAt(g.length-1)+v.charAt(0))&&(g+=" ",d=1);var x="";if(u&&(x=v.match(/^\s*/)[0],v=v.slice(x.length)),g+=v,u){var C=g.length>i&&c==x&&t(g,i,f,l);C&&C.from==m&&C.to==m+d?(g=c+v,++s):h.push({text:[d?" ":""],from:n(s,m),to:n(s+1,x.length)})}for(;g.length>i;){var E=t(g,i,f,l);h.push({text:["",c],from:n(s,E.from),to:n(s,E.to)}),g=c+g.slice(E.to),++s}}return h.length&&r.operation(function(){for(var t=0;t<h.length;++t){var e=h[t];r.replaceRange(e.text,e.from,e.to)}}),h.length?{from:h[0].from,to:CodeMirror.changeEnd(h[h.length-1])}:null}var n=CodeMirror.Pos;CodeMirror.defineExtension("wrapParagraph",function(t,a){a=a||{},t||(t=this.getCursor());var o=r(this,t,a);return e(this,n(o.from,0),n(o.to-1),a)}),CodeMirror.defineExtension("wrapRange",function(r,t,n){return e(this,r,t,n||{})}),CodeMirror.defineExtension("wrapParagraphsInRange",function(t,a,o){o=o||{};for(var i=this,f=[],l=t.line;l<=a.line;){var h=r(i,n(l,0),o);f.push(h),l=h.to}var g=!1;return f.length&&i.operation(function(){for(var r=f.length-1;r>=0;--r)g=g||e(i,n(f[r].from,0),n(f[r].to-1),o)}),g})}();