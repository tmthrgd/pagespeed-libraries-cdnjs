!function(){"use strict";CodeMirror.defineMode("haml",function(e){function t(e){return function(t,i){var o=t.peek();return o==e&&1==i.rubyState.tokenize.length?(t.next(),i.tokenize=r,"closeAttributeTag"):n(t,i)}}function n(e,t){return e.match("-#")?(e.skipToEnd(),"comment"):o.token(e,t.rubyState)}function r(e,r){var o=e.peek();if("comment"==r.previousToken.style&&r.indented>r.previousToken.indented)return e.skipToEnd(),"commentLine";if(r.startOfLine){if("!"==o&&e.match("!!"))return e.skipToEnd(),"tag";if(e.match(/^%[\w:#\.]+=/))return r.tokenize=n,"hamlTag";if(e.match(/^%[\w:]+/))return"hamlTag";if("/"==o)return e.skipToEnd(),"comment"}if((r.startOfLine||"hamlTag"==r.previousToken.style)&&("#"==o||"."==o))return e.match(/[\w-#\.]*/),"hamlAttribute";if(r.startOfLine&&!e.match("-->",!1)&&("="==o||"-"==o))return r.tokenize=n,null;if("hamlTag"==r.previousToken.style||"closeAttributeTag"==r.previousToken.style||"hamlAttribute"==r.previousToken.style){if("("==o)return r.tokenize=t(")"),null;if("{"==o)return r.tokenize=t("}"),null}return i.token(e,r.htmlState)}var i=CodeMirror.getMode(e,{name:"htmlmixed"}),o=CodeMirror.getMode(e,"ruby");return{startState:function(){var e=i.startState(),t=o.startState();return{htmlState:e,rubyState:t,indented:0,previousToken:{style:null,indented:0},tokenize:r}},copyState:function(e){return{htmlState:CodeMirror.copyState(i,e.htmlState),rubyState:CodeMirror.copyState(o,e.rubyState),indented:e.indented,previousToken:e.previousToken,tokenize:e.tokenize}},token:function(e,t){if(e.sol()&&(t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace())return null;var i=t.tokenize(e,t);if(t.startOfLine=!1,i&&"commentLine"!=i&&(t.previousToken={style:i,indented:t.indented}),e.eol()&&t.tokenize==n){e.backUp(1);var o=e.peek();e.next(),o&&","!=o&&(t.tokenize=r)}return"hamlTag"==i?i="tag":"commentLine"==i?i="comment":"hamlAttribute"==i?i="attribute":"closeAttributeTag"==i&&(i=null),i}}},"htmlmixed","ruby"),CodeMirror.defineMIME("text/x-haml","haml")}();