CodeMirror.defineMode("htmlembedded",function(e,t){function n(e,t){return e.match(o,!1)?(t.token=i,a.token(e,t.scriptState)):r.token(e,t.htmlState)}function i(e,t){return e.match(s,!1)?(t.token=n,r.token(e,t.htmlState)):a.token(e,t.scriptState)}var a,r,o=t.scriptStartRegex||/^<%/i,s=t.scriptEndRegex||/^%>/i;return{startState:function(){return a=a||CodeMirror.getMode(e,t.scriptingModeSpec),r=r||CodeMirror.getMode(e,"htmlmixed"),{token:t.startOpen?i:n,htmlState:r.startState(),scriptState:a.startState()}},token:function(e,t){return t.token(e,t)},indent:function(e,t){return e.token==n?r.indent(e.htmlState,t):a.indent(e.scriptState,t)},copyState:function(e){return{token:e.token,htmlState:CodeMirror.copyState(r,e.htmlState),scriptState:CodeMirror.copyState(a,e.scriptState)}},electricChars:"/{}:",innerMode:function(e){return e.token==i?{state:e.scriptState,mode:a}:{state:e.htmlState,mode:r}}}},"htmlmixed"),CodeMirror.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"}),CodeMirror.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"}),CodeMirror.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"}),CodeMirror.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"});