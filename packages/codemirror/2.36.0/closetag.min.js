(function(){function e(e,t){return CodeMirror.innerMode(e.getMode(),t).state}function t(e,t,i,a){n(e,t,a)?(e.replaceSelection("\n\n</"+a+">","end"),e.indentLine(i.line+1),e.indentLine(i.line+2),e.setCursor({line:i.line+1,ch:e.getLine(i.line+1).length})):(e.replaceSelection("</"+a+">"),e.setCursor(i))}function n(e,t,n){return(t===void 0||null==t||1==t)&&(t=e.getOption("closeTagIndent")),t||(t=[]),-1!=a(t,n.toLowerCase())}function i(e,t,n){return"xml"==e.getOption("mode")?!0:((t===void 0||null==t)&&(t=e.getOption("closeTagVoid")),t||(t=[]),-1==a(t,n.toLowerCase()))}function a(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;i>n;++n)if(e[n]==t)return n;return-1}function r(e,t,n){e.replaceSelection("/"+n+">"),e.setCursor({line:t.line,ch:t.ch+n.length+2})}CodeMirror.defaults.closeTagEnabled=!0,CodeMirror.defaults.closeTagIndent=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"],CodeMirror.defaults.closeTagVoid=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],CodeMirror.defineExtension("closeTag",function(n,a,o,s){if(!n.getOption("closeTagEnabled"))throw CodeMirror.Pass;var l=n.getCursor(),c=n.getTokenAt(l),u=e(n,c.state);if(u)if(">"==a){var d=u.type;if("tag"==c.className&&"closeTag"==d)throw CodeMirror.Pass;if(n.replaceSelection(">"),l={line:l.line,ch:l.ch+1},n.setCursor(l),c=n.getTokenAt(n.getCursor()),u=e(n,c.state),!u)throw CodeMirror.Pass;var d=u.type;if("tag"==c.className&&"selfcloseTag"!=d){var p=u.tagName;return p.length>0&&i(n,s,p)&&t(n,o,l,p),void 0}n.setSelection({line:l.line,ch:l.ch-1},l),n.replaceSelection("")}else if("/"==a&&"tag"==c.className&&"<"==c.string){var m=u.context,p=m?m.tagName:"";if(p.length>0)return r(n,l,p),void 0}throw CodeMirror.Pass})})();