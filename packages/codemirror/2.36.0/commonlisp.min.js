CodeMirror.defineMode("commonlisp",function(e){function t(e){for(var t;t=e.next();)if("\\"==t)e.next();else if(!l.test(t)){e.backUp(1);break}return e.current()}function n(e,n){if(e.eatSpace())return r="ws",null;if(e.match(s))return"number";var o=e.next();if("\\"==o&&(o=e.next()),'"'==o)return(n.tokenize=i)(e,n);if("("==o)return r="open","bracket";if(")"==o||"]"==o)return r="close","bracket";if(";"==o)return e.skipToEnd(),r="ws","comment";if(/['`,@]/.test(o))return null;if("|"==o)return e.skipTo("|")?(e.next(),"symbol"):(e.skipToEnd(),"error");if("#"==o){var o=e.next();return"["==o?(r="open","bracket"):/[+\-=\.']/.test(o)?null:/\d/.test(o)&&e.match(/^\d*#/)?null:"|"==o?(n.tokenize=a)(e,n):":"==o?(t(e),"meta"):"error"}var l=t(e);return"."==l?null:(r="symbol","nil"==l||"t"==l?"atom":":"==l.charAt(0)?"keyword":"&"==l.charAt(0)?"variable-2":"variable")}function i(e,t){for(var i,a=!1;i=e.next();){if('"'==i&&!a){t.tokenize=n;break}a=!a&&"\\"==i}return"string"}function a(e,t){for(var i,a;i=e.next();){if("#"==i&&"|"==a){t.tokenize=n;break}a=i}return r="ws","comment"}var r,o=/^with|^def|^do|^prog|case$|^cond$|bind$|when$|unless$/,s=/^(?:[+\-]?(?:\d+|\d*\.\d+)(?:[efd][+\-]?\d+)?|[+\-]?\d+(?:\/[+\-]?\d+)?|#b[+\-]?[01]+|#o[+\-]?[0-7]+|#x[+\-]?[\da-f]+)/,l=/[^\s'`,@()\[\]";]/;return{startState:function(){return{ctx:{prev:null,start:0,indentTo:0},tokenize:n}},token:function(t,n){t.sol()&&"number"!=typeof n.ctx.indentTo&&(n.ctx.indentTo=n.ctx.start+1),r=null;var i=n.tokenize(t,n);return"ws"!=r&&(null==n.ctx.indentTo?n.ctx.indentTo="symbol"==r&&o.test(t.current())?n.ctx.start+e.indentUnit:"next":"next"==n.ctx.indentTo&&(n.ctx.indentTo=t.column())),"open"==r?n.ctx={prev:n.ctx,start:t.column(),indentTo:null}:"close"==r&&(n.ctx=n.ctx.prev||n.ctx),i},indent:function(e){var t=e.ctx.indentTo;return"number"==typeof t?t:e.ctx.start+1}}}),CodeMirror.defineMIME("text/x-common-lisp","commonlisp");