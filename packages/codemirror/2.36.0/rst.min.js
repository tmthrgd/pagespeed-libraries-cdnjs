CodeMirror.defineMode("rst",function(e,t){function n(e,t,n){e.fn=t,i(e,n)}function i(e,t){e.ctx=t||{}}function r(e,t){if(t&&"string"!=typeof t){var i=t.current();t=i[i.length-1]}n(e,s,{back:t})}function a(e){if(e){var t=CodeMirror.listModes();for(var n in t)if(t[n]==e)return!0}return!1}function o(t){return a(t)?CodeMirror.getMode(e,t):null}function s(e,t){function i(e){return u||!t.ctx.back||e.test(t.ctx.back)}function a(t){return e.eol()||e.match(t,!1)}function o(t){return e.match(t)&&i(/\W/)&&a(/\W/)}var s,u,d;if(e.eat(/\\/))return s=e.next(),r(t,s),null;if(u=e.sol(),u&&(s=e.eat(f))){for(d=0;e.eat(s);d++);if(d>=3&&e.match(/^\s*$/))return r(t,null),"header";e.backUp(d+1)}if(u&&e.match(C))return e.eol()||n(t,c),"meta";if(e.match(T)){if(h){var m=h;n(t,p,{mode:m,local:m.startState()})}else n(t,p);return"meta"}if(u&&e.match(S,!1)){if(g){var m=g;return n(t,p,{mode:m,local:m.startState()}),null}return n(t,p),"meta"}if(o(k))return r(t,e),"footnote";if(o(E))return r(t,e),"citation";if(s=e.next(),i(w)){if((":"===s||"|"===s)&&e.eat(/\S/)){var b;return b=":"===s?"builtin":"atom",n(t,l,{ch:s,wide:!1,prev:null,token:b}),b}if("*"===s||"`"===s){var v=s,y=!1;if(s=e.next(),s==v&&(y=!0,s=e.next()),s&&!/\s/.test(s)){var b;return b="*"===v?y?"strong":"em":y?"string":"string-2",n(t,l,{ch:v,wide:y,prev:null,token:b}),b}}}return r(t,s),null}function l(e,t){function i(e){return t.ctx.prev=e,o}var a=e.next(),o=t.ctx.token;return a!=t.ctx.ch?i(a):/\s/.test(t.ctx.prev)?i(a):t.ctx.wide&&(a=e.next(),a!=t.ctx.ch)?i(a):e.eol()||x.test(e.peek())?(n(t,s),r(t,a),o):(t.ctx.wide&&e.backUp(1),i(a))}function c(e,t){var i=null;if(e.match(b))i="attribute";else if(e.match(v))i="link";else if(e.match(y))i="quote";else{if(!e.match(_))return e.eatSpace(),e.eol()?(r(t,e),null):(e.skipToEnd(),n(t,d),"comment");i="quote"}return n(t,u,{start:!0}),i}function u(e,t){var n="body";return!t.ctx.start||e.sol()?m(e,t,n):(e.skipToEnd(),i(t),n)}function d(e,t){return m(e,t,"comment")}function p(e,t){return h?e.sol()?(e.eatSpace()||r(t,e),null):h.token(e,t.ctx.local):m(e,t,"meta")}function m(e,t,n){return e.eol()||e.eatSpace()?(e.skipToEnd(),n):(r(t,e),null)}var h=o(t.verbatim),g=o("python"),f=/^[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/,b=/^\s*\w([-:.\w]*\w)?::(\s|$)/,v=/^\s*_[\w-]+:(\s|$)/,y=/^\s*\[(\d+|#)\](\s|$)/,_=/^\s*\[[A-Za-z][\w-]*\](\s|$)/,k=/^\[(\d+|#)\]_/,E=/^\[[A-Za-z][\w-]*\]_/,C=/^\.\.(\s|$)/,T=/^::\s*$/,w=/^[-\s"([{</:]/,x=/^[-\s`'")\]}>/:.,;!?\\_]/,S=/^\s+(>>>|In \[\d+\]:)\s/;return{startState:function(){return{fn:s,ctx:{}}},copyState:function(e){return{fn:e.fn,ctx:e.ctx}},token:function(e,t){var n=t.fn(e,t);return n}}},"python"),CodeMirror.defineMIME("text/x-rst","rst");