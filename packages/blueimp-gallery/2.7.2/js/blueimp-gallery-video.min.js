!function(e){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper","./blueimp-gallery"],e):e(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(e,t){"use strict";return e.extend(t.prototype.options,{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"}),t.prototype.videoFactory=function(t,o){var s,i,r,n,a,l=this,p=this.options,d=this.elementPrototype.cloneNode(!1),y=e(d),c=[{type:"error",target:d}],u=document.createElement("video"),g=this.getItemProperty(t,p.urlProperty),C=this.getItemProperty(t,p.typeProperty),m=this.getItemProperty(t,p.titleProperty),P=this.getItemProperty(t,p.videoPosterProperty),v=this.getItemProperty(t,p.videoSourcesProperty);if(y.addClass(p.videoContentClass),m&&(d.title=m),u.canPlayType)if(g&&C&&u.canPlayType(C))u.src=g;else if(v)for("string"==typeof v&&(v=e.parseJSON(v));v&&v.length;)if(i=v.shift(),g=this.getItemProperty(i,p.urlProperty),C=this.getItemProperty(i,p.typeProperty),g&&C&&u.canPlayType(C)){u.src=g;break}return P&&(u.setAttribute("poster",P),s=this.imagePrototype.cloneNode(!1),e(s).addClass(p.toggleClass),s.src=P,s.draggable=!1,d.appendChild(s)),r=document.createElement("a"),r.setAttribute("target","_blank"),r.setAttribute("download",m),r.href=g,u.src&&(u.controls=!0,e(u).on("error",function(){l.setTimeout(o,c)}).on("pause",function(){n=!1,y.removeClass(l.options.videoLoadingClass).removeClass(l.options.videoPlayingClass),a&&l.container.addClass(l.options.controlsClass),l.interval&&l.play()}).on("playing",function(){n=!1,y.removeClass(l.options.videoLoadingClass).addClass(l.options.videoPlayingClass),l.container.hasClass(l.options.controlsClass)?(a=!0,l.container.removeClass(l.options.controlsClass)):a=!1}).on("play",function(){window.clearTimeout(l.timeout),n=!0,y.addClass(l.options.videoLoadingClass)}),e(r).on("click",function(e){e.preventDefault(),n?u.pause():u.play()}),d.appendChild(u)),d.appendChild(r),this.setTimeout(o,[{type:"load",target:d}]),d},t});