dc={version:"0.4.0",_charts:[]},dc.registerChart=function(a){dc._charts.push(a)},dc.hasChart=function(a){return dc._charts.indexOf(a)>=0},dc.deregisterAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var a=0;a<dc._charts.length;++a)dc._charts[a].filterAll()},dc.renderAll=function(){for(var a=0;a<dc._charts.length;++a)dc._charts[a].render()},dc.redrawAll=function(){for(var a=0;a<dc._charts.length;++a)dc._charts[a].redraw()},dc.transition=function(a,b,c){if(b<=0)return a;var d=a.transition().duration(b);return c instanceof Function&&c(d),d},dc.units={},dc.units.integers=function(a,b){return new Array(Math.abs(b-a))},dc.round={},dc.round.floor=function(a){return Math.floor(a)},dc.baseChart=function(a){var b,c,d,e,f=200,g=200,h=function(a){return a.key},i=function(a){return a.value},j=function(a){return a.key},k=!1,l=function(a){return a.key+": "+a.value},m=!1,n=750;return a.dimension=function(c){return arguments.length?(b=c,a):b},a.group=function(b){return arguments.length?(c=b,a):c},a.orderedGroup=function(){return c.order(function(a){return a.key})},a.filterAll=function(){return a.filter(null)},a.dataAreSet=function(){return b!=undefined&&c!=undefined},a.select=function(a){return e.select(a)},a.selectAll=function(a){return e.selectAll(a)},a.anchor=function(b){return arguments.length?(d=b,e=d3.select(d),a):d},a.root=function(b){return arguments.length?(e=b,a):e},a.width=function(b){return arguments.length?(f=b,a):f},a.height=function(b){return arguments.length?(g=b,a):g},a.svg=function(){return a.select("svg")},a.resetSvg=function(){a.select("svg").remove()},a.generateSvg=function(){return a.root().append("svg").attr("width",a.width()).attr("height",a.height())},a.turnOnReset=function(){a.select("a.reset").style("display",null)},a.turnOffReset=function(){a.select("a.reset").style("display","none")},a.transitionDuration=function(b){return arguments.length?(n=b,a):n},a.filter=function(b){return a},a.render=function(){return a},a.redraw=function(){return a},a.xValue=function(b){return arguments.length?(h=b,a):h},a.yValue=function(b){return arguments.length?(i=b,a):i},a.label=function(b){return arguments.length?(j=b,a):j},a.renderLabel=function(b){return arguments.length?(k=b,a):k},a.title=function(b){return arguments.length?(l=b,a):l},a.renderTitle=function(b){return arguments.length?(m=b,a):m},a},dc.coordinateGridChart=function(a){function n(a){}function o(b){var c=l.extent();a.round()&&(c[0]=c.map(a.round())[0],c[1]=c.map(a.round())[1],d.select(".brush").call(l.extent(c))),a.filter([l.extent()[0],l.extent()[1]]),dc.redrawAll()}function p(a){}var b=5;a=dc.baseChart(a);var c={top:10,right:50,bottom:30,left:20},d,e,f=d3.svg.axis(),g=dc.units.integers,h,i=d3.svg.axis(),j=!1,k,l=d3.svg.brush(),m;return a.generateG=function(){d=a.generateSvg().append("g").attr("transform","translate("+a.margins().left+","+a.margins().top+")")},a.g=function(b){return arguments.length?(d=b,a):d},a.margins=function(b){return arguments.length?(c=b,a):c},a.x=function(b){return arguments.length?(e=b,a):e},a.xAxis=function(b){return arguments.length?(f=b,a):f},a.renderXAxis=function(b){b.select("g.x").remove(),e.range([0,a.xAxisLength()]),f=f.scale(a.x()).orient("bottom"),b.append("g").attr("class","axis x").attr("transform","translate("+a.margins().left+","+a.xAxisY()+")").call(f)},a.xAxisY=function(){return a.height()-a.margins().bottom},a.xAxisLength=function(){return a.width()-a.margins().left-a.margins().right},a.xUnits=function(b){return arguments.length?(g=b,a):g},a.renderYAxis=function(c){c.select("g.y").remove();if(h==null||a.elasticY())h=d3.scale.linear(),h.domain([a.yAxisMin(),a.yAxisMax()]).rangeRound([a.yAxisHeight(),0]);h.range([a.yAxisHeight(),0]),i=i.scale(h).orient("left").ticks(b),c.append("g").attr("class","axis y").attr("transform","translate("+a.margins().left+","+a.margins().top+")").call(i)},a.y=function(b){return arguments.length?(h=b,a):h},a.yAxis=function(b){return arguments.length?(i=b,a):i},a.elasticY=function(b){return arguments.length?(j=b,a):j},a.yAxisMin=function(){var b=d3.min(a.group().all(),function(b){return a.yValue()(b)});return b>0&&(b=0),b},a.yAxisMax=function(){return d3.max(a.group().all(),function(b){return a.yValue()(b)})},a.yAxisHeight=function(){return a.height()-a.margins().top-a.margins().bottom},a.round=function(b){return arguments.length?(m=b,a):m},a._filter=function(b){return arguments.length?(k=b,a):k},a.filter=function(b){return b?(a._filter(b),a.brush().extent(b),a.dimension().filterRange(b),a.turnOnReset()):(a._filter(null),a.brush().clear(),a.dimension().filterAll(),a.turnOffReset()),a},a.brush=function(b){return arguments.length?(l=b,a):l},a.renderBrush=function(b){l.on("brushstart",n).on("brush",o).on("brushend",p);var c=b.append("g").attr("class","brush").attr("transform","translate("+a.margins().left+",0)").call(l.x(a.x()));c.selectAll("rect").attr("height",a.xAxisY()),c.selectAll(".resize").append("path").attr("d",a.resizeHandlePath),k&&a.redrawBrush(b)},a._redrawBrush=function(b){a._filter()&&a.brush().empty()&&a.brush().extent(a._filter());var c=b.select("g.brush");c.call(a.brush().x(a.x())),c.selectAll("rect").attr("height",a.xAxisY())},a.resizeHandlePath=function(b){var c=+(b=="e"),d=c?1:-1,e=a.xAxisY()/3;return"M"+.5*d+","+e+"A6,6 0 0 "+c+" "+6.5*d+","+(e+6)+"V"+(2*e-6)+"A6,6 0 0 "+c+" "+.5*d+","+2*e+"Z"+"M"+2.5*d+","+(e+8)+"V"+(2*e-8)+"M"+4.5*d+","+(e+8)+"V"+(2*e-8)},a},dc.colorChart=function(a){var b=d3.scale.category20c();return a.colors=function(c){return arguments.length?(c instanceof Array?b=d3.scale.ordinal().range(c):b=c,a):b},a},dc.singleSelectionChart=function(a){var b="selected",c="deselected",d;return a.hasFilter=function(){return d!=null},a.filter=function(b){return arguments.length?(d=b,a.dataAreSet()&&a.dimension().filter(d),b?a.turnOnReset():a.turnOffReset(),a):d},a.highlightSelected=function(a){d3.select(a).classed(b,!0),d3.select(a).classed(c,!1)},a.fadeDeselected=function(a){d3.select(a).classed(b,!1),d3.select(a).classed(c,!0)},a.resetHighlight=function(a){d3.select(a).classed(b,!1),d3.select(a).classed(c,!1)},a},dc.pieChart=function(a){function l(){return d3.layout.pie().value(function(a){return k.yValue()(a)})}function m(a){dc.transition(j,k.transitionDuration()).attr("transform",function(b){b.innerRadius=k.innerRadius(),b.outerRadius=c;var d=a.centroid(b);return isNaN(d[0])||isNaN(d[1])?"translate(0,0)":"translate("+d+")"}).attr("text-anchor","middle").text(function(a){var b=a.data;return k.yValue()(b)==0?"":k.label()(a)})}function n(){k.renderTitle()&&h.selectAll("title").text(function(a){return k.title()(a)})}function o(a){a.innerRadius=k.innerRadius();var b=this._current;p(b)&&(b={startAngle:0,endAngle:0});var c=d3.interpolate(b,a);return this._current=c(0),function(a){return f(c(a))}}function p(a){return a==null||isNaN(a.startAngle)||isNaN(a.endAngle)}function q(a){k.filter(k.xValue()(a.data)),dc.redrawAll()}var b="pie-slice",c=0,d=0,e,f,g,h,i,j,k=dc.singleSelectionChart(dc.colorChart(dc.baseChart({})));return k.label(function(a){return k.xValue()(a.data)}),k.renderLabel(!0),k.title(function(a){return a.data.key+": "+a.data.value}),k.transitionDuration(350),k.render=function(){return k.resetSvg(),k.dataAreSet()&&(e=k.generateSvg().append("g").attr("transform","translate("+k.cx()+","+k.cy()+")"),g=l(),f=k.buildArcs(),h=k.drawSlices(e,g,f),k.drawLabels(h,f),k.drawTitles(h,f),k.highlightFilter()),k},k.innerRadius=function(a){return arguments.length?(d=a,k):d},k.radius=function(a){return arguments.length?(c=a,k):c},k.cx=function(){return k.width()/2},k.cy=function(){return k.height()/2},k.buildArcs=function(){return d3.svg.arc().outerRadius(c).innerRadius(d)},k.drawSlices=function(a,c,d){return h=a.selectAll("g."+b).data(c(k.orderedGroup().top(Infinity))).enter().append("g").attr("class",function(a,c){return b+" "+c}),i=h.append("path").attr("fill",function(a,b){return k.colors()(b)}).attr("d",d),i.transition().duration(k.transitionDuration()).attrTween("d",o),i.on("click",q),h},k.drawLabels=function(a,b){k.renderLabel()&&(j=a.append("text"),m(b),j.on("click",q))},k.drawTitles=function(a,b){k.renderTitle()&&a.append("title").text(function(a){return k.title()(a)})},k.highlightFilter=function(){k.hasFilter()?k.selectAll("g."+b).select("path").each(function(a){k.isSelectedSlice(a)?k.highlightSelected(this):k.fadeDeselected(this)}):k.selectAll("g."+b).selectAll("path").each(function(a){k.resetHighlight(this)})},k.isSelectedSlice=function(a){return k.filter()==k.xValue()(a.data)},k.redraw=function(){k.highlightFilter();var a=g(k.orderedGroup().top(Infinity));return i=i.data(a),j=j.data(a),dc.transition(i,k.transitionDuration(),function(a){a.attrTween("d",o)}),m(f),n(),k},dc.registerChart(k),k.anchor(a)},dc.barChart=function(a){function f(){e=d.g().selectAll("rect.bar").data(d.group().all()),e.enter().append("rect").attr("class","bar").attr("x",function(a){return h(a)}).attr("y",d.xAxisY()).attr("width",function(){return g()}),dc.transition(e,d.transitionDuration()).attr("y",function(a){return i(a)}).attr("height",function(a){return j(a)}),dc.transition(e,d.transitionDuration()).attr("y",function(a){return i(a)}).attr("height",function(a){return j(a)}),dc.transition(e.exit(),d.transitionDuration()).attr("y",d.xAxisY()).attr("height",0)}function g(){var a=Math.floor(d.xAxisLength()/d.xUnits()(d.x().domain()[0],d.x().domain()[1]).length);if(isNaN(a)||a<b)a=b;return a}function h(a){return d.x()(d.xValue()(a))+d.margins().left}function i(a){return d.margins().top+d.y()(d.yValue()(a))}function j(a){return d.yAxisHeight()-d.y()(d.yValue()(a))-c}function k(){if(!d.brush().empty()&&d.brush().extent()!=null){var a=d.brush().extent()[0],b=d.brush().extent()[1];e.classed("deselected",function(c){var e=d.xValue()(c);return e<a||e>=b})}else e.classed("deselected",!1)}var b=1,c=1,d=dc.coordinateGridChart({}),e;return d.transitionDuration(500),d.render=function(){return d.resetSvg(),d.dataAreSet()&&(d.generateG(),d.renderXAxis(d.g()),d.renderYAxis(d.g()),f(),d.renderBrush(d.g())),d},d.redraw=function(){return f(),d.redrawBrush(d.g()),d.elasticY()&&d.renderYAxis(d.g()),d},d.redrawBrush=function(a){d._redrawBrush(a),k()},dc.registerChart(d),d.anchor(a)},dc.lineChart=function(a){function c(){b.g().datum(b.group().all());var a=b.selectAll("path.line");a.empty()&&(a=b.g().append("path").attr("class","line"));var c=d3.svg.line().x(function(a){return b.x()(b.xValue()(a))}).y(function(a){return b.y()(b.yValue()(a))});a=a.attr("transform","translate("+b.margins().left+","+b.margins().top+")"),dc.transition(a,b.transitionDuration(),function(a){a.ease("linear")}).attr("d",c)}function d(){}var b=dc.coordinateGridChart({});return b.transitionDuration(500),b.render=function(){return b.resetSvg(),b.dataAreSet()&&(b.generateG(),b.renderXAxis(b.g()),b.renderYAxis(b.g()),c(),b.renderBrush(b.g())),b},b.redraw=function(){return c(),b.redrawBrush(b.g()),b.elasticY()&&b.renderYAxis(b.g()),b},b.redrawBrush=function(a){b._redrawBrush(a),d()},dc.registerChart(b),b.anchor(a)},dc.dataCount=function(a){var b=d3.format(",d"),c=dc.baseChart({});return c.render=function(){return c.selectAll(".total-count").text(b(c.dimension().size())),c.selectAll(".filter-count").text(b(c.group().value())),c},c.redraw=function(){return c.render()},dc.registerChart(c),c.anchor(a)},dc.dataTable=function(a){function h(){var a=b.root().selectAll("div.group").data(i(),function(a){return b.xValue()(a)});return a.enter().append("div").attr("class","group").append("span").attr("class","label").text(function(a){return b.xValue()(a)}),a.exit().remove(),a}function i(){g||(g=crossfilter.quicksort.by(e));var a=b.dimension().top(c);return d3.nest().key(b.group()).sortKeys(f).entries(g(a,0,a.length))}function j(a){var b=a.order().selectAll("div.row").data(function(a){return a.values}),c=b.enter().append("div").attr("class","row");for(var e=0;e<d.length;++e){var f=d[e];c.append("span").attr("class","column "+e).text(function(a){return f(a)})}return b.exit().remove(),b}var b=dc.baseChart({}),c=25,d=[],e=function(a){return a},f=d3.ascending,g;return b.render=function(){return b.selectAll("div.row").remove(),j(h()),b},b.redraw=function(){return b.render()},b.size=function(a){return arguments.length?(c=a,b):c},b.columns=function(a){return arguments.length?(d=a,b):d},b.sortBy=function(a){return arguments.length?(e=a,b):e},b.order=function(a){return arguments.length?(f=a,b):f},dc.registerChart(b),b.anchor(a)},dc.bubbleChart=function(a){function h(){var a=d.g().selectAll("g."+b).data(d.group().all());i(a),p(a),q(a)}function i(a){var e=a.enter().append("g");e.attr("class",b).attr("transform",g).append("circle").attr("class",function(a,b){return c+" "+b}).on("click",r).attr("fill",function(a,b){return d.colors()(b)}).attr("r",0),dc.transition(a,d.transitionDuration()).attr("r",function(a){return u(a)}),k(e),n(e)}function k(a){d.renderLabel()&&a.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",r).text(j)}function l(a){d.renderLabel()&&a.selectAll("text").text(j)}function n(a){d.renderTitle()&&a.append("title").text(m)}function o(a){d.renderTitle()&&a.selectAll("title").text(m)}function p(a){dc.transition(a,d.transitionDuration()).attr("transform",g).selectAll("circle."+c).attr("r",function(a){return u(a)}),l(a),o(a)}function q(a){dc.transition(a.exit().selectAll("circle."+c),d.transitionDuration()).attr("r",0).remove()}function s(a){return d.x()(d.xValue()(a))+d.margins().left}function t(a){return d.margins().top+d.y()(d.yValue()(a))}function u(a){return d.r()(d.rValue()(a))}function v(){var a=1,c=.1;d.hasFilter()?d.selectAll("g."+b).select("circle").each(function(a){d.isSelectedSlice(a)?d.highlightSelected(this):d.fadeDeselected(this)}):d.selectAll("g."+b).selectAll("circle").each(function(a){d.resetHighlight(this)})}var b="node",c="bubble",d=dc.singleSelectionChart(dc.colorChart(dc.coordinateGridChart({})));d.renderLabel(!0),d.renderTitle(!1);var e=d3.scale.linear().domain([0,100]),f=function(a){return a.r};d.transitionDuration(750),d.render=function(){return d.resetSvg(),d.dataAreSet()&&(d.generateG(),d.renderXAxis(d.g()),d.renderYAxis(d.g()),e.range([0,d.xAxisLength()/3]),h(),d.renderBrush(d.g()),v()),d},d.redraw=function(){return h(),d.redrawBrush(d.g()),d};var g=function(a){return"translate("+s(a)+","+t(a)+")"},j=function(a){return u(a)>0?d.label()(a):""},m=function(a){return d.title()(a)},r=function(a){d.filter(a.key),dc.redrawAll()};return d.renderBrush=function(a){},d.redrawBrush=function(a){v()},d.isSelectedSlice=function(a){return d.filter()==a.key},d.r=function(a){return arguments.length?(e=a,d):e},d.rValue=function(a){return arguments.length?(f=a,d):f},dc.registerChart(d),d.anchor(a)};